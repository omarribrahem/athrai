<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="description" content="منصة أثر التعليمية - محتوى متخصص لكلية التجارة مع فيديو تفاعلي" />
  <meta name="keywords" content="اقتصاد، محاسبة، إدارة، تجارة، تنبؤ، business, economics, accounting, finance, forecasting" />
  <title>منصة أثر - التمهيد الأسي وطرق التنبؤ</title>
  
  <!-- ==================== FONTS ==================== -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&family=Inter:wght@400;500;600;700;800&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- ==================== MATH RENDERING ==================== -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        packages: {'[+]': ['ams', 'newcommand', 'mathtools', 'boldsymbol']},
        macros: {
          RR: "{\\mathbb{R}}",
          ZZ: "{\\mathbb{Z}}",
          NN: "{\\mathbb{N}}",
          bold: ["{\\bf #1}", 1],
          Delta: "{\\varDelta}",
          Sigma: "{\\varSigma}"
        }
      },
      svg: { fontCache: 'global', scale: 1.1 },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      },
      startup: {
        pageReady: () => {
          console.log('✅ MathJax is ready!');
          return MathJax.startup.defaultPageReady();
        }
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" id="MathJax-script" async></script>
  
  <!-- KaTeX (Alternative - Faster) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  
  <!-- ==================== BUSINESS/FINANCE LIBRARIES ==================== -->
  
  <!-- Formula.js - Excel Financial Functions -->
  <script src="https://cdn.jsdelivr.net/npm/@formulajs/formulajs/dist/formula.min.js"></script>
  
  <!-- Finance.js - Financial Calculations -->
  <script src="https://cdn.jsdelivr.net/npm/financejs@4.1.0/finance.min.js"></script>
  
  <!-- Accounting.js - Currency & Number Formatting -->
  <script src="https://cdn.jsdelivr.net/npm/accounting@0.4.1/accounting.min.js"></script>
  
  <!-- Numeral.js - Number Formatting -->
  <script src="https://cdn.jsdelivr.net/npm/numeral@2.0.6/numeral.min.js"></script>
  
  <!-- Math.js - Advanced Math Operations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  
  <!-- Decimal.js - Precise Decimal Arithmetic -->
  <script src="https://cdn.jsdelivr.net/npm/decimal.js@10.4.3/decimal.min.js"></script>
  
  <!-- Big.js - Arbitrary Precision -->
  <script src="https://cdn.jsdelivr.net/npm/big.js@6.2.1/big.min.js"></script>
  
  <!-- ==================== STATISTICS & DATA ANALYSIS ==================== -->
  
  <!-- jStat - Statistical Functions -->
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  
  <!-- Simple Statistics -->
  <script src="https://unpkg.com/simple-statistics@7.8.3/dist/simple-statistics.min.js"></script>
  
  <!-- Regression.js - Regression Analysis -->
  <script src="https://cdn.jsdelivr.net/npm/regression@2.0.1/dist/regression.min.js"></script>
  
  <!-- Danfo.js - Pandas for JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/danfojs@1.1.2/lib/bundle.min.js"></script>
  
  <!-- PapaParse - CSV Parser -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  
  <!-- SheetJS - Excel Files -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  
  <!-- ==================== ADVANCED MATH ==================== -->
  
  <!-- Algebrite - Symbolic Math -->
  <script src="https://algebrite.org/algebrite.bundle-for-browser.js"></script>
  
  <!-- Nerdamer - Computer Algebra System -->
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/nerdamer.core.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Algebra.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Calculus.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Solve.js"></script>
  
  <!-- GeoGebra - Interactive Math -->
  <script src="https://www.geogebra.org/apps/deployggb.js"></script>
  
  <!-- Desmos Calculator API -->
  <script src="https://www.desmos.com/api/v1.8/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
  
  <!-- JSXGraph - Dynamic Geometry -->
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css">
  
  <!-- Function Plot - Mathematical Functions -->
  <script src="https://unpkg.com/function-plot/dist/function-plot.js"></script>
  
  <!-- ==================== CHARTS & GRAPHS (MOBILE OPTIMIZED) ==================== -->
  
  <!-- Chart.js - Simple Charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <!-- Echarts - Professional Charts -->
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  
  <!-- ApexCharts - Modern Charts -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  
  <!-- Plotly - Interactive Scientific Charts -->
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
  
  <!-- D3.js - Custom Data Visualizations -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  
  <!-- Highcharts - Professional Business Charts -->
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/export-data.js"></script>
  
  <!-- TradingView Charting Library (Financial Charts) -->
  <script src="https://s3.tradingview.com/tv.js"></script>
  
  <!-- C3.js - D3-based Charts -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"></script>

  <!-- ==================== TABLES & DATA GRIDS ==================== -->
  
  <!-- jQuery (Required for DataTables) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  
  <!-- DataTables - Interactive Tables -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
  <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
  
  <!-- Tabulator - Modern Tables -->
  <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
  <script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  
  <!-- AG Grid - Enterprise-grade Tables -->
  <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
  
  <!-- Handsontable - Spreadsheet-like -->
  <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
  
  <!-- ==================== DIAGRAMS & FLOWCHARTS ==================== -->
  
  <!-- Mermaid - Diagrams & Flowcharts -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
  
  <!-- Vis.js - Network Diagrams -->
  <script src="https://unpkg.com/vis-network@9.1.6/dist/vis-network.min.js"></script>
  <link href="https://unpkg.com/vis-network@9.1.6/dist/dist/vis-network.min.css" rel="stylesheet">
  
  <!-- Cytoscape.js - Graph Theory & Networks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
  
  <!-- GoJS - Interactive Diagrams -->
  <script src="https://unpkg.com/gojs@3.0.0/release/go.js"></script>
  
  <!-- ==================== ANIMATIONS ==================== -->
  
  <!-- Anime.js -->
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/ScrollTrigger.min.js"></script>
  
  <!-- AOS - Animate On Scroll -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  
  <!-- ==================== CODE HIGHLIGHTING ==================== -->
  
  <!-- Prism.js -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
  
  <!-- ==================== PDF & PRINTING ==================== -->
  
  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  
  <!-- html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <!-- Print.js -->
  <script src="https://printjs-4de6.kxcdn.com/print.min.js"></script>
  <link rel="stylesheet" href="https://printjs-4de6.kxcdn.com/print.min.css">
  
  <!-- ==================== MARKDOWN & TEXT ==================== -->
  
  <!-- Marked.js -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  
  <!-- DOMPurify -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
  
  <!-- Markdown-it -->
  <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.2/dist/markdown-it.min.js"></script>
  
  <!-- ==================== UI COMPONENTS ==================== -->
  
  <!-- SweetAlert2 - Beautiful Alerts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <!-- Toastify - Notifications -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  
  <!-- Tippy.js - Tooltips -->
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  
  <!-- NProgress - Progress Bar -->
  <script src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/nprogress@0.2.0/nprogress.css">
  
  <!-- Progressbar.js -->
  <script src="https://cdn.rawgit.com/kimmobrunfeldt/progressbar.js/1.0.0/dist/progressbar.min.js"></script>
  
  <!-- ==================== CALENDAR & TIME ==================== -->
  
  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js"></script>
  
  <!-- Flatpickr - Date Picker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  
  <!-- Moment.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js"></script>
  
  <!-- ==================== ICONS ==================== -->
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <!-- ==================== UTILITIES ==================== -->
  
  <!-- Lodash -->
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
  
  <!-- Fuse.js - Fuzzy Search -->
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
  
  <!-- List.js - Search & Sort -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
  
  <!-- ==================== STORAGE ==================== -->
  
  <!-- LocalForage -->
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
  
  <!-- ==================== ACADEMIC TOOLS ==================== -->
  
  <!-- Intro.js - Guided Tours -->
  <link href="https://cdn.jsdelivr.net/npm/intro.js@7.2.0/minified/introjs.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/intro.js@7.2.0/intro.min.js"></script>
  
  <!-- Driver.js - Product Tours -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.3.1/dist/driver.css">
  <script src="https://cdn.jsdelivr.net/npm/driver.js@1.3.1/dist/driver.js.iife.js"></script>
  
  <!-- ==================== ML/AI (Optional) ==================== -->
  
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.13.0/dist/tf.min.js"></script>
  
  <!-- ML5.js -->
  <script src="https://unpkg.com/ml5@1/dist/ml5.min.js"></script>
  
  <!-- ==================== SWIPER (Sliders) ==================== -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  
  <!-- ==================== PARTICLES (Optional) ==================== -->
  
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  
  <!-- ==================== RECOMMENDED ENHANCEMENTS ==================== -->
  
  <!-- Hammer.js - Touch Gestures (للتنقل السريع) -->
  <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
  
  <!-- Howler.js - Audio (نطق المصطلحات) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
  
  <!-- Canvas Confetti - Celebrations (احتفالات الإجابات الصحيحة) -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  
  <!-- Sortable.js - Drag & Drop (أسئلة التفاعلية) -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.1/Sortable.min.js"></script>
  
  <!-- Intersection Observer Polyfill (تتبع التقدم) -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver"></script>
  
  <!-- Plyr.js - Enhanced Video Player -->
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
  <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
  
  <!-- Lottie - Vector Animations (شرح المفاهيم) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  
  <!-- Flickity - Carousel (عرض الأمثلة) -->
  <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
<style>
    /* ==================== ROOT VARIABLES ==================== */
    :root {
      --color-primary: #16a34a;
      --color-primary-dark: #4d7c0f;
      --color-primary-medium: #22c55e;
      --color-ai: #f59e0b;
      --color-business: #2563eb;
      --color-finance: #059669;
      --color-accounting: #dc2626;
      --color-economics: #7c3aed;
      --glass-bg: rgba(240, 253, 244, 0.25);
      --glass-border: rgba(255, 255, 255, 0.4);
      --text-color: #0f172a;
      --border-radius: 24px;
      --font-arabic: 'IBM Plex Sans Arabic', 'Cairo', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-english: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      --font-mono: 'Roboto Mono', 'Courier New', monospace;
    }

    /* ==================== ANIMATIONS ==================== */
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    @keyframes waveFlow {
      0%, 100% { transform: translateX(-25%) scaleY(1) scaleX(1); }
      33% { transform: translateX(-10%) scaleY(1.1) scaleX(0.9); }
      66% { transform: translateX(10%) scaleY(0.9) scaleX(1.1); }
    }
    @keyframes translate-glow {
      0%, 100% { box-shadow: 0 0 15px -5px rgba(77, 124, 15, 0.4), inset 0 2px 0 rgba(255,255,255,0.4); }
      50% { box-shadow: 0 0 25px 0px rgba(77, 124, 15, 0.6), inset 0 2px 0 rgba(255,255,255,0.6); }
    }
    @keyframes ai-glow {
      0%, 100% { box-shadow: 0 0 15px -5px rgba(245, 158, 11, 0.4), inset 0 2px 0 rgba(255,255,255,0.4); }
      50% { box-shadow: 0 0 25px 0px rgba(245, 158, 11, 0.6), inset 0 2px 0 rgba(255,255,255,0.6); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes typing {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
    @keyframes typingDots {
      0%, 20% { opacity: 0; }
      40% { opacity: 1; }
      60%, 100% { opacity: 0; }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(0.95); }
    }
    @keyframes countUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes spin {
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }
    @keyframes tapFeedback {
      0% { opacity: 0; transform: translateY(-50%) scale(0.6); }
      50% { opacity: 1; transform: translateY(-50%) scale(1.15); }
      100% { opacity: 0; transform: translateY(-50%) scale(1); }
    }

    /* ==================== BASE STYLES ==================== */
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    html { 
      font-size: clamp(0.9rem, 2.5vw, 1.05rem); 
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    body {
      font-family: var(--font-arabic);
      background: #f0fdf4;
      color: var(--text-color);
      line-height: 1.8;
      overflow-x: hidden;
      direction: rtl;
      padding: clamp(10px, 3vw, 20px);
      font-weight: 400;
      touch-action: manipulation;
    }
    body[dir="ltr"] { 
      direction: ltr; 
      font-family: var(--font-english);
    }

    /* ==================== BACKGROUND WAVES ==================== */
    .background-waves {
      position: fixed; inset: 0; z-index: -2;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 25%, #fefce8 50%, #ecfccb 75%, #f0fdf4 100%);
      background-size: 400% 400%;
      animation: gradientShift 20s ease infinite;
    }
    .wave-layer {
      position: absolute; bottom: -10%; left: -10%; width: 120%; height: 300px;
      background: linear-gradient(90deg, rgba(22,163,74,0.08), rgba(77,124,15,0.08), rgba(34,197,94,0.08));
      border-radius: 60% 40% 0 0;
      animation: waveFlow 15s ease-in-out infinite;
    }
    .wave-layer:nth-child(2) {
      bottom: -5%; height: 250px; animation-delay: -5s;
      background: linear-gradient(90deg, rgba(77,124,15,0.06), rgba(34,197,94,0.06));
      border-radius: 40% 60% 0 0;
    }
    .wave-layer:nth-child(3) {
      bottom: 0%; height: 200px; animation-delay: -10s;
      background: linear-gradient(90deg, rgba(34,197,94,0.04), rgba(22,163,74,0.04));
      border-radius: 80% 20% 0 0;
    }

    /* ==================== TRANSLATION BUTTON ==================== */
    .translation-button {
      position: fixed; top: clamp(20px, 5vw, 30px); right: clamp(20px, 5vw, 30px);
      background: rgba(255,255,255,0.15); backdrop-filter: blur(30px);
      border: 2px solid var(--glass-border); border-radius: 50px;
      padding: clamp(8px, 2vw, 12px); cursor: pointer; z-index: 1000;
      width: clamp(50px, 12vw, 60px); height: clamp(50px, 12vw, 60px);
      display: flex; align-items: center; justify-content: center;
      transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      box-shadow: 0 8px 25px -10px rgba(0,0,0,0.2), inset 0 2px 0 rgba(255,255,255,0.6);
    }
    .translation-button svg { width: 28px; height: 28px; flex-shrink: 0; transition: transform 0.3s ease; }
    .translation-button svg path, .translation-button svg circle { stroke: var(--color-primary-dark); }
    body[dir="ltr"] .translation-button { right: auto; left: clamp(20px, 5vw, 30px); }
    .translation-button:hover {
      width: auto; padding: clamp(8px, 2vw, 12px) clamp(16px, 4vw, 22px);
      border-color: var(--color-primary-dark);
      background: rgba(77, 124, 15, 0.15);
      transform: translateY(-3px);
      animation: translate-glow 2.5s infinite alternate;
    }
    .translation-button:hover svg { transform: scale(0.9); }
    .translation-text {
      font-size: clamp(0.85rem, 2.2vw, 1rem); 
      font-weight: 600;
      color: var(--color-primary-dark); 
      white-space: nowrap;
      display: none; 
      margin-left: 10px;
    }
    body[dir="ltr"] .translation-text { margin-left: 0; margin-right: 10px; }
    .translation-button:hover .translation-text { display: block; }

    /* ==================== AI FAB BUTTON ==================== */
    .ai-fab-button {
      position: fixed; bottom: clamp(20px, 5vw, 30px); right: clamp(20px, 5vw, 30px);
      background: rgba(255,255,255,0.15); backdrop-filter: blur(30px);
      border: 2px solid var(--glass-border); border-radius: 50px;
      padding: clamp(10px, 2.5vw, 14px); cursor: pointer; z-index: 1000;
      width: clamp(56px, 14vw, 70px); height: clamp(56px, 14vw, 70px);
      display: flex; align-items: center; justify-content: center;
      transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      box-shadow: 0 8px 25px -10px rgba(245, 158, 11, 0.3), inset 0 2px 0 rgba(255,255,255,0.6);
    }
    body[dir="ltr"] .ai-fab-button { right: auto; left: clamp(20px, 5vw, 30px); }
    .ai-fab-button:hover {
      width: auto; padding: clamp(10px, 2.5vw, 14px) clamp(18px, 4.5vw, 24px);
      border-color: var(--color-ai);
      background: rgba(245, 158, 11, 0.15);
      transform: translateY(-3px);
      animation: ai-glow 2.5s infinite alternate;
    }
    .ai-fab-button svg { 
      width: clamp(28px, 7vw, 36px); 
      height: clamp(28px, 7vw, 36px); 
      flex-shrink: 0; 
      transition: transform 0.3s ease; 
    }
    .ai-fab-button:hover svg { transform: scale(0.9) rotate(5deg); }
    .ai-fab-text {
      font-size: clamp(0.85rem, 2.2vw, 1rem); 
      font-weight: 600;
      color: var(--color-ai); 
      white-space: nowrap;
      display: none; 
      margin-left: 10px;
    }
    body[dir="ltr"] .ai-fab-text { margin-left: 0; margin-right: 10px; }
    .ai-fab-button:hover .ai-fab-text { display: block; }

    /* ==================== AI CHAT MODAL ==================== */
    .ai-chat-modal {
      position: fixed; inset: 0;
      background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px);
      display: none; align-items: center; justify-content: center;
      z-index: 2000; padding: 20px;
    }
    .ai-chat-modal.visible { display: flex; animation: fadeIn 0.3s ease; }
    
    .ai-chat-container {
      background: var(--glass-bg); 
      border: 2px solid var(--glass-border); 
      border-radius: var(--border-radius);
      width: 90%; max-width: 600px; height: 80%; max-height: 700px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
      display: flex; flex-direction: column;
      transform: scale(0.95); transition: transform 0.3s ease;
      backdrop-filter: blur(25px);
      overflow: hidden;
    }
    .ai-chat-modal.visible .ai-chat-container { transform: scale(1); }
    
    .ai-chat-header {
      padding: 15px 20px;
      border-bottom: 2px solid var(--glass-border);
      display: flex; justify-content: space-between; align-items: center;
      background: linear-gradient(180deg, rgba(255,255,255,0.4), transparent);
    }
    .ai-chat-header h3 {
      color: var(--color-primary);
      margin: 0;
      font-size: clamp(1.1rem, 4vw, 1.3rem);
      font-weight: 700;
    }
    .ai-chat-close-btn {
      background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
      border: 1.5px solid rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(10px);
      color: #64748b;
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      font-size: 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.6);
      position: relative;
      overflow: hidden;
    }
    .ai-chat-close-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(220, 38, 38, 0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .ai-chat-close-btn:hover::before { opacity: 1; }
    .ai-chat-close-btn:hover {
      border-color: rgba(220, 38, 38, 0.4);
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 20px rgba(220, 38, 38, 0.25), inset 0 1px 0 rgba(255,255,255,0.8);
    }
    .ai-chat-close-btn svg {
      width: 18px;
      height: 18px;
      color: #64748b;
      transition: all 0.3s ease;
      position: relative;
      z-index: 1;
    }
    .ai-chat-close-btn:hover svg {
      color: #dc2626;
      transform: rotate(90deg) scale(1.1);
    }
    
    .ai-chat-messages {
      flex: 1; overflow-y: auto; padding: 20px;
      display: flex; flex-direction: column; gap: 15px;
    }
    .ai-chat-messages::-webkit-scrollbar { width: 10px; }
    .ai-chat-messages::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
    }
    .ai-chat-messages::-webkit-scrollbar-thumb {
      background: rgba(22, 163, 74, 0.4);
      border-radius: 10px;
      border: 2px solid transparent;
      background-clip: padding-box;
    }
    .ai-chat-messages::-webkit-scrollbar-thumb:hover {
      background: rgba(22, 163, 74, 0.6);
      background-clip: padding-box;
    }
    
    .chat-message {
      max-width: 85%;
      padding: 10px 15px;
      border-radius: 18px;
      line-height: 1.6;
      animation: slideUp 0.3s ease;
    }
    .user-message {
      background: rgba(22,163,74,0.2);
      color: #14532d;
      border-bottom-right-radius: 4px;
      align-self: flex-end;
    }
    body[dir="ltr"] .user-message {
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 18px;
      align-self: flex-start;
    }
    .ai-message {
      background: rgba(245,158,11,0.15);
      color: #78350f;
      border-bottom-left-radius: 4px;
      align-self: flex-start;
    }
    body[dir="ltr"] .ai-message {
      border-bottom-right-radius: 4px;
      border-bottom-left-radius: 18px;
      align-self: flex-end;
    }
    
    .chat-message strong { color: #1e3a8a; font-weight: 700; }
    .chat-message ul { margin: 8px 0; padding-right: 20px; }
    body[dir="ltr"] .chat-message ul { padding-right: 0; padding-left: 20px; }
    .chat-message li { margin-bottom: 4px; color: inherit; }
    
    .typing-indicator {
      background: rgba(245,158,11,0.15) !important;
      color: #9ca3af !important;
      font-style: italic;
    }
    .dot {
      animation: typingDots 1.5s infinite;
      font-size: 1.2em;
      color: var(--color-ai) !important;
    }
    .dot:nth-child(2) { animation-delay: 0.3s; }
    .dot:nth-child(3) { animation-delay: 0.6s; }
    
    .ai-chat-input-area {
      padding: 15px 20px;
      border-top: 2px solid var(--glass-border);
      display: flex; gap: 10px;
      background: linear-gradient(0deg, rgba(255,255,255,0.4), transparent);
    }
    #ai-chat-input {
      flex-grow: 1;
      border: 2px solid var(--glass-border);
      background: rgba(255,255,255,0.3);
      border-radius: 50px;
      padding: 10px 18px;
      font-size: 1rem;
      color: var(--text-color);
      outline: none;
      transition: border-color 0.3s, box-shadow 0.3s;
      font-family: inherit;
    }
    #ai-chat-input:focus {
      border-color: var(--color-ai);
      box-shadow: 0 0 10px rgba(245,158,11,0.3);
    }
    #ai-chat-input:disabled { opacity: 0.6; cursor: not-allowed; }
    
    #ai-chat-send-btn {
      background-color: var(--color-ai);
      border: none; border-radius: 50%;
      width: 48px; height: 48px; flex-shrink: 0;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background-color 0.3s, transform 0.2s, opacity 0.3s;
    }
    #ai-chat-send-btn:hover:not(:disabled) {
      background-color: #fbbf24;
      transform: scale(1.05);
    }
    #ai-chat-send-btn:disabled {
      opacity: 0.6; cursor: not-allowed; transform: none;
    }
    #ai-chat-send-btn svg { width: 24px; height: 24px; color: white; }

    /* ==================== MAIN CONTENT ==================== */
    .main-content { max-width: 1200px; margin: 90px auto 0; padding: clamp(20px, 5vw, 40px); }
    .glassy-card {
      background: var(--glass-bg);
      border: 2px solid var(--glass-border);
      border-radius: var(--border-radius);
      padding: clamp(20px, 5vw, 30px);
      margin-bottom: clamp(25px, 5vw, 35px);
      backdrop-filter: blur(25px);
      transition: all 0.4s ease;
      box-shadow: 0 20px 50px rgba(0,0,0,0.1), inset 0 2px 0 rgba(255,255,255,0.5);
    }
    .glassy-card:hover { transform: translateY(-5px) scale(1.01); border-color: rgba(255,255,255,0.7); }

    /* ==================== TYPOGRAPHY ==================== */
    h1, h2, h3, h4, h5 { 
      font-weight: 700; 
      text-shadow: 0 2px 8px rgba(255,255,255,0.8);
      letter-spacing: -0.02em;
    }
    h1 {
      font-size: clamp(2rem, 6vw, 3.2rem);
      text-align: center;
      margin-bottom: clamp(20px, 4vw, 30px);
      color: #14532d;
      font-weight: 800;
    }
    h2 {
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      border-bottom: 3px solid rgba(22,163,74,0.3);
      padding-bottom: clamp(10px, 2vw, 15px);
      margin-bottom: clamp(20px, 4vw, 30px);
      color: #166534;
      font-weight: 700;
    }
    h3 {
      font-size: clamp(1.2rem, 4vw, 1.8rem);
      margin-bottom: clamp(15px, 3vw, 20px);
      color: #15803d;
      font-weight: 600;
    }
    h4 {
      font-size: clamp(1.1rem, 3.5vw, 1.4rem);
      color: var(--color-primary);
      margin-bottom: clamp(12px, 2vw, 15px);
      font-weight: 600;
    }
    p, li { 
      color: #475569; 
      margin-bottom: clamp(10px, 2vw, 12px);
      line-height: 1.85;
    }
    strong { color: #14532d; font-weight: 600; }
    ul, ol { padding-right: clamp(20px, 4vw, 25px); margin-bottom: 20px; }
    body[dir="ltr"] ul, body[dir="ltr"] ol { padding-right: 0; padding-left: clamp(20px, 4vw, 25px); }

    /* ==================== HIGHLIGHTERS ==================== */
    mark {
      border-radius: 4px;
      padding: 2px 6px;
      font-weight: 500;
      border: none;
    }
    .highlight-green { background: rgba(22,163,74,0.2); color: #14532d; }
    .highlight-blue { background: rgba(59,130,246,0.2); color: #1e3a8a; }
    .highlight-yellow { background: rgba(234,179,8,0.2); color: #713f12; }
    .highlight-orange { background: rgba(249,115,22,0.2); color: #7c2d12; }
    .highlight-pink { background: rgba(236,72,153,0.2); color: #831843; }
    .highlight-business { background: rgba(37,99,235,0.2); color: #1e3a8a; }
    .highlight-finance { background: rgba(5,150,105,0.2); color: #064e3b; }
    .highlight-accounting { background: rgba(220,38,38,0.2); color: #7f1d1d; }
    .highlight-economics { background: rgba(124,58,237,0.2); color: #4c1d95; }

    /* ==================== INTERACTIVE QUESTIONS ==================== */
    .question-container {
      background: rgba(22,163,74,0.08);
      border: 2px solid rgba(22,163,74,0.2);
      border-radius: 18px;
      padding: 20px;
      margin: 20px 0;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
    }
    .question-container:hover {
      transform: translateY(-2px);
      border-color: var(--color-primary-medium);
      background: rgba(22,163,74,0.12);
    }
    .question-container.open {
      border-color: var(--color-primary-medium);
      background: rgba(22,163,74,0.15);
    }

    .question-header {
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 0;
      font-size: 1.05rem;
      display: flex;
      align-items: center;
      gap: 12px;
      padding-right: 35px;
    }
    body[dir="ltr"] .question-header { padding-right: 0; padding-left: 35px; }

    .question-icon {
      width: 22px;
      height: 22px;
      flex-shrink: 0;
    }

    .arrow-icon {
      width: 18px;
      height: 18px;
      position: absolute;
      top: 22px;
      right: 20px;
      transition: transform 0.3s ease;
      flex-shrink: 0;
    }
    body[dir="ltr"] .arrow-icon { right: auto; left: 20px; }
    .question-container.open .arrow-icon { transform: rotate(180deg); }

    .question-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease, margin-top 0.3s ease;
    }
    .question-content.show { max-height: 2000px; margin-top: 20px; }

    .mcq-options { list-style: none; padding: 0; margin-top: 15px; }
    .mcq-option {
      background: rgba(255,255,255,0.3);
      border: 2px solid rgba(255,255,255,0.4);
      border-radius: 12px;
      padding: 14px 18px;
      margin: 10px 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      position: relative;
    }
    .mcq-option:hover {
      background: rgba(22,163,74,0.15);
      transform: translateX(-5px);
      border-color: var(--color-primary);
    }
    body[dir="ltr"] .mcq-option:hover { transform: translateX(5px); }
    .mcq-option.selected {
      background: rgba(22,163,74,0.2);
      border-color: var(--color-primary);
      transform: scale(1.02);
    }
    .mcq-option.correct {
      background: linear-gradient(135deg, rgba(34,197,94,0.3), rgba(22,163,74,0.2));
      border-color: var(--color-primary-medium);
      color: #14532d;
      font-weight: 600;
    }
    .mcq-option.incorrect {
      background: linear-gradient(135deg, rgba(239,68,68,0.3), rgba(220,38,38,0.2));
      border-color: #dc2626;
      color: #7f1d1d;
      animation: shake 0.5s ease;
    }

    .solution-content {
      background: rgba(255,255,255,0.3);
      border: 1px solid rgba(255,255,255,0.4);
      padding: 20px;
      border-radius: 14px;
      animation: slideUp 0.6s ease;
    }
    .solution-content strong { color: #15803d; }

    /* ==================== TABLES ==================== */
    .table-container { 
      overflow-x: auto; 
      margin: 20px 0; 
      border-radius: 12px; 
      box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
    }
    .concepts-table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(255,255,255,0.2);
      border-radius: 12px;
      overflow: hidden;
      backdrop-filter: blur(15px);
    }
    .concepts-table th, .concepts-table td {
      padding: clamp(8px, 2vw, 12px);
      border: 1px solid rgba(255,255,255,0.3);
      text-align: right;
      font-size: clamp(0.8rem, 2vw, 1rem);
      vertical-align: top;
    }
    body[dir="ltr"] .concepts-table th,
    body[dir="ltr"] .concepts-table td { text-align: left; }
    .concepts-table th {
      background: rgba(22,163,74,0.2);
      font-weight: 700;
      color: var(--color-primary);
      text-align: center;
    }
    .concepts-table tr:hover { background: rgba(255,255,255,0.1); }

    /* Financial Tables */
    .financial-table th {
      background: rgba(5,150,105,0.2);
      color: var(--color-finance);
    }
    .accounting-table th {
      background: rgba(220,38,38,0.2);
      color: var(--color-accounting);
    }

    /* ==================== CHARTS (MOBILE OPTIMIZED) ==================== */
    .chart-container {
      position: relative;
      background: rgba(255,255,255,0.3);
      border-radius: 16px;
      padding: clamp(15px, 3vw, 20px);
      margin: 20px 0;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    .chart-container canvas {
      display: block !important;
      width: 100% !important;
      height: auto !important;
      max-height: clamp(280px, 60vh, 450px) !important;
      min-height: 220px !important;
    }
    @media (max-width: 768px) {
      .chart-container canvas {
        max-height: 350px !important;
        min-height: 250px !important;
      }
    }
    @media (max-width: 480px) {
      .chart-container canvas {
        max-height: 300px !important;
        min-height: 220px !important;
      }
    }

    /* ==================== CODE BLOCKS ==================== */
    pre[class*="language-"] {
      border-radius: 12px;
      margin: 20px 0;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      font-family: var(--font-mono);
    }

    /* ==================== BUSINESS SPECIFIC STYLES ==================== */
    .currency { 
      font-family: var(--font-mono); 
      font-weight: 600; 
      color: var(--color-finance); 
    }
    .percentage { 
      font-family: var(--font-mono); 
      font-weight: 600; 
      color: var(--color-business); 
    }
    .formula-box {
      background: rgba(124,58,237,0.1);
      border: 2px solid rgba(124,58,237,0.3);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      font-family: var(--font-mono);
    }
    
    /* Progress Indicators */
    .progress-bar {
      height: 8px;
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--color-primary), var(--color-primary-medium));
      border-radius: 10px;
      transition: width 1s ease;
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .stat-card {
      background: rgba(255,255,255,0.2);
      padding: 25px;
      border-radius: 16px;
      text-align: center;
      border: 2px solid rgba(255,255,255,0.3);
      transition: all 0.3s ease;
    }
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .stat-value {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 8px;
    }
    .stat-label {
      font-size: 1rem;
      font-weight: 600;
      opacity: 0.8;
    }
    
    /* Alert Boxes */
    .alert-box {
      border-radius: 12px;
      padding: 20px;
      margin: 15px 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .alert-success {
      background: rgba(34,197,94,0.15);
      border-right: 4px solid #22c55e;
      color: #166534;
    }
    .alert-info {
      background: rgba(59,130,246,0.15);
      border-right: 4px solid #3b82f6;
      color: #1e3a8a;
    }
    .alert-warning {
      background: rgba(245,158,11,0.15);
      border-right: 4px solid #f59e0b;
      color: #b45309;
    }
    .alert-error {
      background: rgba(239,68,68,0.15);
      border-right: 4px solid #ef4444;
      color: #b91c1c;
    }
    body[dir="ltr"] .alert-box {
      border-right: none;
      border-left: 4px solid;
    }

    /* ==================== FOOTER ==================== */
    .footer-info {
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 16px;
      padding: 20px 24px;
      margin-top: 40px;
      text-align: center;
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }
    .footer-brand {
      font-size: 0.95rem;
      color: var(--color-primary-dark);
      font-weight: 600;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .footer-brand svg { width: 20px; height: 20px; }
    .footer-divider {
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
      margin: 12px auto;
    }
    .footer-disclaimer {
      font-size: 0.85rem;
      color: #64748b;
      line-height: 1.6;
      margin-top: 8px;
    }
    
    /* ==================== UTILITY CLASSES ==================== */
    .hidden { display: none !important; }
    .text-center { text-align: center; }
    .mt-1 { margin-top: 0.5rem; }
    .mt-2 { margin-top: 1rem; }
    .mt-3 { margin-top: 1.5rem; }
    .mb-1 { margin-bottom: 0.5rem; }
    .mb-2 { margin-bottom: 1rem; }
    .mb-3 { margin-bottom: 1.5rem; }
    .p-1 { padding: 0.5rem; }
    .p-2 { padding: 1rem; }
    .p-3 { padding: 1.5rem; }

    /* ==================== VIDEO PLAYER STYLES (iOS 26) ==================== */
    .video-section {
      margin: clamp(30px, 6vw, 50px) 0;
    }
    
    .video-card-player {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: clamp(15px, 3vw, 30px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .video-info {
      color: #fff;
      margin-bottom: 20px;
      text-align: center;
    }

    .video-info h2 {
      font-size: clamp(1.4rem, 4vw, 2rem);
      margin-bottom: 10px;
      color: #14532d;
      border-bottom: none;
    }

    .video-info p {
      opacity: 0.8;
      line-height: 1.6;
      font-size: clamp(0.85rem, 2.5vw, 1rem);
      color: #475569;
    }

    .video-player-wrapper {
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    .video-player {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      background: #000;
      user-select: none;
    }

    .video-player.fullscreen-mode {
      position: fixed;
      inset: 0;
      z-index: 9999;
      aspect-ratio: auto;
      height: 100vh;
      border-radius: 0;
    }

    video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: #000;
    }

    .video-bars {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 5;
      transition: opacity 0.8s ease;
      display: none;
    }

    .video-player.fullscreen-mode .video-bars {
      display: block;
    }

    .video-bars.hidden {
      opacity: 0;
    }

    .top-bar-bg {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 120px;
      background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
    }

    .bottom-bar-bg {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 150px;
      background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
    }

    .glass-bubble {
      border-radius: 50%;
      border: 1.5px solid rgba(255, 255, 255, 0.3);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 50%, rgba(255, 255, 255, 0.1) 100%);
      backdrop-filter: blur(12px) brightness(115%);
      -webkit-backdrop-filter: blur(12px) brightness(115%);
      box-shadow: inset -3px -3px 8px rgba(255, 255, 255, 0.3), inset 3px 3px 8px rgba(0, 0, 0, 0.15), 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .glass-bubble:hover {
      transform: scale(1.08);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.08) 50%, rgba(255, 255, 255, 0.15) 100%);
    }

    .glass-bubble:active {
      transform: scale(0.92);
    }

    .simple-controls {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 100%);
      padding: clamp(10px, 3vw, 20px);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 10;
    }

    .video-player:not(.fullscreen-mode):hover .simple-controls,
    .video-player:not(.fullscreen-mode).paused .simple-controls {
      opacity: 1;
    }

    .video-player.fullscreen-mode .simple-controls {
      display: none;
    }

    .simple-progress {
      height: 5px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      margin-bottom: 12px;
      cursor: pointer;
      direction: ltr;
      position: relative;
    }

    .simple-progress-filled {
      height: 100%;
      background: #fff;
      border-radius: 10px;
      width: 0%;
    }

    .simple-controls-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #fff;
    }

    .simple-btn {
      background: none;
      border: none;
      color: #fff;
      font-size: clamp(1.2rem, 4vw, 1.5rem);
      cursor: pointer;
      padding: 8px 12px;
      transition: transform 0.2s ease;
      min-width: 44px;
      min-height: 44px;
    }

    .simple-btn:active {
      transform: scale(0.9);
    }

    .simple-time {
      font-size: clamp(0.75rem, 2.5vw, 0.9rem);
    }

    .ios-controls {
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      z-index: 10;
      display: none;
    }

    .video-player.fullscreen-mode .ios-controls {
      display: block;
    }

    .video-player.fullscreen-mode.show-controls .ios-controls {
      opacity: 1;
      pointer-events: auto;
    }

    .top-controls {
      position: absolute;
      top: env(safe-area-inset-top, 15px);
      left: 15px;
      right: 15px;
      padding-top: 5px;
      display: flex;
      justify-content: space-between;
      z-index: 11;
    }

    .top-left-group {
      display: flex;
      gap: 12px;
    }

    .control-bubble {
      width: clamp(40px, 10vw, 48px);
      height: clamp(40px, 10vw, 48px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #fff;
      font-size: clamp(16px, 4vw, 19px);
    }

    .volume-control {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .volume-slider-container {
      opacity: 0;
      transform: translateX(10px);
      pointer-events: none;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      display: flex;
      align-items: center;
      padding: 6px 12px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 100%);
      backdrop-filter: blur(20px) brightness(110%);
      border-radius: 50px;
      border: 1.5px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    }

    .volume-control:hover .volume-slider-container,
    .volume-control:active .volume-slider-container {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }

    .volume-slider {
      -webkit-appearance: none;
      width: clamp(60px, 15vw, 90px);
      height: 5px;
      background: linear-gradient(to right, #fff 50%, rgba(255, 255, 255, 0.3) 50%);
      border-radius: 50px;
      outline: none;
      cursor: pointer;
      direction: ltr !important;
      box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 0;
      height: 0;
    }

    .volume-slider::-moz-range-thumb {
      width: 0;
      height: 0;
      border: none;
      background: transparent;
    }

    .center-play-controls {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      gap: clamp(30px, 8vw, 55px);
      z-index: 11;
    }

    .skip-bubble {
      width: clamp(56px, 15vw, 72px);
      height: clamp(56px, 15vw, 72px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #fff;
      font-size: clamp(20px, 5vw, 24px);
      position: relative;
    }

    .skip-number {
      position: absolute;
      font-size: clamp(8px, 2.2vw, 10px);
      font-weight: 900;
      letter-spacing: 0.3px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -48%);
      color: #fff;
      text-shadow: 0 2px 6px rgba(0, 0, 0, 0.9);
      pointer-events: none;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
    }

    .play-bubble {
      width: clamp(70px, 18vw, 94px);
      height: clamp(70px, 18vw, 94px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #fff;
      font-size: clamp(28px, 7vw, 34px);
    }

    .play-bubble i {
      margin-left: 3px;
    }

    .bottom-timeline {
      position: absolute;
      bottom: env(safe-area-inset-bottom, 15px);
      left: 15px;
      right: 15px;
      padding-bottom: 5px;
      z-index: 11;
    }

    .progress-wrapper {
      width: 100%;
      height: 40px;
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      cursor: pointer;
      touch-action: none;
    }

    .progress-track {
      position: relative;
      width: 100%;
      height: 5px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.3) 100%);
      border-radius: 50px;
      direction: ltr !important;
      transition: height 0.2s ease;
      box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .progress-wrapper:hover .progress-track,
    .progress-wrapper:active .progress-track {
      height: 7px;
    }

    .video-player.dragging .progress-track {
      height: 9px;
    }

    .progress-buffered {
      position: absolute;
      height: 100%;
      background: rgba(255, 255, 255, 0.45);
      border-radius: 50px;
      width: 0%;
    }

    .progress-filled {
      position: absolute;
      height: 100%;
      background: linear-gradient(90deg, #fff, #f0f0f0);
      border-radius: 50px;
      width: 0%;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }

    .time-row {
      display: flex;
      justify-content: space-between;
      color: #fff;
    }

    .time-text {
      font-size: clamp(11px, 3vw, 13px);
      font-weight: 600;
      font-variant-numeric: tabular-nums;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    }

    .loading-spinner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: clamp(40px, 10vw, 52px);
      height: clamp(40px, 10vw, 52px);
      border: 3px solid rgba(255, 255, 255, 0.15);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.75s linear infinite;
      display: none;
      z-index: 20;
    }

    .loading-spinner.active {
      display: block;
    }

    .tap-indicator {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: #fff;
      font-size: clamp(40px, 10vw, 52px);
      opacity: 0;
      pointer-events: none;
      z-index: 15;
      filter: drop-shadow(0 4px 20px rgba(0, 0, 0, 0.7));
    }

    .tap-indicator.left { left: 15%; }
    .tap-indicator.right { right: 15%; }

    .tap-indicator.active {
      animation: tapFeedback 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 768px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }
      .main-content {
        margin-top: 70px;
      }
      .video-card-player { 
        border-radius: 16px; 
      }
    }
    /* ==================== CONTENT LANGUAGE TOGGLE ==================== */
    .ar-content, .en-content {
      transition: opacity 0.3s ease;
    }
    
    .en-content {
      display: none; /* مخفي في البداية */
    }

  </style>
</head>
<body>
  <!-- Background -->
  <div class="background-waves">
    <div class="wave-layer"></div>
    <div class="wave-layer"></div>
    <div class="wave-layer"></div>
  </div>

  <!-- Translation Button -->
  <button class="translation-button" id="translationButton" aria-label="تبديل اللغة">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25C9.36657 2.25 6.94277 3.22321 5.16629 4.83371M12.75 2.25V7.5M12.75 7.5H18M12.75 7.5L5.16629 4.83371M11.25 21.75V16.5M11.25 16.5H6M11.25 16.5L18.8337 19.1663M5.16629 4.83371C3.22321 6.94277 2.25 9.36657 2.25 12M2.25 12C2.25 14.6334 3.22321 17.0572 4.83371 18.8337M18.8337 19.1663C20.7768 17.0572 21.75 14.6334 21.75 12M18.8337 4.83371C17.0572 3.22321 14.6334 2.25 12 2.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span class="translation-text">English</span>
  </button>

  <!-- AI FAB Button -->
  <button class="ai-fab-button" id="aiChatButton" aria-label="مساعد أثر الذكي">
    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: #f59e0b;">
      <path d="M12 8V4H8"></path>
      <rect x="4" y="12" width="16" height="8" rx="2"></rect>
      <path d="M2 14h2"></path>
      <path d="M20 14h2"></path>
      <path d="M15 13v-2a3 3 0 0 0-3-3H6a3 3 0 0 0-3 3v2"></path>
    </svg>
    <span class="ai-fab-text" id="aiFabText">أثر AI</span>
  </button>

  <!-- AI Chat Modal -->
  <div class="ai-chat-modal" id="aiChatModal">
    <div class="ai-chat-container">
      <div class="ai-chat-header">
        <h3 id="ai-chat-title">اسأل أثر AI</h3>
        <button class="ai-chat-close-btn" id="aiChatCloseBtn" aria-label="إغلاق">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="ai-chat-messages" id="aiChatMessages"></div>
      <div class="ai-chat-input-area">
        <input type="text" id="ai-chat-input" placeholder="اكتب سؤالك هنا...">
        <button id="ai-chat-send-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">

    <!-- ==================== VIDEO PLAYER SECTION ==================== -->
   
  
  <!-- ==================== ARABIC CONTENT ==================== -->
<!-- ==================== LECTURE 3: NUMERICAL MEASURES - ARABIC ==================== -->
<div class="ar-content">
  
  <!-- ==================== HEADER ==================== -->
  <div class="glassy-card" data-aos="fade-down">
    <h1>📊 وصف البيانات: المقاييس العددية</h1>
    <h2 style="text-align: center; font-size: 1.3rem; color: #64748b; margin-top: 10px;">
      Describing Data: Numerical Measures
    </h2>
    <p style="text-align: center; font-size: 1.1rem; color: #475569; margin-top: 15px;">
      رحلة تعليمية تفاعلية لفهم <mark class="highlight-green">المقاييس العددية</mark> و<mark class="highlight-blue">مقاييس التشتت</mark> في الإحصاء
    </p>
    
    <div class="stats-grid" style="margin-top: 30px;">
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="100">
        <div class="stat-value" style="color: var(--color-primary);">15+</div>
        <div class="stat-label">مثال تطبيقي<br>Practical Examples</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="200">
        <div class="stat-value" style="color: var(--color-business);">10+</div>
        <div class="stat-label">معادلة إحصائية<br>Statistical Formulas</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="300">
        <div class="stat-value" style="color: var(--color-finance);">6</div>
        <div class="stat-label">أسئلة تفاعلية<br>Interactive Questions</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="400">
        <div class="stat-value" style="color: var(--color-economics);">2</div>
        <div class="stat-label">حاسبات تفاعلية<br>Interactive Calculators</div>
      </div>
    </div>
  </div>

  <!-- ==================== INTRODUCTION ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📖 لماذا نحتاج المقاييس العددية؟</h2>
    <p>
      عندما نتعامل مع البيانات، ما يكفيش بس نعرف الأرقام الموجودة، لازم نفهم <mark class="highlight-blue">القيم المركزية</mark> للبيانات دي 
      و<mark class="highlight-orange">مدى انتشارها</mark>، لأن ده بيديني صورة كاملة عن سلوك البيانات.
    </p>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Core Idea:</strong> المقاييس العددية تساعدنا على:<br>
        1. فهم <strong>القيمة المركزية</strong> للبيانات (Central Value)<br>
        2. قياس <strong>مدى التشتت</strong> والانتشار (Spread/Dispersion)
      </div>
    </div>

    <h3>نوعان أساسيان من المقاييس (Two Main Types):</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="formula-box" data-aos="fade-right" style="background: linear-gradient(135deg, rgba(22,163,74,0.1), rgba(22,163,74,0.05));">
        <h4 style="color: var(--color-primary); text-align: center;">📍 مقاييس الموقع</h4>
        <p style="text-align: center; font-weight: 600;">Measures of Location<br>(Central Tendency)</p>
        <ul style="text-align: right; margin-top: 15px;">
          <li>المتوسط الحسابي - Mean</li>
          <li>الوسيط - Median</li>
          <li>المنوال - Mode</li>
        </ul>
      </div>

      <div class="formula-box" data-aos="fade-left" style="background: linear-gradient(135deg, rgba(239,68,68,0.1), rgba(239,68,68,0.05));">
        <h4 style="color: var(--color-finance); text-align: center;">📏 مقاييس التشتت</h4>
        <p style="text-align: center; font-weight: 600;">Measures of Variability<br>(Dispersion)</p>
        <ul style="text-align: right; margin-top: 15px;">
          <li>المدى - Range</li>
          <li>التباين - Variance</li>
          <li>الانحراف المعياري - Standard Deviation</li>
        </ul>
      </div>

    </div>
  </div>

  <!-- ==================== SAMPLE MEAN ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📊 المتوسط الحسابي للعينة (The Sample Mean)</h2>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Official Definition:</strong><br>
        The sample mean = Sum of all the values in the sample ÷ Number of values in the sample<br>
        <span style="color: #64748b;">المتوسط الحسابي = مجموع كل القيم ÷ عدد القيم</span>
      </div>
    </div>

    <h3>الصيغة الرياضية (Mathematical Formula):</h3>
    <div class="formula-box" data-aos="zoom-in">
      <p style="text-align: center; font-size: 1.4rem;">
        $$\bar{X} = \frac{\sum x}{n}$$
      </p>
    </div>

    <h4>شرح الرموز (Variables Explanation):</h4>
    <ul>
      <li><strong>\(\bar{X}\)</strong>: المتوسط الحسابي للعينة (Sample Mean)</li>
      <li><strong>\(\sum x\)</strong>: مجموع كل القيم (Sum of all values)</li>
      <li><strong>\(n\)</strong>: عدد القيم في العينة (Number of values in sample)</li>
    </ul>

    <div class="alert-box alert-success" data-aos="fade-left" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
      <div>
        <strong>فكرة بسيطة (Simple Idea):</strong><br>
        تخيل معاك 12 صاحب، وعايز تعرف في المتوسط كل واحد فيهم بيصرف كام دقيقة في المكالمات الشهرية، 
        هتجمع كل الدقائق وتقسمهم على 12، وده بالظبط المتوسط الحسابي!
      </div>
    </div>
  </div>

  <!-- ==================== EXAMPLE: SUN COM ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📱 مثال 1: شركة Sun Com للاتصالات</h2>
    <p>
      شركة Sun Com بتدرس عدد الدقائق المستخدمة شهرياً من قبل العملاء في خطة 
      <mark class="highlight-blue">"Friends and Family"</mark> لتليفونات المحمول. 
      عينة عشوائية من <strong>12 عميل</strong> في هذه الخطة أظهرت البيانات التالية لعدد الدقائق المستخدمة الشهر الماضي:
    </p>

    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>Customer<br>العميل</th>
            <th>Minutes<br>الدقائق</th>
            <th>Customer<br>العميل</th>
            <th>Minutes<br>الدقائق</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>90</td><td>7</td><td>88</td></tr>
          <tr><td>2</td><td>77</td><td>8</td><td>94</td></tr>
          <tr><td>3</td><td>94</td><td>9</td><td>125</td></tr>
          <tr><td>4</td><td>89</td><td>10</td><td>96</td></tr>
          <tr><td>5</td><td>119</td><td>11</td><td>144</td></tr>
          <tr><td>6</td><td>112</td><td>12</td><td>83</td></tr>
        </tbody>
      </table>
    </div>

    <h3>السؤال (Question):</h3>
    <p style="font-weight: 600; font-size: 1.1rem; color: var(--color-primary);">
      ما هو المتوسط الحسابي لعدد الدقائق المستخدمة؟<br>
      <span style="color: #64748b;">What is the sample mean of minutes used?</span>
    </p>

    <h3>الحل بالتفصيل (Detailed Solution):</h3>
    
    <h4>Step 1: جمع كل القيم</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$\sum x = 90 + 77 + 94 + 89 + 119 + 112 + 88 + 94 + 125 + 96 + 144 + 83$$</p>
      <p style="font-size: 1.3rem; color: var(--color-business);">$$\sum x = 1170 \text{ minutes}$$</p>
    </div>

    <h4>Step 2: تطبيق القانون</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$\bar{X} = \frac{\sum x}{n} = \frac{1170}{12}$$</p>
      <p style="font-size: 1.5rem; color: var(--color-primary);"><strong>$$\bar{X} = 97.5 \text{ minutes}$$</strong></p>
    </div>

    <div class="alert-box alert-success">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <div>
        <strong>التفسير (Interpretation):</strong><br>
        العميل في المتوسط بيستخدم <mark class="highlight-finance">97.5 دقيقة شهرياً</mark> في هذه الخطة، 
        وده رقم بيدينا فكرة عامة عن سلوك الاستخدام (average usage behavior).
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 1 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      سؤال تدريبي 1: حساب المتوسط الحسابي
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        لو عندك 5 طلاب درجاتهم في الامتحان: <strong>80, 90, 70, 85, 75</strong>، ما هو المتوسط الحسابي؟<br>
        <span style="color: #64748b;">If you have 5 students with exam scores: 80, 90, 70, 85, 75, what is the mean?</span>
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="wrong">أ) 75</li>
        <li class="mcq-option" data-answer="correct">ب) 80 ✓</li>
        <li class="mcq-option" data-answer="wrong">ج) 85</li>
        <li class="mcq-option" data-answer="wrong">د) 90</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 الحل التفصيلي (Detailed Solution):</h4>
        <div class="formula-box">
          <p>$$\bar{X} = \frac{\sum x}{n} = \frac{80 + 90 + 70 + 85 + 75}{5}$$</p>
          <p>$$\bar{X} = \frac{400}{5}$$</p>
          <p style="font-size: 1.3rem; color: var(--color-finance);"><strong>$$\bar{X} = 80$$</strong></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== INTERACTIVE CALCULATOR: MEAN ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🧮 حاسبة المتوسط الحسابي التفاعلية</h2>
    <p>جرب بنفسك! أدخل القيم وشوف المتوسط الحسابي (Try it yourself!)</p>

    <div style="margin: 25px 0;">
      <label style="display: block; font-weight: 600; margin-bottom: 8px; color: var(--color-primary);">
        أدخل القيم مفصولة بفواصل (Enter values separated by commas):
      </label>
      <input type="text" id="meanValues" placeholder="80, 90, 70, 85, 75" 
             style="width: 100%; padding: 12px; border: 2px solid var(--glass-border); border-radius: 12px; 
                    font-size: 1rem; background: rgba(255,255,255,0.5);">
    </div>

    <button onclick="calculateMean()" 
            style="background: linear-gradient(135deg, var(--color-primary), var(--color-primary-medium)); 
                   color: white; border: none; padding: 15px 40px; border-radius: 50px; 
                   font-size: 1.1rem; font-weight: 700; cursor: pointer; 
                   box-shadow: 0 8px 20px rgba(22,163,74,0.3); transition: all 0.3s ease;
                   width: 100%; max-width: 300px; display: block; margin: 0 auto;">
      <i class="fas fa-calculator"></i> احسب المتوسط (Calculate)
    </button>

    <div id="meanResult" style="display: none; margin-top: 30px;" data-aos="fade-up">
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <div>
          <h3 style="margin: 0 0 10px 0; color: var(--color-primary);">النتيجة (Result)</h3>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Number of Values (n):</strong> <span id="meanN">--</span>
          </p>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Sum (Σx):</strong> <span id="meanSum">--</span>
          </p>
          <p style="font-size: 1.4rem; font-weight: 700; margin: 15px 0; color: var(--color-finance);">
            <strong>Mean (x̄):</strong> <span id="meanValue">--</span>
          </p>
        </div>
      </div>
    </div>
  </div>
  <!-- ==================== MEASURES OF DISPERSION ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📏 مقاييس التشتت: التباين والانحراف المعياري</h2>
    <h3 style="text-align: center; color: #64748b;">Measures of Dispersion: Variance and Standard Deviation</h3>
    
    <p>
      بعد ما فهمنا المتوسط الحسابي اللي بيديني <mark class="highlight-green">القيمة المركزية</mark>، 
      دلوقتي لازم نفهم <mark class="highlight-orange">التشتت</mark>، لأن مجرد معرفة المتوسط مش كافي، 
      محتاج أعرف البيانات <strong>متباعدة قد إيه</strong> عن المتوسط ده.
    </p>

    <div class="alert-box alert-warning" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      <div>
        <strong>Why Dispersion Matters:</strong><br>
        مثلاً: لو عندك شركتين متوسط الرواتب فيهم 5000 جنيه، لكن:<br>
        • <strong>الشركة الأولى:</strong> كل الموظفين بياخدوا بين 4500-5500 (تشتت قليل)<br>
        • <strong>الشركة الثانية:</strong> فيه ناس بياخدوا 2000 وناس 8000 (تشتت كبير)<br>
        المتوسط واحد، لكن التشتت مختلف تماماً!
      </div>
    </div>
  </div>

  <!-- ==================== VARIANCE ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📊 التباين (Variance)</h2>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Official Definition:</strong><br>
        VARIANCE: The arithmetic mean of the squared deviations from the mean.<br>
        <span style="color: #64748b;">التباين: المتوسط الحسابي لمربعات الانحرافات عن المتوسط</span>
      </div>
    </div>

    <h3>قانون التباين للعينة (Sample Variance Formula):</h3>
    <div class="formula-box" data-aos="zoom-in">
      <p style="text-align: center; font-size: 1.4rem;">
        $$S^2 = \frac{\sum (X - \bar{X})^2}{n - 1}$$
      </p>
    </div>

    <h4>شرح الرموز (Variables Explanation):</h4>
    <ul>
      <li><strong>\(S^2\)</strong>: تباين العينة (Sample Variance)</li>
      <li><strong>\(X\)</strong>: قيمة كل ملاحظة في العينة (Value of each observation)</li>
      <li><strong>\(\bar{X}\)</strong>: متوسط العينة (Sample Mean)</li>
      <li><strong>\(n\)</strong>: عدد الملاحظات في العينة (Number of observations)</li>
      <li><strong>\(n - 1\)</strong>: درجات الحرية (Degrees of Freedom)</li>
    </ul>

    <div class="alert-box alert-success" data-aos="fade-left" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
      <div>
        <strong>فكرة بسيطة (Simple Idea):</strong><br>
        التباين بيقيس مدى <mark class="highlight-orange">بُعد كل قيمة عن المتوسط</mark>، 
        لما القيم تكون <strong>متقاربة</strong> من المتوسط، التباين بيكون <strong>قليل</strong>، 
        ولما تكون <strong>متباعدة</strong>، التباين بيكون <strong>كبير</strong>.
      </div>
    </div>
  </div>

  <!-- ==================== STANDARD DEVIATION ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📐 الانحراف المعياري (Standard Deviation)</h2>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Official Definition:</strong><br>
        STANDARD DEVIATION: The square root of the variance.<br>
        <span style="color: #64748b;">الانحراف المعياري: الجذر التربيعي للتباين</span>
      </div>
    </div>

    <h3>قانون الانحراف المعياري للعينة (Sample Standard Deviation Formula):</h3>
    <div class="formula-box" data-aos="zoom-in">
      <p style="text-align: center; font-size: 1.4rem;">
        $$S = \sqrt{\frac{\sum (X - \bar{X})^2}{n - 1}}$$
      </p>
    </div>

    <div class="alert-box alert-warning" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <div>
        <strong>Important Note:</strong><br>
        الانحراف المعياري بيرجعنا <mark class="highlight-green">لنفس وحدة القياس الأصلية</mark> للبيانات، 
        لكن التباين بيكون بوحدة <mark class="highlight-orange">مربعة</mark> (زي دولار², أو دقيقة²)، 
        وده بيخلي الانحراف المعياري <strong>أسهل في التفسير</strong>.
      </div>
    </div>
  </div>

  <!-- ==================== EXAMPLE: FRUIT PACKERS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🍎 مثال 2: أجور موظفين Fruit Packers Inc.</h2>
    <p>
      الأجور بالساعة لعينة من <strong>5 موظفين</strong> بدوام جزئي في شركة Fruit Packers Inc. هي:
    </p>

    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>Employee<br>الموظف</th>
            <th>Hourly Wage ($)<br>الأجر بالساعة</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>$12</td></tr>
          <tr><td>2</td><td>$14</td></tr>
          <tr><td>3</td><td>$20</td></tr>
          <tr><td>4</td><td>$16</td></tr>
          <tr><td>5</td><td>$18</td></tr>
        </tbody>
      </table>
    </div>

    <h3>السؤال (Question):</h3>
    <p style="font-weight: 600; font-size: 1.1rem; color: var(--color-primary);">
      ما هو تباين العينة والانحراف المعياري؟<br>
      <span style="color: #64748b;">What is the sample variance and standard deviation?</span>
    </p>

    <h3>الحل بالتفصيل (Detailed Solution):</h3>
    
    <h4>Step 1: حساب المتوسط الحسابي</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$\bar{X} = \frac{12 + 14 + 20 + 16 + 18}{5} = \frac{80}{5}$$</p>
      <p style="font-size: 1.3rem; color: var(--color-business);">$$\bar{X} = 16 \text{ dollars}$$</p>
    </div>

    <h4>Step 2: حساب الانحرافات ومربعاتها</h4>
    <div class="table-container" data-aos="zoom-in">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>X</th>
            <th>\(X - \bar{X}\)</th>
            <th>\((X - \bar{X})^2\)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>12</td><td>\(12 - 16 = -4\)</td><td>16</td></tr>
          <tr><td>14</td><td>\(14 - 16 = -2\)</td><td>4</td></tr>
          <tr><td>20</td><td>\(20 - 16 = 4\)</td><td>16</td></tr>
          <tr><td>16</td><td>\(16 - 16 = 0\)</td><td>0</td></tr>
          <tr><td>18</td><td>\(18 - 16 = 2\)</td><td>4</td></tr>
          <tr style="background: rgba(22,163,74,0.15);"><td colspan="2"><strong>المجموع (Sum)</strong></td><td><strong>40</strong></td></tr>
        </tbody>
      </table>
    </div>

    <h4>Step 3: حساب التباين</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$S^2 = \frac{\sum (X - \bar{X})^2}{n - 1} = \frac{40}{5 - 1} = \frac{40}{4}$$</p>
      <p style="font-size: 1.5rem; color: var(--color-finance);"><strong>$$S^2 = 10 \text{ dollars}^2$$</strong></p>
    </div>

    <h4>Step 4: حساب الانحراف المعياري</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$S = \sqrt{S^2} = \sqrt{10}$$</p>
      <p style="font-size: 1.5rem; color: var(--color-primary);"><strong>$$S = 3.16 \text{ dollars}$$</strong></p>
    </div>

    <div class="alert-box alert-success">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <div>
        <strong>التفسير (Interpretation):</strong><br>
        • التباين = <mark class="highlight-finance">10 دولار²</mark><br>
        • الانحراف المعياري = <mark class="highlight-primary">3.16 دولار</mark><br>
        لاحظ إن الانحراف المعياري رجع لنفس وحدة البيانات الأصلية (دولار)، 
        وده بيسهل التفسير: الأجور بتتفاوت في المتوسط بـ <strong>3.16 دولار</strong> عن المتوسط.
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 2 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      سؤال تدريبي 2: التباين والانحراف المعياري
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        التباين والانحراف المعياري يُستخدمان لقياس:<br>
        <span style="color: #64748b;">Variance and standard deviation are used to measure:</span>
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="wrong">أ) القيمة المركزية (Central value)</li>
        <li class="mcq-option" data-answer="correct">ب) التشتت في البيانات (Dispersion in data) ✓</li>
        <li class="mcq-option" data-answer="wrong">ج) العلاقة بين المتغيرات (Relationship between variables)</li>
        <li class="mcq-option" data-answer="wrong">د) الاتجاه العام (General trend)</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 الشرح (Explanation):</h4>
        <div class="alert-box alert-info">
          <div>
            <strong>الإجابة الصحيحة: ب) التشتت في البيانات</strong><br><br>
            التباين والانحراف المعياري هما مقاييس <strong>التشتت</strong> (Measures of Dispersion)، 
            وبيقيسوا مدى <mark class="highlight-orange">انتشار وتباعد</mark> البيانات عن المتوسط الحسابي.<br><br>
            • <strong>القيمة المركزية</strong> بتتقاس بالمتوسط، الوسيط، والمنوال<br>
            • <strong>العلاقة بين المتغيرات</strong> بتتقاس بمعامل الارتباط<br>
            • <strong>الاتجاه العام</strong> بيتقاس بمعادلات الانحدار
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== INTERACTIVE CALCULATOR: VARIANCE & SD ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🧮 حاسبة التباين والانحراف المعياري التفاعلية</h2>
    <p>جرب بنفسك! أدخل القيم وشوف التباين والانحراف المعياري (Try it yourself!)</p>

    <div style="margin: 25px 0;">
      <label style="display: block; font-weight: 600; margin-bottom: 8px; color: var(--color-primary);">
        أدخل القيم مفصولة بفواصل (Enter values separated by commas):
      </label>
      <input type="text" id="varianceValues" placeholder="12, 14, 20, 16, 18" 
             style="width: 100%; padding: 12px; border: 2px solid var(--glass-border); border-radius: 12px; 
                    font-size: 1rem; background: rgba(255,255,255,0.5);">
    </div>

    <button onclick="calculateVariance()" 
            style="background: linear-gradient(135deg, var(--color-finance), var(--color-business)); 
                   color: white; border: none; padding: 15px 40px; border-radius: 50px; 
                   font-size: 1.1rem; font-weight: 700; cursor: pointer; 
                   box-shadow: 0 8px 20px rgba(239,68,68,0.3); transition: all 0.3s ease;
                   width: 100%; max-width: 300px; display: block; margin: 0 auto;">
      <i class="fas fa-calculator"></i> احسب التباين (Calculate)
    </button>

    <div id="varianceResult" style="display: none; margin-top: 30px;" data-aos="fade-up">
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <div>
          <h3 style="margin: 0 0 10px 0; color: var(--color-primary);">النتيجة (Result)</h3>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Number of Values (n):</strong> <span id="varN">--</span>
          </p>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Mean (x̄):</strong> <span id="varMean">--</span>
          </p>
          <p style="font-size: 1.3rem; font-weight: 700; margin: 15px 0; color: var(--color-finance);">
            <strong>Variance (S²):</strong> <span id="varValue">--</span>
          </p>
          <p style="font-size: 1.3rem; font-weight: 700; margin: 15px 0; color: var(--color-primary);">
            <strong>Standard Deviation (S):</strong> <span id="sdValue">--</span>
          </p>
          <div id="varSteps" style="line-height: 2; margin-top: 15px; padding: 15px; 
                                    background: rgba(255,255,255,0.3); border-radius: 12px;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== WHY SD PREFERRED ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🤔 لماذا يُفضّل الانحراف المعياري على التباين؟</h2>
    <h3 style="text-align: center; color: #64748b;">Why is Standard Deviation Preferred over Variance?</h3>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="alert-box alert-warning">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <div>
          <strong>التباين (Variance):</strong><br>
          • الوحدة: <mark class="highlight-orange">مربعة</mark> (دولار², دقيقة²)<br>
          • صعب التفسير المباشر<br>
          • مثال: 10 دولار² (ما معنى دولار تربيع؟)
        </div>
      </div>

      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div>
          <strong>الانحراف المعياري (Standard Deviation):</strong><br>
          • الوحدة: <mark class="highlight-green">نفس البيانات الأصلية</mark> (دولار، دقيقة)<br>
          • سهل التفسير والفهم<br>
          • مثال: 3.16 دولار (واضح ومفهوم!)
        </div>
      </div>

    </div>
  </div>
  <!-- ==================== COMPREHENSIVE EXAMPLE: 25 OBSERVATIONS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📈 مثال 3: تحليل شامل لعينة من 25 ملاحظة</h2>
    <h3 style="text-align: center; color: #64748b;">Comprehensive Analysis: Sample of 25 Observations</h3>
    
    <p>
      دلوقتي خلينا نشوف كيف نستخدم المتوسط والانحراف المعياري مع بعض لفهم 
      <mark class="highlight-blue">توزيع البيانات</mark> بشكل أعمق.
    </p>

    <h3>البيانات (The Data):</h3>
    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr><th colspan="5">Sample of 25 Observations</th></tr>
        </thead>
        <tbody>
          <tr><td>19</td><td>26</td><td>20</td><td>21</td><td>26</td></tr>
          <tr><td>19</td><td>18</td><td>21</td><td>17</td><td>20</td></tr>
          <tr><td>20</td><td>21</td><td>19</td><td>20</td><td>22</td></tr>
          <tr><td>23</td><td>21</td><td>19</td><td>26</td><td>17</td></tr>
          <tr><td>21</td><td>22</td><td>23</td><td>19</td><td>19</td></tr>
        </tbody>
      </table>
    </div>

    <h3>المطلوب (Required):</h3>
    <ol>
      <li>إيجاد المتوسط الحسابي والانحراف المعياري</li>
      <li>عد الملاحظات في الفترة \(\bar{x} \pm S\)</li>
      <li>عد الملاحظات في الفترة \(\bar{x} \pm 2S\)</li>
      <li>عد الملاحظات في الفترة \(\bar{x} \pm 3S\)</li>
    </ol>

    <h3>الحل (Solution):</h3>
    
    <h4>1. المتوسط والانحراف المعياري</h4>
    <div class="formula-box" data-aos="fade-left">
      <p style="font-size: 1.3rem;">$$\bar{x} = 20.76$$</p>
      <p style="font-size: 1.3rem;">$$S = 2.52$$</p>
    </div>

    <h4>2. الفترة \(\bar{x} \pm S\) (One Standard Deviation)</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$\bar{x} \pm S = 20.76 \pm 2.52$$</p>
      <p>$$= (20.76 - 2.52, \, 20.76 + 2.52)$$</p>
      <p style="font-size: 1.2rem; color: var(--color-primary);">$$= (18.24, \, 23.28)$$</p>
    </div>
    
    <div class="alert-box alert-info">
      <div>
        <strong>النتيجة:</strong> <mark class="highlight-green">19 ملاحظة</mark> تقع ضمن هذه الفترة<br>
        <strong>النسبة المئوية:</strong> \(\frac{19}{25} \times 100 = \mathbf{76\%}\)
      </div>
    </div>

    <h4>3. الفترة \(\bar{x} \pm 2S\) (Two Standard Deviations)</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$\bar{x} \pm 2S = 20.76 \pm 2(2.52)$$</p>
      <p>$$= 20.76 \pm 5.04$$</p>
      <p style="font-size: 1.2rem; color: var(--color-business);">$$= (15.72, \, 25.8)$$</p>
    </div>
    
    <div class="alert-box alert-info">
      <div>
        <strong>النتيجة:</strong> <mark class="highlight-blue">22 ملاحظة</mark> تقع ضمن هذه الفترة<br>
        <strong>النسبة المئوية:</strong> \(\frac{22}{25} \times 100 = \mathbf{88\%}\)
      </div>
    </div>

    <h4>4. الفترة \(\bar{x} \pm 3S\) (Three Standard Deviations)</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$\bar{x} \pm 3S = 20.76 \pm 3(2.52)$$</p>
      <p>$$= 20.76 \pm 7.56$$</p>
      <p style="font-size: 1.2rem; color: var(--color-finance);">$$= (13.2, \, 28.32)$$</p>
    </div>
    
    <div class="alert-box alert-info">
      <div>
        <strong>النتيجة:</strong> <mark class="highlight-finance">25 ملاحظة</mark> تقع ضمن هذه الفترة (كل البيانات!)<br>
        <strong>النسبة المئوية:</strong> \(\frac{25}{25} \times 100 = \mathbf{100\%}\)
      </div>
    </div>

    <h3>الاستنتاج المهم (Key Insight):</h3>
    <div class="alert-box alert-success" data-aos="fade-up">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
      <div>
        <strong>قاعدة مهمة في الإحصاء:</strong><br>
        • <mark class="highlight-green">76%</mark> من البيانات تقع ضمن <strong>انحراف معياري واحد</strong> من المتوسط<br>
        • <mark class="highlight-blue">88%</mark> من البيانات تقع ضمن <strong>انحرافين معياريين</strong> من المتوسط<br>
        • <mark class="highlight-finance">100%</mark> من البيانات تقع ضمن <strong>ثلاثة انحرافات معيارية</strong> من المتوسط<br><br>
        هذا يوضح أن <strong>معظم البيانات تتركز حول المتوسط</strong>، وكلما ابتعدنا، كلما قلت البيانات.
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 3 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      سؤال تدريبي 3: تطبيق على الانحرافات المعيارية
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        لو عندك عينة من 20 درجة لطلاب في امتحان، المتوسط = <strong>75</strong> والانحراف المعياري = <strong>5</strong>، 
        احسب الفترة \(\bar{x} \pm 2S\):<br>
        <span style="color: #64748b;">If you have a sample of 20 exam scores with mean = 75 and SD = 5, calculate \(\bar{x} \pm 2S\):</span>
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="wrong">أ) (70, 80)</li>
        <li class="mcq-option" data-answer="correct">ب) (65, 85) ✓</li>
        <li class="mcq-option" data-answer="wrong">ج) (60, 90)</li>
        <li class="mcq-option" data-answer="wrong">د) (55, 95)</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 الحل التفصيلي (Detailed Solution):</h4>
        <div class="formula-box">
          <p>$$\bar{x} \pm 2S = 75 \pm 2(5)$$</p>
          <p>$$= 75 \pm 10$$</p>
          <p>$$= (75 - 10, \, 75 + 10)$$</p>
          <p style="font-size: 1.3rem; color: var(--color-finance);"><strong>$$= (65, \, 85)$$</strong></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== MEDIAN AND QUARTILES ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📊 الوسيط والربيعيات (Median and Quartiles)</h2>
    
    <p>
      بعد ما فهمنا المتوسط الحسابي، دلوقتي خلينا نتعرف على مقاييس أخرى مهمة جداً: 
      <mark class="highlight-green">الوسيط</mark> و<mark class="highlight-blue">الربيعيات</mark>.
    </p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="alert-box alert-info" data-aos="fade-right">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <div>
          <strong>الوسيط (Median):</strong><br>
          القيمة <mark class="highlight-green">الوسطى</mark> في البيانات بعد ترتيبها تصاعدياً أو تنازلياً، 
          ويقسم البيانات لنصفين متساويين.<br><br>
          <strong>The middle value</strong> in ordered data.
        </div>
      </div>

      <div class="alert-box alert-info" data-aos="fade-left">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <div>
          <strong>الربيعيات (Quartiles):</strong><br>
          تقسم البيانات لأربعة أجزاء متساوية:<br>
          • <strong>Q1</strong>: الربيع الأول (25%)<br>
          • <strong>Q2</strong>: الوسيط (50%)<br>
          • <strong>Q3</strong>: الربيع الثالث (75%)<br><br>
          <strong>Divide data into 4 equal parts</strong>
        </div>
      </div>

    </div>

    <h3>كيفية الحساب (How to Calculate):</h3>
    <div class="alert-box alert-warning">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <div>
        <strong>خطوات الحساب:</strong><br>
        1. <strong>رتب البيانات</strong> تصاعدياً (Sort data in ascending order)<br>
        2. الوسيط = القيمة الوسطى (Middle value)<br>
        3. Q1 = وسيط النصف الأدنى (Median of lower half)<br>
        4. Q3 = وسيط النصف الأعلى (Median of upper half)
      </div>
    </div>
  </div>

  <!-- ==================== EXAMPLE: COMMISSIONS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>💰 مثال 4: العمولات الشهرية (Monthly Commissions)</h2>
    
    <p>
      القائمة التالية توضح <mark class="highlight-business">العمولات المكتسبة الشهر الماضي</mark> 
      من قبل عينة من <strong>15 موظف</strong>:
    </p>

    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr><th colspan="5">Monthly Commissions ($)</th></tr>
        </thead>
        <tbody>
          <tr><td>2038</td><td>1758</td><td>1721</td><td>1637</td><td>2097</td></tr>
          <tr><td>2047</td><td>2205</td><td>1787</td><td>2287</td><td>1940</td></tr>
          <tr><td>2311</td><td>2054</td><td>2406</td><td>1471</td><td>1460</td></tr>
        </tbody>
      </table>
    </div>

    <h3>المطلوب (Required):</h3>
    <p>إيجاد الوسيط (Median)، الربيع الأول (Q1)، والربيع الثالث (Q3)</p>

    <h3>الحل (Solution):</h3>
    
    <h4>Step 1: ترتيب البيانات تصاعدياً</h4>
    <div class="table-container" data-aos="fade-left">
      <table class="concepts-table">
        <thead>
          <tr><th>Position</th><th>Value ($)</th><th>Note</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>1460</td><td rowspan="7" style="vertical-align: middle;">Lower Half</td></tr>
          <tr><td>2</td><td>1471</td></tr>
          <tr><td>3</td><td>1637</td></tr>
          <tr style="background: rgba(22,163,74,0.15);"><td>4</td><td><strong>1721</strong></td></tr>
          <tr><td>5</td><td>1758</td></tr>
          <tr><td>6</td><td>1787</td></tr>
          <tr><td>7</td><td>1940</td></tr>
          <tr style="background: rgba(59,130,246,0.15);"><td>8</td><td><strong>2038</strong></td><td><strong>MEDIAN</strong></td></tr>
          <tr><td>9</td><td>2047</td><td rowspan="7" style="vertical-align: middle;">Upper Half</td></tr>
          <tr><td>10</td><td>2054</td></tr>
          <tr><td>11</td><td>2097</td></tr>
          <tr style="background: rgba(239,68,68,0.15);"><td>12</td><td><strong>2205</strong></td></tr>
          <tr><td>13</td><td>2287</td></tr>
          <tr><td>14</td><td>2311</td></tr>
          <tr><td>15</td><td>2406</td></tr>
        </tbody>
      </table>
    </div>

    <h4>Step 2: النتائج</h4>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
      
      <div class="formula-box" data-aos="zoom-in" style="background: linear-gradient(135deg, rgba(22,163,74,0.1), rgba(22,163,74,0.05));">
        <h4 style="color: var(--color-primary); text-align: center;">Q1</h4>
        <p style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-primary);">
          $1,721
        </p>
        <p style="text-align: center; color: #64748b; font-size: 0.9rem;">
          الربيع الأول<br>First Quartile (25%)
        </p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="100" style="background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(59,130,246,0.05));">
        <h4 style="color: var(--color-business); text-align: center;">Median (Q2)</h4>
        <p style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-business);">
          $2,038
        </p>
        <p style="text-align: center; color: #64748b; font-size: 0.9rem;">
          الوسيط<br>Second Quartile (50%)
        </p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="200" style="background: linear-gradient(135deg, rgba(239,68,68,0.1), rgba(239,68,68,0.05));">
        <h4 style="color: var(--color-finance); text-align: center;">Q3</h4>
        <p style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-finance);">
          $2,205
        </p>
        <p style="text-align: center; color: #64748b; font-size: 0.9rem;">
          الربيع الثالث<br>Third Quartile (75%)
        </p>
      </div>

    </div>

    <div class="alert-box alert-success" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <div>
        <strong>التفسير (Interpretation):</strong><br>
        • <strong>25%</strong> من الموظفين كسبوا <mark class="highlight-green">أقل من $1,721</mark><br>
        • <strong>50%</strong> من الموظفين كسبوا <mark class="highlight-blue">أقل من $2,038</mark> (الوسيط)<br>
        • <strong>75%</strong> من الموظفين كسبوا <mark class="highlight-finance">أقل من $2,205</mark><br>
        • <strong>25%</strong> من الموظفين كسبوا أكثر من $2,205
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 4 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      سؤال تدريبي 4: الوسيط
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        الوسيط يُستخدم لقياس:<br>
        <span style="color: #64748b;">The median is used to measure:</span>
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="correct">أ) القيمة المركزية (Central value) ✓</li>
        <li class="mcq-option" data-answer="wrong">ب) التشتت (Dispersion)</li>
        <li class="mcq-option" data-answer="wrong">ج) العلاقة بين المتغيرات (Relationship)</li>
        <li class="mcq-option" data-answer="wrong">د) التكرار (Frequency)</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 الشرح (Explanation):</h4>
        <div class="alert-box alert-info">
          <div>
            <strong>الإجابة الصحيحة: أ) القيمة المركزية</strong><br><br>
            الوسيط هو مقياس من <strong>مقاييس الموقع</strong> (Measures of Location) 
            أو <strong>الاتجاه المركزي</strong> (Central Tendency)، ويوضح <mark class="highlight-green">القيمة الوسطى</mark> 
            التي تقسم البيانات لنصفين متساويين.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== WHEN TO USE MEDIAN ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🤔 متى نستخدم الوسيط بدلاً من المتوسط؟</h2>
    <h3 style="text-align: center; color: #64748b;">When to Use Median Instead of Mean?</h3>

    <div class="alert-box alert-warning">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      <div>
        <strong>القاعدة الذهبية:</strong><br>
        استخدم <mark class="highlight-green">الوسيط</mark> عندما تكون البيانات تحتوي على 
        <strong>قيم شاذة</strong> (Outliers) أو <strong>قيم متطرفة</strong> (Extreme values)
      </div>
    </div>

    <h3>مثال توضيحي:</h3>
    <p>لنفترض أن لدينا رواتب 5 موظفين:</p>
    
    <div class="table-container">
      <table class="concepts-table">
        <thead>
          <tr><th>Employee</th><th>Salary</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>$3,000</td></tr>
          <tr><td>2</td><td>$3,200</td></tr>
          <tr><td>3</td><td>$3,500</td></tr>
          <tr><td>4</td><td>$3,800</td></tr>
          <tr><td>5 (المدير)</td><td>$50,000</td></tr>
        </tbody>
      </table>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="formula-box" data-aos="fade-right">
        <h4 style="color: var(--color-primary); text-align: center;">المتوسط الحسابي</h4>
        <p>$$\bar{X} = \frac{63,500}{5} = 12,700$$</p>
        <p style="text-align: center; color: #64748b;">
          غير ممثل! (Not representative)
        </p>
      </div>

      <div class="formula-box" data-aos="fade-left" style="background: linear-gradient(135deg, rgba(22,163,74,0.1), rgba(22,163,74,0.05));">
        <h4 style="color: var(--color-primary); text-align: center;">الوسيط</h4>
        <p style="text-align: center; font-size: 1.4rem; font-weight: 700;">
          $3,500
        </p>
        <p style="text-align: center; color: #64748b;">
          ممثل أفضل! (Better representative)
        </p>
      </div>

    </div>
  </div>
  <!-- ==================== PRACTICE EXERCISE ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>💪 تمرين شامل للمراجعة (Comprehensive Practice Exercise)</h2>
    
    <p>
      تمرين محاكاة: لو عندك البيانات التالية لأعمار <strong>9 موظفين</strong>:<br>
      <mark class="highlight-blue">22, 25, 27, 30, 32, 35, 40, 45, 50</mark>
    </p>

    <h3>المطلوب (Required):</h3>
    <ol>
      <li>أوجد المتوسط الحسابي (Calculate the mean)</li>
      <li>أوجد التباين (Calculate the variance)</li>
      <li>أوجد الانحراف المعياري (Calculate the standard deviation)</li>
      <li>أوجد الوسيط (Find the median)</li>
      <li>أوجد الربيع الأول Q1 (Find Q1)</li>
      <li>أوجد الربيع الثالث Q3 (Find Q3)</li>
    </ol>

    <button onclick="toggleSolution('practiceExercise')" 
            style="background: linear-gradient(135deg, var(--color-primary), var(--color-business)); 
                   color: white; border: none; padding: 15px 40px; border-radius: 50px; 
                   font-size: 1.1rem; font-weight: 700; cursor: pointer; 
                   box-shadow: 0 8px 20px rgba(22,163,74,0.3); transition: all 0.3s ease;
                   margin: 20px auto; display: block;">
      <i class="fas fa-lightbulb"></i> إظهار الحل (Show Solution)
    </button>

    <div id="practiceExercise" style="display: none; margin-top: 30px;" data-aos="fade-up">
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <div>
          <h3 style="margin: 0 0 15px 0; color: var(--color-primary);">الحل الكامل (Complete Solution)</h3>
          
          <h4>1. المتوسط الحسابي (Mean):</h4>
          <div class="formula-box">
            <p>$$\bar{X} = \frac{22 + 25 + 27 + 30 + 32 + 35 + 40 + 45 + 50}{9}$$</p>
            <p>$$\bar{X} = \frac{306}{9} = 34$$</p>
          </div>

          <h4>2. التباين (Variance):</h4>
          <div class="table-container">
            <table class="concepts-table">
              <thead>
                <tr><th>X</th><th>\(X - \bar{X}\)</th><th>\((X - \bar{X})^2\)</th></tr>
              </thead>
              <tbody>
                <tr><td>22</td><td>-12</td><td>144</td></tr>
                <tr><td>25</td><td>-9</td><td>81</td></tr>
                <tr><td>27</td><td>-7</td><td>49</td></tr>
                <tr><td>30</td><td>-4</td><td>16</td></tr>
                <tr><td>32</td><td>-2</td><td>4</td></tr>
                <tr><td>35</td><td>1</td><td>1</td></tr>
                <tr><td>40</td><td>6</td><td>36</td></tr>
                <tr><td>45</td><td>11</td><td>121</td></tr>
                <tr><td>50</td><td>16</td><td>256</td></tr>
                <tr style="background: rgba(22,163,74,0.15);"><td colspan="2"><strong>المجموع</strong></td><td><strong>708</strong></td></tr>
              </tbody>
            </table>
          </div>
          <div class="formula-box">
            <p>$$S^2 = \frac{708}{9 - 1} = \frac{708}{8} = 88.5$$</p>
          </div>

          <h4>3. الانحراف المعياري (Standard Deviation):</h4>
          <div class="formula-box">
            <p>$$S = \sqrt{88.5} = 9.41$$</p>
          </div>

          <h4>4. الوسيط (Median):</h4>
          <p>البيانات مرتبة بالفعل، والعدد فردي (9)، فالوسيط هو القيمة الخامسة:</p>
          <div class="formula-box">
            <p style="font-size: 1.3rem; color: var(--color-business);">$$\text{Median} = 32$$</p>
          </div>

          <h4>5. الربيع الأول Q1:</h4>
          <p>النصف الأدنى: 22, 25, 27, 30 → الوسيط بينهم:</p>
          <div class="formula-box">
            <p>$$Q1 = \frac{25 + 27}{2} = 26$$</p>
          </div>

          <h4>6. الربيع الثالث Q3:</h4>
          <p>النصف الأعلى: 35, 40, 45, 50 → الوسيط بينهم:</p>
          <div class="formula-box">
            <p>$$Q3 = \frac{40 + 45}{2} = 42.5$$</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 5 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      سؤال تدريبي 5: مقالي قصير
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        اشرح لماذا يُعتبر المتوسط الحسابي مقياساً مهماً لفهم البيانات؟<br>
        <span style="color: #64748b;">Explain why the mean is an important measure for understanding data?</span>
      </p>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 الإجابة النموذجية (Model Answer):</h4>
        <div class="alert-box alert-info">
          <div>
            المتوسط الحسابي مهم لعدة أسباب:<br><br>
            
            <strong>1. تمثيل القيمة المركزية:</strong><br>
            يعطينا <mark class="highlight-green">قيمة واحدة</mark> تمثل كل البيانات، مما يسهل الفهم والمقارنة.<br><br>
            
            <strong>2. سهولة الحساب:</strong><br>
            القانون بسيط وسهل التطبيق: مجموع القيم ÷ عددها.<br><br>
            
            <strong>3. يأخذ كل القيم في الاعتبار:</strong><br>
            على عكس الوسيط، المتوسط <mark class="highlight-blue">يستخدم كل قيمة</mark> في البيانات.<br><br>
            
            <strong>4. أساس للمقاييس الأخرى:</strong><br>
            نحتاج المتوسط لحساب <mark class="highlight-orange">التباين والانحراف المعياري</mark>.<br><br>
            
            <strong>5. مفيد في اتخاذ القرارات:</strong><br>
            يساعد المديرين والمحللين على فهم <strong>الاتجاه العام</strong> للبيانات واتخاذ قرارات مستنيرة.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== COMPREHENSIVE CONCEPTS TABLE ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📚 جدول المفاهيم الأساسية الشامل</h2>
    <h3 style="text-align: center; color: #64748b;">Comprehensive Key Concepts Table</h3>
    
    <div class="table-container" data-aos="fade-up">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>المفهوم<br>Concept</th>
            <th>التعريف الرسمي<br>Official Definition</th>
            <th>الخلاصة<br>The Gist</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>المتوسط الحسابي</strong><br>Sample Mean</td>
            <td>مجموع كل القيم مقسوماً على عدد القيم<br>Sum of all values ÷ Number of values</td>
            <td>القيمة المركزية<br>Central Value</td>
          </tr>
          <tr>
            <td><strong>التباين</strong><br>Variance</td>
            <td>المتوسط الحسابي لمربعات الانحرافات عن المتوسط<br>Arithmetic mean of squared deviations</td>
            <td>قياس التشتت<br>Measuring Spread</td>
          </tr>
          <tr>
            <td><strong>الانحراف المعياري</strong><br>Standard Deviation</td>
            <td>الجذر التربيعي للتباين<br>Square root of variance</td>
            <td>جذر التباين<br>Root of Variance</td>
          </tr>
          <tr>
            <td><strong>الوسيط</strong><br>Median</td>
            <td>القيمة الوسطى بعد ترتيب البيانات<br>Middle value in ordered data</td>
            <td>القيمة الوسطى<br>Middle Value</td>
          </tr>
          <tr>
            <td><strong>الربيع الأول</strong><br>First Quartile (Q1)</td>
            <td>القيمة التي تقع عندها 25% من البيانات أقل منها<br>Value below which 25% falls</td>
            <td>الربع الأول<br>First Quarter</td>
          </tr>
          <tr>
            <td><strong>الربيع الثالث</strong><br>Third Quartile (Q3)</td>
            <td>القيمة التي تقع عندها 75% من البيانات أقل منها<br>Value below which 75% falls</td>
            <td>الربع الثالث<br>Third Quarter</td>
          </tr>
          <tr>
            <td><strong>مقاييس الموقع</strong><br>Measures of Location</td>
            <td>مقاييس توضح القيمة المركزية للبيانات<br>Measures showing central value</td>
            <td>الاتجاه المركزي<br>Central Tendency</td>
          </tr>
          <tr>
            <td><strong>مقاييس التشتت</strong><br>Measures of Variability</td>
            <td>مقاييس توضح مدى انتشار وتباين البيانات<br>Measures showing data spread</td>
            <td>قياس الانتشار<br>Measuring Dispersion</td>
          </tr>
          <tr>
            <td><strong>المدى</strong><br>Range</td>
            <td>الفرق بين أكبر وأصغر قيمة<br>Difference between max and min</td>
            <td>اتساع البيانات<br>Data Width</td>
          </tr>
          <tr>
            <td><strong>درجات الحرية</strong><br>Degrees of Freedom</td>
            <td>عدد القيم الحرة في الحساب = n - 1<br>Number of free values = n - 1</td>
            <td>n - 1</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ==================== FORMULAS SUMMARY ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📐 ملخص المعادلات الأساسية (Key Formulas Summary)</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
      
      <div class="formula-box" data-aos="zoom-in" data-aos-delay="100">
        <h4 style="color: var(--color-primary); text-align: center;">المتوسط الحسابي<br>Sample Mean</h4>
        <p>$$\bar{X} = \frac{\sum x}{n}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="200">
        <h4 style="color: var(--color-finance); text-align: center;">التباين<br>Variance</h4>
        <p>$$S^2 = \frac{\sum (X - \bar{X})^2}{n - 1}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="300">
        <h4 style="color: var(--color-business); text-align: center;">الانحراف المعياري<br>Standard Deviation</h4>
        <p>$$S = \sqrt{\frac{\sum (X - \bar{X})^2}{n - 1}}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="400">
        <h4 style="color: var(--color-economics); text-align: center;">المدى<br>Range</h4>
        <p>$$R = X_{\max} - X_{\min}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="500">
        <h4 style="color: var(--color-primary); text-align: center;">الفترة ± 1 SD</h4>
        <p>$$\bar{x} \pm S$$</p>
        <p style="font-size: 0.9rem; color: #64748b;">~68-76% of data</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="600">
        <h4 style="color: var(--color-business); text-align: center;">الفترة ± 2 SD</h4>
        <p>$$\bar{x} \pm 2S$$</p>
        <p style="font-size: 0.9rem; color: #64748b;">~95% of data</p>
      </div>

    </div>
  </div>

  <!-- ==================== KEY TAKEAWAYS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🎯 النقاط الأساسية (Key Takeaways)</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
      
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div>
          <strong>1. مقاييس الموقع:</strong><br>
          • المتوسط: للبيانات العادية<br>
          • الوسيط: للبيانات ذات القيم الشاذة<br>
          • المنوال: للبيانات الفئوية
        </div>
      </div>

      <div class="alert-box alert-info">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <div>
          <strong>2. مقاييس التشتت:</strong><br>
          • التباين: بوحدة مربعة<br>
          • الانحراف المعياري: بنفس وحدة البيانات<br>
          • المدى: سهل لكن غير دقيق
        </div>
      </div>

      <div class="alert-box alert-warning">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <div>
          <strong>3. القاعدة العامة:</strong><br>
          • ~76% ضمن ±1 SD<br>
          • ~88-95% ضمن ±2 SD<br>
          • ~99% ضمن ±3 SD
        </div>
      </div>

    </div>
  </div>

  <!-- ==================== FOOTER ==================== -->
  <div class="footer-info" data-aos="fade-up">
    <div class="footer-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
      منصة أثر التعليمية | Athr Educational Platform
    </div>
    <div class="footer-divider"></div>
    <div class="footer-disclaimer">
      هذا المحتوى التعليمي مُصمم لمساعدة الطلاب في فهم <strong>المقاييس العددية</strong> و<strong>مقاييس التشتت</strong> بطريقة تفاعلية.<br>
      This educational content is designed to help students understand <strong>numerical measures</strong> and <strong>dispersion measures</strong> interactively.<br>
      <strong style="color: var(--color-primary);">© 2025 Athr Platform - All Rights Reserved</strong>
    </div>
  </div>

</div>
<!-- ==================== END ARABIC CONTENT: LECTURE 3 ==================== -->

  <!-- ==================== ENGLISH CONTENT (هنا هنحط الإنجليزي بعدين) ==================== -->
 <!-- ==================== LECTURE 3: NUMERICAL MEASURES - ENGLISH ==================== -->
<div class="en-content" style="display: none;">
  
  <!-- ==================== HEADER ==================== -->
  <div class="glassy-card" data-aos="fade-down">
    <h1>📊 Describing Data: Numerical Measures</h1>
    <p style="text-align: center; font-size: 1.1rem; color: #475569; margin-top: 15px;">
      An interactive educational journey to understand <mark class="highlight-green">Numerical Measures</mark> and <mark class="highlight-blue">Measures of Dispersion</mark> in Statistics
    </p>
    
    <div class="stats-grid" style="margin-top: 30px;">
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="100">
        <div class="stat-value" style="color: var(--color-primary);">15+</div>
        <div class="stat-label">Practical Examples</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="200">
        <div class="stat-value" style="color: var(--color-business);">10+</div>
        <div class="stat-label">Statistical Formulas</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="300">
        <div class="stat-value" style="color: var(--color-finance);">6</div>
        <div class="stat-label">Interactive Questions</div>
      </div>
      <div class="stat-card" data-aos="zoom-in" data-aos-delay="400">
        <div class="stat-value" style="color: var(--color-economics);">2</div>
        <div class="stat-label">Interactive Calculators</div>
      </div>
    </div>
  </div>

  <!-- ==================== INTRODUCTION ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📖 Why Do We Need Numerical Measures?</h2>
    <p>
      When dealing with data, it's not enough to just know the numbers. We need to understand the <mark class="highlight-blue">central values</mark> 
      and the <mark class="highlight-orange">spread</mark> of the data to get a complete picture of its behavior.
    </p>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Core Idea:</strong> Numerical measures help us:<br>
        1. Understand the <strong>central value</strong> of data<br>
        2. Measure the <strong>spread and dispersion</strong> of data
      </div>
    </div>

    <h3>Two Main Types of Measures:</h3>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="formula-box" data-aos="fade-right" style="background: linear-gradient(135deg, rgba(22,163,74,0.1), rgba(22,163,74,0.05));">
        <h4 style="color: var(--color-primary); text-align: center;">📍 Measures of Location</h4>
        <p style="text-align: center; font-weight: 600;">(Central Tendency Measures)</p>
        <ul style="margin-top: 15px;">
          <li>Mean - المتوسط الحسابي</li>
          <li>Median - الوسيط</li>
          <li>Mode - المنوال</li>
        </ul>
      </div>

      <div class="formula-box" data-aos="fade-left" style="background: linear-gradient(135deg, rgba(239,68,68,0.1), rgba(239,68,68,0.05));">
        <h4 style="color: var(--color-finance); text-align: center;">📏 Measures of Variability</h4>
        <p style="text-align: center; font-weight: 600;">(Dispersion Measures)</p>
        <ul style="margin-top: 15px;">
          <li>Range - المدى</li>
          <li>Variance - التباين</li>
          <li>Standard Deviation - الانحراف المعياري</li>
        </ul>
      </div>

    </div>
  </div>

  <!-- ==================== SAMPLE MEAN ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📊 The Sample Mean</h2>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Official Definition:</strong><br>
        The sample mean = Sum of all the values in the sample ÷ Number of values in the sample
      </div>
    </div>

    <h3>Mathematical Formula:</h3>
    <div class="formula-box" data-aos="zoom-in">
      <p style="text-align: center; font-size: 1.4rem;">
        $$\bar{X} = \frac{\sum x}{n}$$
      </p>
    </div>

    <h4>Variables Explanation:</h4>
    <ul>
      <li><strong>\(\bar{X}\)</strong>: Sample Mean</li>
      <li><strong>\(\sum x\)</strong>: Sum of all values</li>
      <li><strong>\(n\)</strong>: Number of values in sample</li>
    </ul>

    <div class="alert-box alert-success" data-aos="fade-left" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
      <div>
        <strong>Simple Idea:</strong><br>
        Imagine you have 12 friends, and you want to know on average how many minutes each spends on phone calls monthly. 
        You add up all the minutes and divide by 12—that's exactly the mean!
      </div>
    </div>
  </div>

  <!-- ==================== EXAMPLE: SUN COM ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📱 Example 1: Sun Com Cellular Company</h2>
    <p>
      Sun Com is studying the number of minutes used monthly by customers in the 
      <mark class="highlight-blue">"Friends and Family"</mark> cellular plan. 
      A random sample of <strong>12 customers</strong> showed the following data for minutes used last month:
    </p>

    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>Customer</th>
            <th>Minutes</th>
            <th>Customer</th>
            <th>Minutes</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>90</td><td>7</td><td>88</td></tr>
          <tr><td>2</td><td>77</td><td>8</td><td>94</td></tr>
          <tr><td>3</td><td>94</td><td>9</td><td>125</td></tr>
          <tr><td>4</td><td>89</td><td>10</td><td>96</td></tr>
          <tr><td>5</td><td>119</td><td>11</td><td>144</td></tr>
          <tr><td>6</td><td>112</td><td>12</td><td>83</td></tr>
        </tbody>
      </table>
    </div>

    <h3>Question:</h3>
    <p style="font-weight: 600; font-size: 1.1rem; color: var(--color-primary);">
      What is the sample mean of minutes used?
    </p>

    <h3>Detailed Solution:</h3>
    
    <h4>Step 1: Sum all values</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$\sum x = 90 + 77 + 94 + 89 + 119 + 112 + 88 + 94 + 125 + 96 + 144 + 83$$</p>
      <p style="font-size: 1.3rem; color: var(--color-business);">$$\sum x = 1170 \text{ minutes}$$</p>
    </div>

    <h4>Step 2: Apply the formula</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$\bar{X} = \frac{\sum x}{n} = \frac{1170}{12}$$</p>
      <p style="font-size: 1.5rem; color: var(--color-primary);"><strong>$$\bar{X} = 97.5 \text{ minutes}$$</strong></p>
    </div>

    <div class="alert-box alert-success">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <div>
        <strong>Interpretation:</strong><br>
        On average, a customer uses <mark class="highlight-finance">97.5 minutes monthly</mark> on this plan, 
        giving us a general idea about average usage behavior.
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 1 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      Practice Question 1: Calculating the Mean
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        If you have 5 students with exam scores: <strong>80, 90, 70, 85, 75</strong>, what is the mean?
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="wrong">A) 75</li>
        <li class="mcq-option" data-answer="correct">B) 80 ✓</li>
        <li class="mcq-option" data-answer="wrong">C) 85</li>
        <li class="mcq-option" data-answer="wrong">D) 90</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 Detailed Solution:</h4>
        <div class="formula-box">
          <p>$$\bar{X} = \frac{\sum x}{n} = \frac{80 + 90 + 70 + 85 + 75}{5}$$</p>
          <p>$$\bar{X} = \frac{400}{5}$$</p>
          <p style="font-size: 1.3rem; color: var(--color-finance);"><strong>$$\bar{X} = 80$$</strong></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== INTERACTIVE CALCULATOR: MEAN ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🧮 Interactive Mean Calculator</h2>
    <p>Try it yourself! Enter values and see the mean</p>

    <div style="margin: 25px 0;">
      <label style="display: block; font-weight: 600; margin-bottom: 8px; color: var(--color-primary);">
        Enter values separated by commas:
      </label>
      <input type="text" id="meanValuesEn" placeholder="80, 90, 70, 85, 75" 
             style="width: 100%; padding: 12px; border: 2px solid var(--glass-border); border-radius: 12px; 
                    font-size: 1rem; background: rgba(255,255,255,0.5);">
    </div>

    <button onclick="calculateMeanEn()" 
            style="background: linear-gradient(135deg, var(--color-primary), var(--color-primary-medium)); 
                   color: white; border: none; padding: 15px 40px; border-radius: 50px; 
                   font-size: 1.1rem; font-weight: 700; cursor: pointer; 
                   box-shadow: 0 8px 20px rgba(22,163,74,0.3); transition: all 0.3s ease;
                   width: 100%; max-width: 300px; display: block; margin: 0 auto;">
      <i class="fas fa-calculator"></i> Calculate Mean
    </button>

    <div id="meanResultEn" style="display: none; margin-top: 30px;" data-aos="fade-up">
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <div>
          <h3 style="margin: 0 0 10px 0; color: var(--color-primary);">Result</h3>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Number of Values (n):</strong> <span id="meanNEn">--</span>
          </p>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Sum (Σx):</strong> <span id="meanSumEn">--</span>
          </p>
          <p style="font-size: 1.4rem; font-weight: 700; margin: 15px 0; color: var(--color-finance);">
            <strong>Mean (x̄):</strong> <span id="meanValueEn">--</span>
          </p>
        </div>
      </div>
    </div>
  </div>
  <!-- ==================== MEASURES OF DISPERSION ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📏 Measures of Dispersion: Variance and Standard Deviation</h2>
    
    <p>
      After understanding the mean (which gives us the <mark class="highlight-green">central value</mark>), 
      we now need to understand <mark class="highlight-orange">dispersion</mark>, because knowing the mean alone isn't enough—
      we need to know <strong>how spread out</strong> the data is from that mean.
    </p>

    <div class="alert-box alert-warning" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      <div>
        <strong>Why Dispersion Matters:</strong><br>
        For example: Two companies have average salaries of $5,000, but:<br>
        • <strong>Company A:</strong> All employees earn between $4,500-$5,500 (low dispersion)<br>
        • <strong>Company B:</strong> Some earn $2,000, others $8,000 (high dispersion)<br>
        Same mean, but completely different dispersion!
      </div>
    </div>
  </div>

  <!-- ==================== VARIANCE ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📊 Variance</h2>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Official Definition:</strong><br>
        VARIANCE: The arithmetic mean of the squared deviations from the mean.
      </div>
    </div>

    <h3>Sample Variance Formula:</h3>
    <div class="formula-box" data-aos="zoom-in">
      <p style="text-align: center; font-size: 1.4rem;">
        $$S^2 = \frac{\sum (X - \bar{X})^2}{n - 1}$$
      </p>
    </div>

    <h4>Variables Explanation:</h4>
    <ul>
      <li><strong>\(S^2\)</strong>: Sample Variance</li>
      <li><strong>\(X\)</strong>: Value of each observation in the sample</li>
      <li><strong>\(\bar{X}\)</strong>: Sample Mean</li>
      <li><strong>\(n\)</strong>: Number of observations in the sample</li>
      <li><strong>\(n - 1\)</strong>: Degrees of Freedom</li>
    </ul>

    <div class="alert-box alert-success" data-aos="fade-left" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
        <polyline points="22 4 12 14.01 9 11.01"></polyline>
      </svg>
      <div>
        <strong>Simple Idea:</strong><br>
        Variance measures how far <mark class="highlight-orange">each value is from the mean</mark>. 
        When values are <strong>close</strong> to the mean, variance is <strong>small</strong>. 
        When they're <strong>far apart</strong>, variance is <strong>large</strong>.
      </div>
    </div>
  </div>

  <!-- ==================== STANDARD DEVIATION ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📐 Standard Deviation</h2>
    
    <div class="alert-box alert-info" data-aos="fade-right">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="16" x2="12" y2="12"></line>
        <line x1="12" y1="8" x2="12.01" y2="8"></line>
      </svg>
      <div>
        <strong>Official Definition:</strong><br>
        STANDARD DEVIATION: The square root of the variance.
      </div>
    </div>

    <h3>Sample Standard Deviation Formula:</h3>
    <div class="formula-box" data-aos="zoom-in">
      <p style="text-align: center; font-size: 1.4rem;">
        $$S = \sqrt{\frac{\sum (X - \bar{X})^2}{n - 1}}$$
      </p>
    </div>

    <div class="alert-box alert-warning" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <div>
        <strong>Important Note:</strong><br>
        Standard deviation returns us to the <mark class="highlight-green">same unit as the original data</mark>, 
        while variance is in <mark class="highlight-orange">squared units</mark> (like dollars², minutes²), 
        making standard deviation <strong>easier to interpret</strong>.
      </div>
    </div>
  </div>

  <!-- ==================== EXAMPLE: FRUIT PACKERS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🍎 Example 2: Fruit Packers Inc. Employee Wages</h2>
    <p>
      The hourly wages for a sample of <strong>5 part-time employees</strong> at Fruit Packers Inc. are:
    </p>

    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>Employee</th>
            <th>Hourly Wage ($)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>$12</td></tr>
          <tr><td>2</td><td>$14</td></tr>
          <tr><td>3</td><td>$20</td></tr>
          <tr><td>4</td><td>$16</td></tr>
          <tr><td>5</td><td>$18</td></tr>
        </tbody>
      </table>
    </div>

    <h3>Question:</h3>
    <p style="font-weight: 600; font-size: 1.1rem; color: var(--color-primary);">
      What is the sample variance and standard deviation?
    </p>

    <h3>Detailed Solution:</h3>
    
    <h4>Step 1: Calculate the mean</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$\bar{X} = \frac{12 + 14 + 20 + 16 + 18}{5} = \frac{80}{5}$$</p>
      <p style="font-size: 1.3rem; color: var(--color-business);">$$\bar{X} = 16 \text{ dollars}$$</p>
    </div>

    <h4>Step 2: Calculate deviations and squared deviations</h4>
    <div class="table-container" data-aos="zoom-in">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>X</th>
            <th>\(X - \bar{X}\)</th>
            <th>\((X - \bar{X})^2\)</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>12</td><td>\(12 - 16 = -4\)</td><td>16</td></tr>
          <tr><td>14</td><td>\(14 - 16 = -2\)</td><td>4</td></tr>
          <tr><td>20</td><td>\(20 - 16 = 4\)</td><td>16</td></tr>
          <tr><td>16</td><td>\(16 - 16 = 0\)</td><td>0</td></tr>
          <tr><td>18</td><td>\(18 - 16 = 2\)</td><td>4</td></tr>
          <tr style="background: rgba(22,163,74,0.15);"><td colspan="2"><strong>Sum</strong></td><td><strong>40</strong></td></tr>
        </tbody>
      </table>
    </div>

    <h4>Step 3: Calculate variance</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$S^2 = \frac{\sum (X - \bar{X})^2}{n - 1} = \frac{40}{5 - 1} = \frac{40}{4}$$</p>
      <p style="font-size: 1.5rem; color: var(--color-finance);"><strong>$$S^2 = 10 \text{ dollars}^2$$</strong></p>
    </div>

    <h4>Step 4: Calculate standard deviation</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$S = \sqrt{S^2} = \sqrt{10}$$</p>
      <p style="font-size: 1.5rem; color: var(--color-primary);"><strong>$$S = 3.16 \text{ dollars}$$</strong></p>
    </div>

    <div class="alert-box alert-success">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <div>
        <strong>Interpretation:</strong><br>
        • Variance = <mark class="highlight-finance">10 dollars²</mark><br>
        • Standard Deviation = <mark class="highlight-primary">3.16 dollars</mark><br>
        Notice that standard deviation is back in the original unit (dollars), 
        making it easier to interpret: wages vary on average by <strong>$3.16</strong> from the mean.
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 2 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      Practice Question 2: Variance and Standard Deviation
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        Variance and standard deviation are used to measure:
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="wrong">A) Central value</li>
        <li class="mcq-option" data-answer="correct">B) Dispersion in data ✓</li>
        <li class="mcq-option" data-answer="wrong">C) Relationship between variables</li>
        <li class="mcq-option" data-answer="wrong">D) General trend</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 Explanation:</h4>
        <div class="alert-box alert-info">
          <div>
            <strong>Correct Answer: B) Dispersion in data</strong><br><br>
            Variance and standard deviation are <strong>measures of dispersion</strong> (Measures of Variability), 
            measuring how <mark class="highlight-orange">spread out and scattered</mark> the data is from the mean.<br><br>
            • <strong>Central value</strong> is measured by mean, median, and mode<br>
            • <strong>Relationship between variables</strong> is measured by correlation coefficient<br>
            • <strong>General trend</strong> is measured by regression equations
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== INTERACTIVE CALCULATOR: VARIANCE & SD ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🧮 Interactive Variance & Standard Deviation Calculator</h2>
    <p>Try it yourself! Enter values and see the variance and standard deviation</p>

    <div style="margin: 25px 0;">
      <label style="display: block; font-weight: 600; margin-bottom: 8px; color: var(--color-primary);">
        Enter values separated by commas:
      </label>
      <input type="text" id="varianceValuesEn" placeholder="12, 14, 20, 16, 18" 
             style="width: 100%; padding: 12px; border: 2px solid var(--glass-border); border-radius: 12px; 
                    font-size: 1rem; background: rgba(255,255,255,0.5);">
    </div>

    <button onclick="calculateVarianceEn()" 
            style="background: linear-gradient(135deg, var(--color-finance), var(--color-business)); 
                   color: white; border: none; padding: 15px 40px; border-radius: 50px; 
                   font-size: 1.1rem; font-weight: 700; cursor: pointer; 
                   box-shadow: 0 8px 20px rgba(239,68,68,0.3); transition: all 0.3s ease;
                   width: 100%; max-width: 300px; display: block; margin: 0 auto;">
      <i class="fas fa-calculator"></i> Calculate Variance
    </button>

    <div id="varianceResultEn" style="display: none; margin-top: 30px;" data-aos="fade-up">
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <div>
          <h3 style="margin: 0 0 10px 0; color: var(--color-primary);">Result</h3>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Number of Values (n):</strong> <span id="varNEn">--</span>
          </p>
          <p style="font-size: 1.1rem; margin: 10px 0;">
            <strong>Mean (x̄):</strong> <span id="varMeanEn">--</span>
          </p>
          <p style="font-size: 1.3rem; font-weight: 700; margin: 15px 0; color: var(--color-finance);">
            <strong>Variance (S²):</strong> <span id="varValueEn">--</span>
          </p>
          <p style="font-size: 1.3rem; font-weight: 700; margin: 15px 0; color: var(--color-primary);">
            <strong>Standard Deviation (S):</strong> <span id="sdValueEn">--</span>
          </p>
          <div id="varStepsEn" style="line-height: 2; margin-top: 15px; padding: 15px; 
                                    background: rgba(255,255,255,0.3); border-radius: 12px;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== WHY SD PREFERRED ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🤔 Why is Standard Deviation Preferred over Variance?</h2>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="alert-box alert-warning">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <div>
          <strong>Variance:</strong><br>
          • Unit: <mark class="highlight-orange">Squared</mark> (dollars², minutes²)<br>
          • Difficult to interpret directly<br>
          • Example: 10 dollars² (what does squared dollars mean?)
        </div>
      </div>

      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div>
          <strong>Standard Deviation:</strong><br>
          • Unit: <mark class="highlight-green">Same as original data</mark> (dollars, minutes)<br>
          • Easy to interpret and understand<br>
          • Example: 3.16 dollars (clear and meaningful!)
        </div>
      </div>

    </div>
  </div>
  <!-- ==================== COMPREHENSIVE EXAMPLE: 25 OBSERVATIONS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📈 Example 3: Comprehensive Analysis - Sample of 25 Observations</h2>
    
    <p>
      Now let's see how to use the mean and standard deviation together to understand 
      the <mark class="highlight-blue">data distribution</mark> more deeply.
    </p>

    <h3>The Data:</h3>
    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr><th colspan="5">Sample of 25 Observations</th></tr>
        </thead>
        <tbody>
          <tr><td>19</td><td>26</td><td>20</td><td>21</td><td>26</td></tr>
          <tr><td>19</td><td>18</td><td>21</td><td>17</td><td>20</td></tr>
          <tr><td>20</td><td>21</td><td>19</td><td>20</td><td>22</td></tr>
          <tr><td>23</td><td>21</td><td>19</td><td>26</td><td>17</td></tr>
          <tr><td>21</td><td>22</td><td>23</td><td>19</td><td>19</td></tr>
        </tbody>
      </table>
    </div>

    <h3>Required:</h3>
    <ol>
      <li>Find the mean and standard deviation</li>
      <li>Count observations within \(\bar{x} \pm S\)</li>
      <li>Count observations within \(\bar{x} \pm 2S\)</li>
      <li>Count observations within \(\bar{x} \pm 3S\)</li>
    </ol>

    <h3>Solution:</h3>
    
    <h4>1. Mean and Standard Deviation</h4>
    <div class="formula-box" data-aos="fade-left">
      <p style="font-size: 1.3rem;">$$\bar{x} = 20.76$$</p>
      <p style="font-size: 1.3rem;">$$S = 2.52$$</p>
    </div>

    <h4>2. Interval \(\bar{x} \pm S\) (One Standard Deviation)</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$\bar{x} \pm S = 20.76 \pm 2.52$$</p>
      <p>$$= (20.76 - 2.52, \, 20.76 + 2.52)$$</p>
      <p style="font-size: 1.2rem; color: var(--color-primary);">$$= (18.24, \, 23.28)$$</p>
    </div>
    
    <div class="alert-box alert-info">
      <div>
        <strong>Result:</strong> <mark class="highlight-green">19 observations</mark> fall within this interval<br>
        <strong>Percentage:</strong> \(\frac{19}{25} \times 100 = \mathbf{76\%}\)
      </div>
    </div>

    <h4>3. Interval \(\bar{x} \pm 2S\) (Two Standard Deviations)</h4>
    <div class="formula-box" data-aos="fade-left">
      <p>$$\bar{x} \pm 2S = 20.76 \pm 2(2.52)$$</p>
      <p>$$= 20.76 \pm 5.04$$</p>
      <p style="font-size: 1.2rem; color: var(--color-business);">$$= (15.72, \, 25.8)$$</p>
    </div>
    
    <div class="alert-box alert-info">
      <div>
        <strong>Result:</strong> <mark class="highlight-blue">22 observations</mark> fall within this interval<br>
        <strong>Percentage:</strong> \(\frac{22}{25} \times 100 = \mathbf{88\%}\)
      </div>
    </div>

    <h4>4. Interval \(\bar{x} \pm 3S\) (Three Standard Deviations)</h4>
    <div class="formula-box" data-aos="fade-right">
      <p>$$\bar{x} \pm 3S = 20.76 \pm 3(2.52)$$</p>
      <p>$$= 20.76 \pm 7.56$$</p>
      <p style="font-size: 1.2rem; color: var(--color-finance);">$$= (13.2, \, 28.32)$$</p>
    </div>
    
    <div class="alert-box alert-info">
      <div>
        <strong>Result:</strong> <mark class="highlight-finance">25 observations</mark> fall within this interval (all data!)<br>
        <strong>Percentage:</strong> \(\frac{25}{25} \times 100 = \mathbf{100\%}\)
      </div>
    </div>

    <h3>Key Insight:</h3>
    <div class="alert-box alert-success" data-aos="fade-up">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
      <div>
        <strong>Important Statistical Rule:</strong><br>
        • <mark class="highlight-green">76%</mark> of data falls within <strong>one standard deviation</strong> of the mean<br>
        • <mark class="highlight-blue">88%</mark> of data falls within <strong>two standard deviations</strong> of the mean<br>
        • <mark class="highlight-finance">100%</mark> of data falls within <strong>three standard deviations</strong> of the mean<br><br>
        This shows that <strong>most data concentrates around the mean</strong>, and the further you go, the less data you find.
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 3 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      Practice Question 3: Standard Deviations Application
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        If you have a sample of 20 exam scores with mean = <strong>75</strong> and SD = <strong>5</strong>, 
        calculate the interval \(\bar{x} \pm 2S\):
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="wrong">A) (70, 80)</li>
        <li class="mcq-option" data-answer="correct">B) (65, 85) ✓</li>
        <li class="mcq-option" data-answer="wrong">C) (60, 90)</li>
        <li class="mcq-option" data-answer="wrong">D) (55, 95)</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 Detailed Solution:</h4>
        <div class="formula-box">
          <p>$$\bar{x} \pm 2S = 75 \pm 2(5)$$</p>
          <p>$$= 75 \pm 10$$</p>
          <p>$$= (75 - 10, \, 75 + 10)$$</p>
          <p style="font-size: 1.3rem; color: var(--color-finance);"><strong>$$= (65, \, 85)$$</strong></p>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== MEDIAN AND QUARTILES ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📊 Median and Quartiles</h2>
    
    <p>
      After understanding the mean, let's now explore other important measures: 
      the <mark class="highlight-green">median</mark> and <mark class="highlight-blue">quartiles</mark>.
    </p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="alert-box alert-info" data-aos="fade-right">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <div>
          <strong>Median:</strong><br>
          The <mark class="highlight-green">middle value</mark> in ordered data, dividing the data into two equal halves.<br><br>
          <strong>The middle value in ordered data.</strong>
        </div>
      </div>

      <div class="alert-box alert-info" data-aos="fade-left">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <div>
          <strong>Quartiles:</strong><br>
          Divide data into four equal parts:<br>
          • <strong>Q1</strong>: First Quartile (25%)<br>
          • <strong>Q2</strong>: Median (50%)<br>
          • <strong>Q3</strong>: Third Quartile (75%)<br><br>
          <strong>Divide data into 4 equal parts</strong>
        </div>
      </div>

    </div>

    <h3>How to Calculate:</h3>
    <div class="alert-box alert-warning">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <line x1="12" y1="8" x2="12" y2="12"></line>
        <line x1="12" y1="16" x2="12.01" y2="16"></line>
      </svg>
      <div>
        <strong>Calculation Steps:</strong><br>
        1. <strong>Sort data</strong> in ascending order<br>
        2. Median = Middle value<br>
        3. Q1 = Median of lower half<br>
        4. Q3 = Median of upper half
      </div>
    </div>
  </div>

  <!-- ==================== EXAMPLE: COMMISSIONS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>💰 Example 4: Monthly Commissions</h2>
    
    <p>
      The following list shows the <mark class="highlight-business">monthly commissions earned last month</mark> 
      by a sample of <strong>15 employees</strong>:
    </p>

    <div class="table-container" data-aos="fade-right">
      <table class="concepts-table">
        <thead>
          <tr><th colspan="5">Monthly Commissions ($)</th></tr>
        </thead>
        <tbody>
          <tr><td>2038</td><td>1758</td><td>1721</td><td>1637</td><td>2097</td></tr>
          <tr><td>2047</td><td>2205</td><td>1787</td><td>2287</td><td>1940</td></tr>
          <tr><td>2311</td><td>2054</td><td>2406</td><td>1471</td><td>1460</td></tr>
        </tbody>
      </table>
    </div>

    <h3>Required:</h3>
    <p>Find the Median, First Quartile (Q1), and Third Quartile (Q3)</p>

    <h3>Solution:</h3>
    
    <h4>Step 1: Sort data in ascending order</h4>
    <div class="table-container" data-aos="fade-left">
      <table class="concepts-table">
        <thead>
          <tr><th>Position</th><th>Value ($)</th><th>Note</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>1460</td><td rowspan="7" style="vertical-align: middle;">Lower Half</td></tr>
          <tr><td>2</td><td>1471</td></tr>
          <tr><td>3</td><td>1637</td></tr>
          <tr style="background: rgba(22,163,74,0.15);"><td>4</td><td><strong>1721</strong></td></tr>
          <tr><td>5</td><td>1758</td></tr>
          <tr><td>6</td><td>1787</td></tr>
          <tr><td>7</td><td>1940</td></tr>
          <tr style="background: rgba(59,130,246,0.15);"><td>8</td><td><strong>2038</strong></td><td><strong>MEDIAN</strong></td></tr>
          <tr><td>9</td><td>2047</td><td rowspan="7" style="vertical-align: middle;">Upper Half</td></tr>
          <tr><td>10</td><td>2054</td></tr>
          <tr><td>11</td><td>2097</td></tr>
          <tr style="background: rgba(239,68,68,0.15);"><td>12</td><td><strong>2205</strong></td></tr>
          <tr><td>13</td><td>2287</td></tr>
          <tr><td>14</td><td>2311</td></tr>
          <tr><td>15</td><td>2406</td></tr>
        </tbody>
      </table>
    </div>

    <h4>Step 2: Results</h4>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
      
      <div class="formula-box" data-aos="zoom-in" style="background: linear-gradient(135deg, rgba(22,163,74,0.1), rgba(22,163,74,0.05));">
        <h4 style="color: var(--color-primary); text-align: center;">Q1</h4>
        <p style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-primary);">
          $1,721
        </p>
        <p style="text-align: center; color: #64748b; font-size: 0.9rem;">
          First Quartile (25%)
        </p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="100" style="background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(59,130,246,0.05));">
        <h4 style="color: var(--color-business); text-align: center;">Median (Q2)</h4>
        <p style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-business);">
          $2,038
        </p>
        <p style="text-align: center; color: #64748b; font-size: 0.9rem;">
          Second Quartile (50%)
        </p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="200" style="background: linear-gradient(135deg, rgba(239,68,68,0.1), rgba(239,68,68,0.05));">
        <h4 style="color: var(--color-finance); text-align: center;">Q3</h4>
        <p style="text-align: center; font-size: 1.5rem; font-weight: 700; color: var(--color-finance);">
          $2,205
        </p>
        <p style="text-align: center; color: #64748b; font-size: 0.9rem;">
          Third Quartile (75%)
        </p>
      </div>

    </div>

    <div class="alert-box alert-success" style="margin-top: 20px;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="20 6 9 17 4 12"></polyline>
      </svg>
      <div>
        <strong>Interpretation:</strong><br>
        • <strong>25%</strong> of employees earned <mark class="highlight-green">less than $1,721</mark><br>
        • <strong>50%</strong> of employees earned <mark class="highlight-blue">less than $2,038</mark> (median)<br>
        • <strong>75%</strong> of employees earned <mark class="highlight-finance">less than $2,205</mark><br>
        • <strong>25%</strong> of employees earned more than $2,205
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 4 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      Practice Question 4: The Median
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        The median is used to measure:
      </p>
      
      <ul class="mcq-options">
        <li class="mcq-option" data-answer="correct">A) Central value ✓</li>
        <li class="mcq-option" data-answer="wrong">B) Dispersion</li>
        <li class="mcq-option" data-answer="wrong">C) Relationship between variables</li>
        <li class="mcq-option" data-answer="wrong">D) Frequency</li>
      </ul>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 Explanation:</h4>
        <div class="alert-box alert-info">
          <div>
            <strong>Correct Answer: A) Central value</strong><br><br>
            The median is a <strong>measure of location</strong> (Measures of Location) 
            or <strong>central tendency</strong> (Central Tendency), showing the <mark class="highlight-green">middle value</mark> 
            that divides the data into two equal halves.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== WHEN TO USE MEDIAN ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🤔 When to Use Median Instead of Mean?</h2>

    <div class="alert-box alert-warning">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
        <line x1="12" y1="9" x2="12" y2="13"></line>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      <div>
        <strong>Golden Rule:</strong><br>
        Use the <mark class="highlight-green">median</mark> when data contains 
        <strong>outliers</strong> or <strong>extreme values</strong>
      </div>
    </div>

    <h3>Illustrative Example:</h3>
    <p>Let's say we have salaries for 5 employees:</p>
    
    <div class="table-container">
      <table class="concepts-table">
        <thead>
          <tr><th>Employee</th><th>Salary</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>$3,000</td></tr>
          <tr><td>2</td><td>$3,200</td></tr>
          <tr><td>3</td><td>$3,500</td></tr>
          <tr><td>4</td><td>$3,800</td></tr>
          <tr><td>5 (Manager)</td><td>$50,000</td></tr>
        </tbody>
      </table>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
      
      <div class="formula-box" data-aos="fade-right">
        <h4 style="color: var(--color-primary); text-align: center;">Mean</h4>
        <p>$$\bar{X} = \frac{63,500}{5} = 12,700$$</p>
        <p style="text-align: center; color: #64748b;">
          Not representative!
        </p>
      </div>

      <div class="formula-box" data-aos="fade-left" style="background: linear-gradient(135deg, rgba(22,163,74,0.1), rgba(22,163,74,0.05));">
        <h4 style="color: var(--color-primary); text-align: center;">Median</h4>
        <p style="text-align: center; font-size: 1.4rem; font-weight: 700;">
          $3,500
        </p>
        <p style="text-align: center; color: #64748b;">
          Better representative!
        </p>
      </div>

    </div>
  </div>
  <!-- ==================== PRACTICE EXERCISE ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>💪 Comprehensive Practice Exercise</h2>
    
    <p>
      Practice simulation: If you have the following data for ages of <strong>9 employees</strong>:<br>
      <mark class="highlight-blue">22, 25, 27, 30, 32, 35, 40, 45, 50</mark>
    </p>

    <h3>Required:</h3>
    <ol>
      <li>Find the mean (Calculate the mean)</li>
      <li>Find the variance (Calculate the variance)</li>
      <li>Find the standard deviation (Calculate the standard deviation)</li>
      <li>Find the median (Find the median)</li>
      <li>Find the first quartile Q1 (Find Q1)</li>
      <li>Find the third quartile Q3 (Find Q3)</li>
    </ol>

    <button onclick="toggleSolution('practiceExerciseEn')" 
            style="background: linear-gradient(135deg, var(--color-primary), var(--color-business)); 
                   color: white; border: none; padding: 15px 40px; border-radius: 50px; 
                   font-size: 1.1rem; font-weight: 700; cursor: pointer; 
                   box-shadow: 0 8px 20px rgba(22,163,74,0.3); transition: all 0.3s ease;
                   margin: 20px auto; display: block;">
      <i class="fas fa-lightbulb"></i> Show Solution
    </button>

    <div id="practiceExerciseEn" style="display: none; margin-top: 30px;" data-aos="fade-up">
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="20 6 9 17 4 12"></polyline>
        </svg>
        <div>
          <h3 style="margin: 0 0 15px 0; color: var(--color-primary);">Complete Solution</h3>
          
          <h4>1. Mean:</h4>
          <div class="formula-box">
            <p>$$\bar{X} = \frac{22 + 25 + 27 + 30 + 32 + 35 + 40 + 45 + 50}{9}$$</p>
            <p>$$\bar{X} = \frac{306}{9} = 34$$</p>
          </div>

          <h4>2. Variance:</h4>
          <div class="table-container">
            <table class="concepts-table">
              <thead>
                <tr><th>X</th><th>\(X - \bar{X}\)</th><th>\((X - \bar{X})^2\)</th></tr>
              </thead>
              <tbody>
                <tr><td>22</td><td>-12</td><td>144</td></tr>
                <tr><td>25</td><td>-9</td><td>81</td></tr>
                <tr><td>27</td><td>-7</td><td>49</td></tr>
                <tr><td>30</td><td>-4</td><td>16</td></tr>
                <tr><td>32</td><td>-2</td><td>4</td></tr>
                <tr><td>35</td><td>1</td><td>1</td></tr>
                <tr><td>40</td><td>6</td><td>36</td></tr>
                <tr><td>45</td><td>11</td><td>121</td></tr>
                <tr><td>50</td><td>16</td><td>256</td></tr>
                <tr style="background: rgba(22,163,74,0.15);"><td colspan="2"><strong>Sum</strong></td><td><strong>708</strong></td></tr>
              </tbody>
            </table>
          </div>
          <div class="formula-box">
            <p>$$S^2 = \frac{708}{9 - 1} = \frac{708}{8} = 88.5$$</p>
          </div>

          <h4>3. Standard Deviation:</h4>
          <div class="formula-box">
            <p>$$S = \sqrt{88.5} = 9.41$$</p>
          </div>

          <h4>4. Median:</h4>
          <p>Data is already sorted, and the count is odd (9), so the median is the 5th value:</p>
          <div class="formula-box">
            <p style="font-size: 1.3rem; color: var(--color-business);">$$\text{Median} = 32$$</p>
          </div>

          <h4>5. First Quartile Q1:</h4>
          <p>Lower half: 22, 25, 27, 30 → Median between them:</p>
          <div class="formula-box">
            <p>$$Q1 = \frac{25 + 27}{2} = 26$$</p>
          </div>

          <h4>6. Third Quartile Q3:</h4>
          <p>Upper half: 35, 40, 45, 50 → Median between them:</p>
          <div class="formula-box">
            <p>$$Q3 = \frac{40 + 45}{2} = 42.5$$</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== MCQ QUESTION 5 ==================== -->
  <div class="question-container" onclick="toggleQuestion(this)" data-aos="fade-up">
    <div class="question-header">
      <svg class="question-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"></circle>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
        <line x1="12" y1="17" x2="12.01" y2="17"></line>
      </svg>
      Practice Question 5: Short Essay
      <svg class="arrow-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <polyline points="6 9 12 15 18 9"></polyline>
      </svg>
    </div>
    
    <div class="question-content">
      <p style="font-weight: 600; font-size: 1.05rem; margin-bottom: 15px;">
        Explain why the mean is an important measure for understanding data?
      </p>

      <div class="solution-content" style="display: none; margin-top: 20px;">
        <h4 style="color: var(--color-primary);">💡 Model Answer:</h4>
        <div class="alert-box alert-info">
          <div>
            The mean is important for several reasons:<br><br>
            
            <strong>1. Represents Central Value:</strong><br>
            It gives us <mark class="highlight-green">one single value</mark> that represents all the data, making it easy to understand and compare.<br><br>
            
            <strong>2. Easy to Calculate:</strong><br>
            The formula is simple and easy to apply: sum of values ÷ count.<br><br>
            
            <strong>3. Uses All Values:</strong><br>
            Unlike the median, the mean <mark class="highlight-blue">uses every value</mark> in the data.<br><br>
            
            <strong>4. Foundation for Other Measures:</strong><br>
            We need the mean to calculate <mark class="highlight-orange">variance and standard deviation</mark>.<br><br>
            
            <strong>5. Useful for Decision Making:</strong><br>
            It helps managers and analysts understand the <strong>general trend</strong> of data and make informed decisions.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ==================== COMPREHENSIVE CONCEPTS TABLE ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📚 Comprehensive Key Concepts Table</h2>
    
    <div class="table-container" data-aos="fade-up">
      <table class="concepts-table">
        <thead>
          <tr>
            <th>Concept</th>
            <th>Official Definition</th>
            <th>The Gist</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Sample Mean</strong></td>
            <td>Sum of all values ÷ Number of values</td>
            <td>Central Value</td>
          </tr>
          <tr>
            <td><strong>Variance</strong></td>
            <td>Arithmetic mean of squared deviations from the mean</td>
            <td>Measuring Spread</td>
          </tr>
          <tr>
            <td><strong>Standard Deviation</strong></td>
            <td>Square root of the variance</td>
            <td>Root of Variance</td>
          </tr>
          <tr>
            <td><strong>Median</strong></td>
            <td>Middle value in ordered data</td>
            <td>Middle Value</td>
          </tr>
          <tr>
            <td><strong>First Quartile (Q1)</strong></td>
            <td>Value below which 25% of data falls</td>
            <td>First Quarter</td>
          </tr>
          <tr>
            <td><strong>Third Quartile (Q3)</strong></td>
            <td>Value below which 75% of data falls</td>
            <td>Third Quarter</td>
          </tr>
          <tr>
            <td><strong>Measures of Location</strong></td>
            <td>Measures showing the central value of data</td>
            <td>Central Tendency</td>
          </tr>
          <tr>
            <td><strong>Measures of Variability</strong></td>
            <td>Measures showing the spread of data</td>
            <td>Measuring Dispersion</td>
          </tr>
          <tr>
            <td><strong>Range</strong></td>
            <td>Difference between max and min values</td>
            <td>Data Width</td>
          </tr>
          <tr>
            <td><strong>Degrees of Freedom</strong></td>
            <td>Number of free values in calculation = n - 1</td>
            <td>n - 1</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ==================== FORMULAS SUMMARY ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>📐 Key Formulas Summary</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
      
      <div class="formula-box" data-aos="zoom-in" data-aos-delay="100">
        <h4 style="color: var(--color-primary); text-align: center;">Sample Mean</h4>
        <p>$$\bar{X} = \frac{\sum x}{n}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="200">
        <h4 style="color: var(--color-finance); text-align: center;">Variance</h4>
        <p>$$S^2 = \frac{\sum (X - \bar{X})^2}{n - 1}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="300">
        <h4 style="color: var(--color-business); text-align: center;">Standard Deviation</h4>
        <p>$$S = \sqrt{\frac{\sum (X - \bar{X})^2}{n - 1}}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="400">
        <h4 style="color: var(--color-economics); text-align: center;">Range</h4>
        <p>$$R = X_{\max} - X_{\min}$$</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="500">
        <h4 style="color: var(--color-primary); text-align: center;">Interval ± 1 SD</h4>
        <p>$$\bar{x} \pm S$$</p>
        <p style="font-size: 0.9rem; color: #64748b;">~68-76% of data</p>
      </div>

      <div class="formula-box" data-aos="zoom-in" data-aos-delay="600">
        <h4 style="color: var(--color-business); text-align: center;">Interval ± 2 SD</h4>
        <p>$$\bar{x} \pm 2S$$</p>
        <p style="font-size: 0.9rem; color: #64748b;">~95% of data</p>
      </div>

    </div>
  </div>

  <!-- ==================== KEY TAKEAWAYS ==================== -->
  <div class="glassy-card" data-aos="fade-up">
    <h2>🎯 Key Takeaways</h2>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
      
      <div class="alert-box alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
          <polyline points="22 4 12 14.01 9 11.01"></polyline>
        </svg>
        <div>
          <strong>1. Measures of Location:</strong><br>
          • Mean: for normal data<br>
          • Median: for data with outliers<br>
          • Mode: for categorical data
        </div>
      </div>

      <div class="alert-box alert-info">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="16" x2="12" y2="12"></line>
          <line x1="12" y1="8" x2="12.01" y2="8"></line>
        </svg>
        <div>
          <strong>2. Measures of Dispersion:</strong><br>
          • Variance: in squared units<br>
          • Standard Deviation: same unit as data<br>
          • Range: easy but not precise
        </div>
      </div>

      <div class="alert-box alert-warning">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <div>
          <strong>3. General Rule:</strong><br>
          • ~76% within ±1 SD<br>
          • ~88-95% within ±2 SD<br>
          • ~99% within ±3 SD
        </div>
      </div>

    </div>
  </div>

  <!-- ==================== FOOTER ==================== -->
  <div class="footer-info" data-aos="fade-up">
    <div class="footer-brand">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
        <polyline points="2 17 12 22 22 17"></polyline>
        <polyline points="2 12 12 17 22 12"></polyline>
      </svg>
      Athr Educational Platform | منصة أثر التعليمية
    </div>
    <div class="footer-divider"></div>
    <div class="footer-disclaimer">
      This educational content is designed to help students understand <strong>numerical measures</strong> and <strong>dispersion measures</strong> interactively.<br>
      <strong style="color: var(--color-primary);">© 2025 Athr Platform - All Rights Reserved</strong>
    </div>
  </div>

</div>
<!-- ==================== END ENGLISH CONTENT: LECTURE 3 ==================== -->

      
  </main>
  <!-- Initialize Libraries -->
  <script>
    // ==================== LIBRARIES INITIALIZATION ====================
    document.addEventListener('DOMContentLoaded', function() {
      
      // Initialize AOS
      if (typeof AOS !== 'undefined') {
        AOS.init({
          duration: 800,
          easing: 'ease-in-out',
          once: true,
          offset: 50
        });
        console.log('✅ AOS initialized');
      }
      
      // Initialize Mermaid
      if (typeof mermaid !== 'undefined') {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
          flowchart: {
            useMaxWidth: true,
            htmlLabels: true
          }
        });
        console.log('✅ Mermaid initialized');
      }
      
      // Configure Marked.js
      if (typeof marked !== 'undefined') {
        marked.setOptions({
          breaks: true,
          gfm: true,
          sanitize: false
        });
        console.log('✅ Marked.js configured');
      }
      
      // Configure Moment.js for Arabic
      if (typeof moment !== 'undefined') {
        moment.locale('ar');
        console.log('✅ Moment.js configured');
      }
      
      // Configure Chart.js defaults for mobile
      if (typeof Chart !== 'undefined') {
        Chart.defaults.responsive = true;
        Chart.defaults.maintainAspectRatio = false;
        Chart.defaults.devicePixelRatio = window.devicePixelRatio || 2;
        console.log('✅ Chart.js configured for mobile');
      }
      
      // Force MathJax to render
      function waitForMathJax() {
        if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
          console.log('🎯 Rendering math expressions...');
          MathJax.typesetPromise().then(() => {
            console.log('✅ All math rendered successfully!');
          }).catch((err) => {
            console.error('❌ MathJax rendering error:', err);
          });
        } else {
          setTimeout(waitForMathJax, 100);
        }
      }
      
      setTimeout(waitForMathJax, 500);
      
      // Re-render math when language changes
      const translationButton = document.getElementById('translationButton');
      if (translationButton) {
        translationButton.addEventListener('click', function() {
          setTimeout(function() {
            if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
              MathJax.typesetPromise();
            }
          }, 300);
        });
      }

      // Initialize Hammer.js for gestures
      if (typeof Hammer !== 'undefined') {
        const mainContent = document.querySelector('.main-content');
        if (mainContent) {
          const hammer = new Hammer(mainContent);
          hammer.on('swipeleft swiperight', function(ev) {
            console.log('Gesture detected:', ev.type);
          });
          console.log('✅ Hammer.js gestures enabled');
        }
      }
    });
  </script>

  <script>
    // ==================== MAIN APPLICATION SCRIPT ====================
    document.addEventListener('DOMContentLoaded', function() {
      const translationButton = document.getElementById('translationButton');
      const translationText = document.querySelector('.translation-text');
      const html = document.documentElement;
      const body = document.body;
      
      const aiChatButton = document.getElementById('aiChatButton');
      const aiChatModal = document.getElementById('aiChatModal');
      const aiChatCloseBtn = document.getElementById('aiChatCloseBtn');
      const aiChatMessages = document.getElementById('aiChatMessages');
      const aiChatInput = document.getElementById('ai-chat-input');
      const aiChatSendBtn = document.getElementById('ai-chat-send-btn');
      const aiChatTitle = document.getElementById('ai-chat-title');
      const aiChatButtonText = document.getElementById('aiFabText');
      
      let isArabic = true;
      let isFirstMessage = true;
      let conversationHistory = [];

      // ==================== TYPING INDICATOR ====================
      function showTypingIndicator(show) {
        const existingIndicator = aiChatMessages.querySelector('.typing-indicator');
        if (existingIndicator) existingIndicator.remove();
        
        if (show) {
          const indicatorElement = document.createElement('div');
          indicatorElement.classList.add('chat-message', 'ai-message', 'typing-indicator');
          indicatorElement.innerHTML = '<span>أثر AI يكتب الآن</span><span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>';
          aiChatMessages.appendChild(indicatorElement);
          aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
        }
      }

      // ==================== ADD MESSAGE ====================
      function addMessage(text, sender) {
        const messageElement = document.createElement('div');
        messageElement.classList.add('chat-message', `${sender}-message`);
        messageElement.innerHTML = marked.parse(text);
        aiChatMessages.appendChild(messageElement);
        aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
      }
      
      // ==================== APPLY LANGUAGE ====================
     // ==================== APPLY LANGUAGE ====================
function applyLanguage(arabic) {
  isArabic = arabic;
  const lang = isArabic ? 'ar' : 'en';
  const dir = isArabic ? 'rtl' : 'ltr';
  
  html.setAttribute('lang', lang);
  html.setAttribute('dir', dir);
  body.setAttribute('dir', dir);
  
  // إخفاء/إظهار المحتوى حسب اللغة
  document.querySelectorAll('.ar-content').forEach(el => {
    el.style.display = arabic ? 'block' : 'none';
  });
  document.querySelectorAll('.en-content').forEach(el => {
    el.style.display = arabic ? 'none' : 'block';
  });
  
  translationText.textContent = isArabic ? 'English' : 'العربية';
  document.title = isArabic ? 'منصة أثر - التمهيد الأسي وطرق التنبؤ' : 'Athr Platform - Exponential Smoothing & Forecasting';
  
  aiChatTitle.textContent = isArabic ? 'اسأل أثر AI' : 'Ask Athr AI';
  aiChatInput.placeholder = isArabic ? 'اكتب سؤالك هنا...' : 'Type your question here...';
  aiChatButtonText.textContent = isArabic ? 'أثر AI' : 'Athr AI';
  
  // Update moment.js locale
  if (typeof moment !== 'undefined') {
    moment.locale(isArabic ? 'ar' : 'en');
  }
  
  // Re-render MathJax after language switch
  setTimeout(function() {
    if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
      MathJax.typesetPromise().catch((err) => console.error('MathJax error:', err));
    }
  }, 300);
}

      // ==================== TRANSLATION BUTTON ====================
      translationButton.addEventListener('click', function() {
        applyLanguage(!isArabic);
        
        // Re-render MathJax after language switch
        setTimeout(function() {
          if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
            MathJax.typesetPromise().catch((err) => console.error('MathJax error:', err));
          }
        }, 300);
      });

      // ==================== AI CHAT BUTTON ====================
      aiChatButton.addEventListener('click', function() {
        aiChatModal.classList.add('visible');
        
        if (isFirstMessage) {
          const welcomeMsg = isArabic 
            ? "مرحباً! أنا **أثر AI**، مساعدك الأكاديمي المتخصص في **التنبؤ والتمهيد الأسي**. يمكنني مساعدتك في:\n\n- **شرح المعادلات والمفاهيم**\n- **حل المسائل خطوة بخطوة**\n- **توضيح الفرق بين الطرق المختلفة**\n- **الإجابة على أي سؤال عن المحتوى**\n\nاسألني أي شيء!"
            : "Hello! I'm **Athr AI**, your academic assistant specialized in **Forecasting & Exponential Smoothing**. I can help you with:\n\n- **Explaining equations and concepts**\n- **Solving problems step-by-step**\n- **Clarifying differences between methods**\n- **Answering any content questions**\n\nAsk me anything!";
          addMessage(welcomeMsg, 'ai');
          isFirstMessage = false;
        }
        
        aiChatInput.focus();
      });

      aiChatCloseBtn.addEventListener('click', function() {
        aiChatModal.classList.remove('visible');
      });

      aiChatModal.addEventListener('click', function(e) {
        if (e.target === aiChatModal) {
          aiChatModal.classList.remove('visible');
        }
      });

      // ==================== SEND MESSAGE ====================
      async function sendMessage() {
        const userMessage = aiChatInput.value.trim();
        if (!userMessage) return;

        addMessage(userMessage, 'user');
        conversationHistory.push({ role: 'user', content: userMessage });
        
        aiChatInput.value = '';
        aiChatInput.disabled = true;
        aiChatSendBtn.disabled = true;
        
        showTypingIndicator(true);

        try {
          const lectureContext = document.querySelector('.main-content').innerText || '';
          
          // Simulate AI response (replace with actual API call)
          await new Promise(resolve => setTimeout(resolve, 1500));
          
          showTypingIndicator(false);
          
          const aiResponse = isArabic
            ? "شكراً لسؤالك! بناءً على المحتوى، **التمهيد الأسي** هو طريقة تنبؤ تستخدم معادلة: \\[ F_t = F_{t-1} + \\alpha [(A_{t-1}) - (F_{t-1})] \\]\n\nحيث α (ثابت التمهيد) يتحكم في **درجة الاستجابة** للأخطاء. هل تريد مثال عملي؟"
            : "Thanks for your question! Based on the content, **Exponential Smoothing** is a forecasting method using: \\[ F_t = F_{t-1} + \\alpha [(A_{t-1}) - (F_{t-1})] \\]\n\nWhere α (smoothing constant) controls the **response degree** to errors. Would you like a practical example?";
          
          addMessage(aiResponse, 'ai');
          conversationHistory.push({ role: 'assistant', content: aiResponse });
          
          // Re-render math in chat
          setTimeout(() => {
            if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
              MathJax.typesetPromise();
            }
          }, 100);

        } catch (error) {
          console.error('Error:', error);
          showTypingIndicator(false);
          
          const errorMsg = isArabic
            ? "عذراً، حدث خطأ في الاتصال. يرجى المحاولة مرة أخرى."
            : "Sorry, a connection error occurred. Please try again.";
          addMessage(errorMsg, 'ai');
        } finally {
          aiChatInput.disabled = false;
          aiChatSendBtn.disabled = false;
          aiChatInput.focus();
        }
      }

      aiChatSendBtn.addEventListener('click', sendMessage);
      aiChatInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          sendMessage();
        }
      });

      // ==================== QUESTION TOGGLE ====================
      window.toggleQuestion = function(element) {
        const content = element.querySelector('.question-content');
        element.classList.toggle('open');
        content.classList.toggle('show');
        
        if (content.classList.contains('show')) {
          setTimeout(() => {
            content.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 300);
        }
      };

      // ==================== MCQ SELECTION WITH CONFETTI ====================
      const mcqOptions = document.querySelectorAll('.mcq-option');
      mcqOptions.forEach(option => {
        option.addEventListener('click', function() {
          const isCorrect = this.getAttribute('data-answer') === 'correct';
          const allOptions = this.parentNode.querySelectorAll('.mcq-option');
          
          // Disable all options
          allOptions.forEach(opt => {
            opt.style.pointerEvents = 'none';
          });
          
          this.classList.add('selected');
          
          setTimeout(() => {
            if (isCorrect) {
              this.classList.add('correct');
              this.innerHTML += ' ✓';
              
              // Trigger confetti celebration
              if (typeof confetti !== 'undefined') {
                confetti({
                  particleCount: 100,
                  spread: 70,
                  origin: { y: 0.6 }
                });
              }
              
              // Show solution
              const solutionContent = this.closest('.question-content').querySelector('.solution-content');
              if (solutionContent) {
                setTimeout(() => {
                  solutionContent.style.display = 'block';
                  if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                    MathJax.typesetPromise();
                  }
                }, 1000);
              }
            } else {
              this.classList.add('incorrect');
              this.innerHTML += ' ✗';
              
              // Show correct answer
              allOptions.forEach(opt => {
                if (opt.getAttribute('data-answer') === 'correct') {
                  opt.classList.add('correct');
                  opt.innerHTML += ' ✓ (الإجابة الصحيحة)';
                }
              });
              
              // Show solution after incorrect answer
              const solutionContent = this.closest('.question-content').querySelector('.solution-content');
              if (solutionContent) {
                setTimeout(() => {
                  solutionContent.style.display = 'block';
                  if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                    MathJax.typesetPromise();
                  }
                }, 1500);
              }
            }
          }, 500);
        });
      });
      
      // ==================== EXPONENTIAL SMOOTHING CALCULATOR ====================
      window.calculateExponentialSmoothing = function() {
        const prevForecast = parseFloat(document.getElementById('prevForecast').value);
        const actualDemand = parseFloat(document.getElementById('actualDemand').value);
        const alpha = parseFloat(document.getElementById('alphaValue').value);
        
        if (isNaN(prevForecast) || isNaN(actualDemand) || isNaN(alpha)) {
          alert(isArabic ? 'الرجاء إدخال قيم صحيحة!' : 'Please enter valid values!');
          return;
        }
        
        if (alpha < 0 || alpha > 1) {
          alert(isArabic ? 'قيمة α يجب أن تكون بين 0 و 1!' : 'α value must be between 0 and 1!');
          return;
        }
        
        const error = actualDemand - prevForecast;
        const adjustment = alpha * error;
        const newForecast = prevForecast + adjustment;
        
        const resultDiv = document.getElementById('calculatorResult');
        const resultValue = document.getElementById('resultValue');
        const resultSteps = document.getElementById('resultSteps');
        
        resultValue.innerHTML = `${newForecast.toFixed(2)} وحدة`;
        
        resultSteps.innerHTML = `
          <strong>خطوات الحل:</strong><br>
          1️⃣ خطأ التنبؤ = ${actualDemand} - ${prevForecast} = <strong>${error.toFixed(2)}</strong><br>
          2️⃣ التعديل = ${alpha} × ${error.toFixed(2)} = <strong>${adjustment.toFixed(2)}</strong><br>
          3️⃣ التنبؤ الجديد = ${prevForecast} + ${adjustment.toFixed(2)} = <strong>${newForecast.toFixed(2)}</strong>
        `;
        
        resultDiv.style.display = 'block';
        resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        
        // Trigger celebration for calculation
        if (typeof confetti !== 'undefined') {
          confetti({
            particleCount: 50,
            angle: 60,
            spread: 55,
            origin: { x: 0, y: 0.8 }
          });
          confetti({
            particleCount: 50,
            angle: 120,
            spread: 55,
            origin: { x: 1, y: 0.8 }
          });
        }
      };
      
      // ==================== UTILITY FUNCTIONS ====================
      
      // Format Currency
      window.formatCurrency = function(amount, currency = 'EGP') {
        return new Intl.NumberFormat(isArabic ? 'ar-EG' : 'en-US', {
          style: 'currency',
          currency: currency
        }).format(amount);
      };
      
      // Format Number
      window.formatNumber = function(number, decimals = 2) {
        return new Intl.NumberFormat(isArabic ? 'ar-EG' : 'en-US', {
          minimumFractionDigits: decimals,
          maximumFractionDigits: decimals
        }).format(number);
      };
      
      // Format Percentage
      window.formatPercentage = function(value) {
        return new Intl.NumberFormat(isArabic ? 'ar-EG' : 'en-US', {
          style: 'percent',
          minimumFractionDigits: 2
        }).format(value);
      };
      
      // ==================== CHARTS INITIALIZATION ====================
      
      // CHART: Example 7 Comparison
      setTimeout(function() {
        const example7Canvas = document.getElementById('example7Chart');
        if (example7Canvas && typeof Chart !== 'undefined') {
          new Chart(example7Canvas, {
            type: 'bar',
            data: {
              labels: ['α = 0.4', 'α = 0.6'],
              datasets: [
                {
                  label: 'التنبؤ السابق',
                  data: [65, 65],
                  backgroundColor: 'rgba(100, 116, 139, 0.7)',
                  borderColor: '#64748b',
                  borderWidth: 2
                },
                {
                  label: 'الطلب الفعلي',
                  data: [76, 76],
                  backgroundColor: 'rgba(34, 197, 94, 0.7)',
                  borderColor: '#22c55e',
                  borderWidth: 2
                },
                {
                  label: 'التنبؤ الجديد',
                  data: [69, 72],
                  backgroundColor: 'rgba(245, 158, 11, 0.7)',
                  borderColor: '#f59e0b',
                  borderWidth: 2
                }
              ]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                title: {
                  display: true,
                  text: 'مقارنة التنبؤ بقيم α مختلفة',
                  font: { size: 16, weight: 'bold' }
                },
                legend: {
                  display: true,
                  position: 'top',
                  labels: {
                    font: { size: window.innerWidth <= 768 ? 10 : 12 },
                    padding: 10
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  title: {
                    display: true,
                    text: 'القيمة (وحدة)',
                    font: { size: 13, weight: 'bold' }
                  },
                  ticks: {
                    font: { size: window.innerWidth <= 768 ? 9 : 11 }
                  }
                },
                x: {
                  ticks: {
                    font: { size: window.innerWidth <= 768 ? 9 : 11 }
                  }
                }
              }
            }
          });
          console.log('✅ Example 7 chart created');
        }
      }, 1500);

      // ==================== INTERACTIVE TABLE ENHANCEMENTS ====================
      
      // Add hover effects to tables
      const tables = document.querySelectorAll('.concepts-table');
      tables.forEach(table => {
        const rows = table.querySelectorAll('tbody tr');
        rows.forEach(row => {
          row.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.02)';
            this.style.transition = 'all 0.3s ease';
          });
          row.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
          });
        });
      });

      // ==================== SCROLL PROGRESS TRACKER ====================
      
      const createScrollProgress = () => {
        const progressBar = document.createElement('div');
        progressBar.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 0%;
          height: 4px;
          background: linear-gradient(90deg, var(--color-primary), var(--color-primary-medium));
          z-index: 10000;
          transition: width 0.1s ease;
        `;
        document.body.appendChild(progressBar);
        
        window.addEventListener('scroll', () => {
          const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
          const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
          const scrolled = (winScroll / height) * 100;
          progressBar.style.width = scrolled + '%';
        });
      };
      
      createScrollProgress();

      console.log('✅ منصة أثر - جاهزة بالكامل!');
      console.log('📚 جميع المكتبات محملة بنجاح');
      console.log('📱 تم تفعيل التحسينات للموبايل');
      console.log('🎬 الفيديو بلاير جاهز للاستخدام');
    });
  </script>

  <!-- ==================== VIDEO PLAYER SCRIPT ==================== -->
  <script>
    (function() {
      'use strict';

      // Multiple video sources as fallback
      const VIDEO_SOURCES = [
        'https://archive.org/download/20251005_20251005_1020/%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D8%B9%D9%85%D8%A7%D9%84__%D9%85%D9%82%D8%AF%D9%85%D8%A9_%D9%84%D9%84%D9%85%D8%AD%D8%A7%D8%B3%D8%A8%D8%A9.mp4',
        'https://archive.org/download/20251005_20251005_1020/%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D8%B9%D9%85%D8%A7%D9%84__%D9%85%D9%82%D8%AF%D9%85%D8%A9_%D9%84%D9%84%D9%85%D8%AD%D8%A7%D8%B3%D8%A8%D8%A9.mp4'
      ];

      const videoPlayer = document.getElementById('videoPlayer');
      const video = document.getElementById('video');
      const videoBars = document.getElementById('videoBars');
      
      const simplePlayBtn = document.getElementById('simplePlayBtn');
      const simpleFullscreenBtn = document.getElementById('simpleFullscreenBtn');
      const simpleProgress = document.getElementById('simpleProgress');
      const simpleProgressFilled = document.getElementById('simpleProgressFilled');
      const simpleCurrentTime = document.getElementById('simpleCurrentTime');
      const simpleDuration = document.getElementById('simpleDuration');
      
      const playBtn = document.getElementById('playBtn');
      const skipBack = document.getElementById('skipBack');
      const skipForward = document.getElementById('skipForward');
      const progressWrapper = document.getElementById('progressWrapper');
      const progressFilled = document.getElementById('progressFilled');
      const progressBuffered = document.getElementById('progressBuffered');
      const currentTimeEl = document.getElementById('currentTime');
      const remainingTimeEl = document.getElementById('remainingTime');
      const volumeBtn = document.getElementById('volumeBtn');
      const volumeSlider = document.getElementById('volumeSlider');
      const closeBtn = document.getElementById('closeBtn');
      const pipBtn = document.getElementById('pipBtn');
      const loadingSpinner = document.getElementById('loadingSpinner');
      const tapLeft = document.getElementById('tapLeft');
      const tapRight = document.getElementById('tapRight');

      let controlsTimeout;
      let isDragging = false;
      let tapTimeout, tapCount = 0, lastTapX = 0;
      let isFullscreen = false;
      let currentSourceIndex = 0;

      function init() {
        loadVideo();
        setupEventListeners();
        if (document.pictureInPictureEnabled) pipBtn.style.display = 'flex';
      }

      function loadVideo() {
        video.src = VIDEO_SOURCES[currentSourceIndex];
        video.load();
      }

      function updateVolumeSliderBg() {
        const percent = video.volume * 100;
        volumeSlider.style.background = `linear-gradient(to right, #fff ${percent}%, rgba(255, 255, 255, 0.3) ${percent}%)`;
      }

      function toggleFullscreen() {
        if (!isFullscreen) {
          videoPlayer.classList.add('fullscreen-mode');
          if (videoPlayer.requestFullscreen) {
            videoPlayer.requestFullscreen();
          } else if (videoPlayer.webkitRequestFullscreen) {
            videoPlayer.webkitRequestFullscreen();
          }
          isFullscreen = true;
          showControls();
          setTimeout(() => videoBars.classList.add('hidden'), 5000);
        } else {
          exitFullscreen();
        }
      }

      function exitFullscreen() {
        videoPlayer.classList.remove('fullscreen-mode');
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        }
        isFullscreen = false;
        videoBars.classList.remove('hidden');
      }

      function showControls() {
        if (!isFullscreen) return;
        videoPlayer.classList.add('show-controls');
        clearTimeout(controlsTimeout);
        controlsTimeout = setTimeout(() => {
          if (!video.paused && !isDragging) videoPlayer.classList.remove('show-controls');
        }, 3000);
      }

      function togglePlay() {
        if (video.paused) {
          video.play().catch(err => {
            console.log('Play failed:', err);
            if (currentSourceIndex < VIDEO_SOURCES.length - 1) {
              currentSourceIndex++;
              loadVideo();
              video.play().catch(e => console.log('All sources failed'));
            }
          });
        } else {
          video.pause();
        }
      }

      function skipBackward() {
        video.currentTime = Math.max(0, video.currentTime - 10);
        showTapIndicator('left');
      }

      function skipForwardFunc() {
        video.currentTime = Math.min(video.duration, video.currentTime + 10);
        showTapIndicator('right');
      }

      function showTapIndicator(side) {
        const indicator = side === 'left' ? tapLeft : tapRight;
        indicator.classList.add('active');
        setTimeout(() => indicator.classList.remove('active'), 500);
      }

      function formatTime(seconds) {
        if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
        const hrs = Math.floor(seconds / 3600);
        const mins = Math.floor((seconds % 3600) / 60);
        const secs = Math.floor(seconds % 60);
        return hrs > 0 ? `${hrs}:${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}` : `${mins}:${secs.toString().padStart(2,'0')}`;
      }

      function updateProgress() {
        if (!isDragging) {
          const progress = (video.currentTime / video.duration) * 100;
          simpleProgressFilled.style.width = `${progress}%`;
          progressFilled.style.width = `${progress}%`;
          const timeStr = formatTime(video.currentTime);
          simpleCurrentTime.textContent = timeStr;
          currentTimeEl.textContent = timeStr;
          remainingTimeEl.textContent = '-' + formatTime(video.duration - video.currentTime);
        }
      }

      function handleSeek(e, el) {
        const rect = el.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        const percent = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
        const time = percent * video.duration;
        if (!isNaN(time)) {
          video.currentTime = time;
          const progress = percent * 100;
          simpleProgressFilled.style.width = `${progress}%`;
          progressFilled.style.width = `${progress}%`;
        }
      }

      function updateVolumeIcon() {
        const vol = video.volume;
        const icon = video.muted || vol === 0 ? 'fa-volume-xmark' : vol < 0.5 ? 'fa-volume-low' : 'fa-volume-up';
        volumeBtn.innerHTML = `<i class="fas ${icon}"></i>`;
      }

      function setupEventListeners() {
        video.addEventListener('loadstart', () => loadingSpinner.classList.add('active'));
        video.addEventListener('canplay', () => loadingSpinner.classList.remove('active'));
        
        video.addEventListener('error', (e) => {
          console.log('Video error:', e);
          loadingSpinner.classList.remove('active');
          if (currentSourceIndex < VIDEO_SOURCES.length - 1) {
            currentSourceIndex++;
            console.log('Trying next source:', VIDEO_SOURCES[currentSourceIndex]);
            loadVideo();
          }
        });

        video.addEventListener('loadedmetadata', () => {
          simpleDuration.textContent = formatTime(video.duration);
          remainingTimeEl.textContent = '-' + formatTime(video.duration);
          if (isFullscreen) showControls();
        });

        video.addEventListener('play', () => {
          videoPlayer.classList.remove('paused');
          simplePlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
          playBtn.innerHTML = '<i class="fas fa-pause"></i>';
        });

        video.addEventListener('pause', () => {
          videoPlayer.classList.add('paused');
          simplePlayBtn.innerHTML = '<i class="fas fa-play"></i>';
          playBtn.innerHTML = '<i class="fas fa-play"></i>';
          showControls();
        });

        video.addEventListener('timeupdate', updateProgress);
        video.addEventListener('progress', () => {
          if (video.buffered.length > 0) {
            progressBuffered.style.width = `${(video.buffered.end(0) / video.duration) * 100}%`;
          }
        });

        simplePlayBtn.addEventListener('click', togglePlay);
        simpleFullscreenBtn.addEventListener('click', toggleFullscreen);
        simpleProgress.addEventListener('click', (e) => handleSeek(e, simpleProgress));

        playBtn.addEventListener('click', togglePlay);
        skipBack.addEventListener('click', skipBackward);
        skipForward.addEventListener('click', skipForwardFunc);
        closeBtn.addEventListener('click', exitFullscreen);
        
        volumeBtn.addEventListener('click', () => {
          video.muted = !video.muted;
          updateVolumeIcon();
        });

        volumeSlider.addEventListener('input', () => {
          video.volume = volumeSlider.value;
          video.muted = false;
          updateVolumeIcon();
          updateVolumeSliderBg();
        });

        progressWrapper.addEventListener('mousedown', (e) => {
          isDragging = true;
          videoPlayer.classList.add('dragging');
          handleSeek(e, progressWrapper);
        });

        progressWrapper.addEventListener('touchstart', (e) => {
          isDragging = true;
          videoPlayer.classList.add('dragging');
          handleSeek(e, progressWrapper);
        }, { passive: true });

        document.addEventListener('mousemove', (e) => {
          if (isDragging) handleSeek(e, progressWrapper);
        });

        document.addEventListener('touchmove', (e) => {
          if (isDragging) handleSeek(e, progressWrapper);
        }, { passive: true });

        document.addEventListener('mouseup', () => {
          if (isDragging) {
            isDragging = false;
            videoPlayer.classList.remove('dragging');
          }
        });

        document.addEventListener('touchend', () => {
          if (isDragging) {
            isDragging = false;
            videoPlayer.classList.remove('dragging');
          }
        });

        progressWrapper.addEventListener('click', (e) => handleSeek(e, progressWrapper));

        video.addEventListener('click', (e) => {
          if (!isFullscreen) {
            togglePlay();
            return;
          }

          tapCount++;
          lastTapX = e.clientX || (e.touches && e.touches[0].clientX);
          clearTimeout(tapTimeout);

          if (tapCount === 1) {
            tapTimeout = setTimeout(() => {
              togglePlay();
              tapCount = 0;
            }, 300);
          } else if (tapCount === 2) {
            const rect = video.getBoundingClientRect();
            (lastTapX - rect.left > rect.width / 2 ? skipForwardFunc : skipBackward)();
            tapCount = 0;
          }
        });

        videoPlayer.addEventListener('mousemove', showControls);
        videoPlayer.addEventListener('touchstart', showControls);

        if (pipBtn) {
          pipBtn.addEventListener('click', async () => {
            try {
              document.pictureInPictureElement ? await document.exitPictureInPicture() : await video.requestPictureInPicture();
            } catch {}
          });
        }

        document.addEventListener('fullscreenchange', () => {
          if (!document.fullscreenElement) exitFullscreen();
        });

        document.addEventListener('keydown', (e) => {
          if (e.target.tagName === 'INPUT') return;
          switch(e.key) {
            case ' ':
            case 'k':
              e.preventDefault();
              togglePlay();
              break;
            case 'ArrowLeft':
              e.preventDefault();
              skipBackward();
              break;
            case 'ArrowRight':
              e.preventDefault();
              skipForwardFunc();
              break;
            case 'm':
              e.preventDefault();
              video.muted = !video.muted;
              updateVolumeIcon();
              break;
            case 'f':
              e.preventDefault();
              toggleFullscreen();
              break;
          }
        });

        updateVolumeSliderBg();
      }

      init();
    })();
  </script>
</body>
</html>

