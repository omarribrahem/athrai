<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="description" content="منصة أثر التعليمية - محتوى متخصص لكلية التجارة مع فيديو تفاعلي" />
  <meta name="keywords" content="اقتصاد، محاسبة، إدارة، تجارة، تنبؤ، business, economics, accounting, finance, forecasting" />
 
  
  <!-- ==================== FONTS ==================== -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&family=IBM+Plex+Sans+Arabic:wght@400;500;600;700&family=Inter:wght@400;500;600;700;800&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- ==================== MATH RENDERING ==================== -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        packages: {'[+]': ['ams', 'newcommand', 'mathtools', 'boldsymbol']},
        macros: {
          RR: "{\\mathbb{R}}",
          ZZ: "{\\mathbb{Z}}",
          NN: "{\\mathbb{N}}",
          bold: ["{\\bf #1}", 1],
          Delta: "{\\varDelta}",
          Sigma: "{\\varSigma}"
        }
      },
      svg: { fontCache: 'global', scale: 1.1 },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
        ignoreHtmlClass: 'tex2jax_ignore',
        processHtmlClass: 'tex2jax_process'
      },
      startup: {
        pageReady: () => {
          console.log('✅ MathJax is ready!');
          return MathJax.startup.defaultPageReady();
        }
      }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" id="MathJax-script" async></script>
  
  <!-- KaTeX (Alternative - Faster) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
  
  <!-- ==================== BUSINESS/FINANCE LIBRARIES ==================== -->
  
  <!-- Formula.js - Excel Financial Functions -->
  <script src="https://cdn.jsdelivr.net/npm/@formulajs/formulajs/dist/formula.min.js"></script>
  
  <!-- Finance.js - Financial Calculations -->
  <script src="https://cdn.jsdelivr.net/npm/financejs@4.1.0/finance.min.js"></script>
  
  <!-- Accounting.js - Currency & Number Formatting -->
  <script src="https://cdn.jsdelivr.net/npm/accounting@0.4.1/accounting.min.js"></script>
  
  <!-- Numeral.js - Number Formatting -->
  <script src="https://cdn.jsdelivr.net/npm/numeral@2.0.6/numeral.min.js"></script>
  
  <!-- Math.js - Advanced Math Operations -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  
  <!-- Decimal.js - Precise Decimal Arithmetic -->
  <script src="https://cdn.jsdelivr.net/npm/decimal.js@10.4.3/decimal.min.js"></script>
  
  <!-- Big.js - Arbitrary Precision -->
  <script src="https://cdn.jsdelivr.net/npm/big.js@6.2.1/big.min.js"></script>
  
  <!-- ==================== STATISTICS & DATA ANALYSIS ==================== -->
  
  <!-- jStat - Statistical Functions -->
  <script src="https://cdn.jsdelivr.net/npm/jstat@latest/dist/jstat.min.js"></script>
  
  <!-- Simple Statistics -->
  <script src="https://unpkg.com/simple-statistics@7.8.3/dist/simple-statistics.min.js"></script>
  
  <!-- Regression.js - Regression Analysis -->
  <script src="https://cdn.jsdelivr.net/npm/regression@2.0.1/dist/regression.min.js"></script>
  
  <!-- Danfo.js - Pandas for JavaScript -->
  <script src="https://cdn.jsdelivr.net/npm/danfojs@1.1.2/lib/bundle.min.js"></script>
  
  <!-- PapaParse - CSV Parser -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  
  <!-- SheetJS - Excel Files -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  
  <!-- ==================== ADVANCED MATH ==================== -->
  
  <!-- Algebrite - Symbolic Math -->
  <script src="https://algebrite.org/algebrite.bundle-for-browser.js"></script>
  
  <!-- Nerdamer - Computer Algebra System -->
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/nerdamer.core.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Algebra.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Calculus.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nerdamer@1.1.13/Solve.js"></script>
  
  <!-- GeoGebra - Interactive Math -->
  <script src="https://www.geogebra.org/apps/deployggb.js"></script>
  
  <!-- Desmos Calculator API -->
  <script src="https://www.desmos.com/api/v1.8/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
  
  <!-- JSXGraph - Dynamic Geometry -->
  <script src="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraphcore.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsxgraph/distrib/jsxgraph.css">
  
  <!-- Function Plot - Mathematical Functions -->
  <script src="https://unpkg.com/function-plot/dist/function-plot.js"></script>
  
  <!-- ==================== CHARTS & GRAPHS (MOBILE OPTIMIZED) ==================== -->
  
  <!-- Chart.js - Simple Charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <!-- Echarts - Professional Charts -->
  <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
  
  <!-- ApexCharts - Modern Charts -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  
  <!-- Plotly - Interactive Scientific Charts -->
  <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
  
  <!-- D3.js - Custom Data Visualizations -->
  <script src="https://d3js.org/d3.v7.min.js"></script>
  
  <!-- Highcharts - Professional Business Charts -->
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>
  <script src="https://code.highcharts.com/modules/export-data.js"></script>
  
  <!-- TradingView Charting Library (Financial Charts) -->
  <script src="https://s3.tradingview.com/tv.js"></script>
  
  <!-- C3.js - D3-based Charts -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.7.20/c3.min.js"></script>

  <!-- ==================== TABLES & DATA GRIDS ==================== -->
  
  <!-- jQuery (Required for DataTables) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  
  <!-- DataTables - Interactive Tables -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
  <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
  <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
  
  <!-- Tabulator - Modern Tables -->
  <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
  <script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  
  <!-- AG Grid - Enterprise-grade Tables -->
  <script src="https://cdn.jsdelivr.net/npm/ag-grid-community/dist/ag-grid-community.min.js"></script>
  
  <!-- Handsontable - Spreadsheet-like -->
  <link href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
  
  <!-- ==================== DIAGRAMS & FLOWCHARTS ==================== -->
  
  <!-- Mermaid - Diagrams & Flowcharts -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
  
  <!-- Vis.js - Network Diagrams -->
  <script src="https://unpkg.com/vis-network@9.1.6/dist/vis-network.min.js"></script>
  <link href="https://unpkg.com/vis-network@9.1.6/dist/dist/vis-network.min.css" rel="stylesheet">
  
  <!-- Cytoscape.js - Graph Theory & Networks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.26.0/cytoscape.min.js"></script>
  
  <!-- GoJS - Interactive Diagrams -->
  <script src="https://unpkg.com/gojs@3.0.0/release/go.js"></script>
  
  <!-- ==================== ANIMATIONS ==================== -->
  
  <!-- Anime.js -->
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/ScrollTrigger.min.js"></script>
  
  <!-- AOS - Animate On Scroll -->
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  
  <!-- ==================== CODE HIGHLIGHTING ==================== -->
  
  <!-- Prism.js -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
  
  <!-- ==================== PDF & PRINTING ==================== -->
  
  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  
  <!-- html2pdf.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  
  <!-- Print.js -->
  <script src="https://printjs-4de6.kxcdn.com/print.min.js"></script>
  <link rel="stylesheet" href="https://printjs-4de6.kxcdn.com/print.min.css">
  
  <!-- ==================== MARKDOWN & TEXT ==================== -->
  
  <!-- Marked.js -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  
  <!-- DOMPurify -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
  
  <!-- Markdown-it -->
  <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.2/dist/markdown-it.min.js"></script>
  
  <!-- ==================== UI COMPONENTS ==================== -->
  
  <!-- SweetAlert2 - Beautiful Alerts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  
  <!-- Toastify - Notifications -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  
  <!-- Tippy.js - Tooltips -->
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  
  <!-- NProgress - Progress Bar -->
  <script src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/nprogress@0.2.0/nprogress.css">
  
  <!-- Progressbar.js -->
  <script src="https://cdn.rawgit.com/kimmobrunfeldt/progressbar.js/1.0.0/dist/progressbar.min.js"></script>
  
  <!-- ==================== CALENDAR & TIME ==================== -->
  
  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js"></script>
  
  <!-- Flatpickr - Date Picker -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  
  <!-- Moment.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment-with-locales.min.js"></script>
  
  <!-- ==================== ICONS ==================== -->
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <!-- ==================== UTILITIES ==================== -->
  
  <!-- Lodash -->
  <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>
  
  <!-- Fuse.js - Fuzzy Search -->
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@7.0.0"></script>
  
  <!-- List.js - Search & Sort -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
  
  <!-- ==================== STORAGE ==================== -->
  
  <!-- LocalForage -->
  <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
  
  <!-- ==================== ACADEMIC TOOLS ==================== -->
  
  <!-- Intro.js - Guided Tours -->
  <link href="https://cdn.jsdelivr.net/npm/intro.js@7.2.0/minified/introjs.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/intro.js@7.2.0/intro.min.js"></script>
  
  <!-- Driver.js - Product Tours -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.3.1/dist/driver.css">
  <script src="https://cdn.jsdelivr.net/npm/driver.js@1.3.1/dist/driver.js.iife.js"></script>
  
  <!-- ==================== ML/AI (Optional) ==================== -->
  
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.13.0/dist/tf.min.js"></script>
  
  <!-- ML5.js -->
  <script src="https://unpkg.com/ml5@1/dist/ml5.min.js"></script>
  
  <!-- ==================== SWIPER (Sliders) ==================== -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  
  <!-- ==================== PARTICLES (Optional) ==================== -->
  
  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
  
  <!-- ==================== RECOMMENDED ENHANCEMENTS ==================== -->
  
  <!-- Hammer.js - Touch Gestures (للتنقل السريع) -->
  <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
  
  <!-- Howler.js - Audio (نطق المصطلحات) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>
  
  <!-- Canvas Confetti - Celebrations (احتفالات الإجابات الصحيحة) -->
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  
  <!-- Sortable.js - Drag & Drop (أسئلة التفاعلية) -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.1/Sortable.min.js"></script>
  
  <!-- Intersection Observer Polyfill (تتبع التقدم) -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=IntersectionObserver"></script>
  
  <!-- Plyr.js - Enhanced Video Player -->
  <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
  <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
  
  <!-- Lottie - Vector Animations (شرح المفاهيم) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  
  <!-- Flickity - Carousel (عرض الأمثلة) -->
  <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
  
  <!-- FastClick - لإزالة تأخير اللمس على الموبايل -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
<style>
    /* ==================== ROOT VARIABLES ==================== */
    :root {
      --color-primary: #16a34a;
      --color-primary-dark: #4d7c0f;
      --color-primary-medium: #22c55e;
      --color-ai: #f59e0b;
      --color-business: #2563eb;
      --color-finance: #059669;
      --color-accounting: #dc2626;
      --color-economics: #7c3aed;
      --glass-bg: rgba(240, 253, 244, 0.25);
      --glass-border: rgba(255, 255, 255, 0.4);
      --text-color: #0f172a;
      --border-radius: 24px;
      --font-arabic: 'IBM Plex Sans Arabic', 'Cairo', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-english: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      --font-mono: 'Roboto Mono', 'Courier New', monospace;
    }

    /* ==================== SHIMMER EFFECT (إضافة جديدة) ==================== */
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    .shimmer {
      background: linear-gradient(
        90deg,
        #f0f0f0 0%,
        #e0e0e0 20%,
        #f0f0f0 40%,
        #f0f0f0 100%
      );
      background-size: 200% 100%;
      animation: shimmer 1.5s infinite linear;
    }
    
    .shimmer-overlay {
      position: relative;
      overflow: hidden;
    }
    
    .shimmer-overlay::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255, 255, 255, 0.3) 50%,
        transparent 100%
      );
      animation: shimmer-slide 1.5s infinite;
      z-index: 10;
    }
    
    @keyframes shimmer-slide {
      0% { left: -100%; }
      100% { left: 100%; }
    }

    /* ==================== SKELETON LOADING (إضافة جديدة) ==================== */
    .skeleton {
      background-color: #e0e0e0;
      border-radius: 8px;
      position: relative;
      overflow: hidden;
    }
    
    .skeleton::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        90deg,
        transparent,
        rgba(255, 255, 255, 0.5),
        transparent
      );
      animation: skeleton-loading 1.5s infinite;
    }
    
    @keyframes skeleton-loading {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .skeleton-video {
      width: 100%;
      aspect-ratio: 16/9;
      margin-bottom: 20px;
    }
    
    .skeleton-text {
      height: 16px;
      width: 100%;
      margin-bottom: 8px;
    }
    
    .skeleton-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
    }

    /* ==================== ANIMATIONS ==================== */
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }
    @keyframes waveFlow {
      0%, 100% { transform: translateX(-25%) scaleY(1) scaleX(1); }
      33% { transform: translateX(-10%) scaleY(1.1) scaleX(0.9); }
      66% { transform: translateX(10%) scaleY(0.9) scaleX(1.1); }
    }
    @keyframes translate-glow {
      0%, 100% { box-shadow: 0 0 15px -5px rgba(77, 124, 15, 0.4), inset 0 2px 0 rgba(255,255,255,0.4); }
      50% { box-shadow: 0 0 25px 0px rgba(77, 124, 15, 0.6), inset 0 2px 0 rgba(255,255,255,0.6); }
    }
    @keyframes ai-glow {
      0%, 100% { box-shadow: 0 0 15px -5px rgba(245, 158, 11, 0.4), inset 0 2px 0 rgba(255,255,255,0.4); }
      50% { box-shadow: 0 0 25px 0px rgba(245, 158, 11, 0.6), inset 0 2px 0 rgba(255,255,255,0.6); }
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes typing {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 1; }
    }
    @keyframes typingDots {
      0%, 20% { opacity: 0; }
      40% { opacity: 1; }
      60%, 100% { opacity: 0; }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.8; transform: scale(0.95); }
    }
    @keyframes countUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes spin {
      to { transform: translate(-50%, -50%) rotate(360deg); }
    }
    @keyframes tapFeedback {
      0% { opacity: 0; transform: translateY(-50%) scale(0.6); }
      50% { opacity: 1; transform: translateY(-50%) scale(1.15); }
      100% { opacity: 0; transform: translateY(-50%) scale(1); }
    }

    /* ==================== BASE STYLES ==================== */
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }
    html { 
      font-size: clamp(0.9rem, 2.5vw, 1.05rem); 
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    body {
      font-family: var(--font-arabic);
      background: #f0fdf4;
      color: var(--text-color);
      line-height: 1.8;
      overflow-x: hidden;
      direction: rtl;
      padding: clamp(10px, 3vw, 20px);
      font-weight: 400;
      touch-action: manipulation;
    }
    body[dir="ltr"] { 
      direction: ltr; 
      font-family: var(--font-english);
    }

    /* ==================== BACKGROUND WAVES ==================== */
    .background-waves {
      position: fixed; inset: 0; z-index: -2;
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 25%, #fefce8 50%, #ecfccb 75%, #f0fdf4 100%);
      background-size: 400% 400%;
      animation: gradientShift 20s ease infinite;
    }
    .wave-layer {
      position: absolute; bottom: -10%; left: -10%; width: 120%; height: 300px;
      background: linear-gradient(90deg, rgba(22,163,74,0.08), rgba(77,124,15,0.08), rgba(34,197,94,0.08));
      border-radius: 60% 40% 0 0;
      animation: waveFlow 15s ease-in-out infinite;
    }
    .wave-layer:nth-child(2) {
      bottom: -5%; height: 250px; animation-delay: -5s;
      background: linear-gradient(90deg, rgba(77,124,15,0.06), rgba(34,197,94,0.06));
      border-radius: 40% 60% 0 0;
    }
    .wave-layer:nth-child(3) {
      bottom: 0%; height: 200px; animation-delay: -10s;
      background: linear-gradient(90deg, rgba(34,197,94,0.04), rgba(22,163,74,0.04));
      border-radius: 80% 20% 0 0;
    }

    /* ==================== TRANSLATION BUTTON ==================== */
    .translation-button {
      position: fixed; top: clamp(20px, 5vw, 30px); right: clamp(20px, 5vw, 30px);
      background: rgba(255,255,255,0.15); backdrop-filter: blur(30px);
      border: 2px solid var(--glass-border); border-radius: 50px;
      padding: clamp(8px, 2vw, 12px); cursor: pointer; z-index: 1000;
      width: clamp(50px, 12vw, 60px); height: clamp(50px, 12vw, 60px);
      display: flex; align-items: center; justify-content: center;
      transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      box-shadow: 0 8px 25px -10px rgba(0,0,0,0.2), inset 0 2px 0 rgba(255,255,255,0.6);
    }
    .translation-button svg { width: 28px; height: 28px; flex-shrink: 0; transition: transform 0.3s ease; }
    .translation-button svg path, .translation-button svg circle { stroke: var(--color-primary-dark); }
    body[dir="ltr"] .translation-button { right: auto; left: clamp(20px, 5vw, 30px); }
    .translation-button:hover {
      width: auto; padding: clamp(8px, 2vw, 12px) clamp(16px, 4vw, 22px);
      border-color: var(--color-primary-dark);
      background: rgba(77, 124, 15, 0.15);
      transform: translateY(-3px);
      animation: translate-glow 2.5s infinite alternate;
    }
    .translation-button:hover svg { transform: scale(0.9); }
    .translation-text {
      font-size: clamp(0.85rem, 2.2vw, 1rem); 
      font-weight: 600;
      color: var(--color-primary-dark); 
      white-space: nowrap;
      display: none; 
      margin-left: 10px;
    }
    body[dir="ltr"] .translation-text { margin-left: 0; margin-right: 10px; }
    .translation-button:hover .translation-text { display: block; }

    /* ==================== AI FAB BUTTON ==================== */
    .ai-fab-button {
      position: fixed; bottom: clamp(20px, 5vw, 30px); right: clamp(20px, 5vw, 30px);
      background: rgba(255,255,255,0.15); backdrop-filter: blur(30px);
      border: 2px solid var(--glass-border); border-radius: 50px;
      padding: clamp(10px, 2.5vw, 14px); cursor: pointer; z-index: 1000;
      width: clamp(56px, 14vw, 70px); height: clamp(56px, 14vw, 70px);
      display: flex; align-items: center; justify-content: center;
      transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
      box-shadow: 0 8px 25px -10px rgba(245, 158, 11, 0.3), inset 0 2px 0 rgba(255,255,255,0.6);
    }
    body[dir="ltr"] .ai-fab-button { right: auto; left: clamp(20px, 5vw, 30px); }
    .ai-fab-button:hover {
      width: auto; padding: clamp(10px, 2.5vw, 14px) clamp(18px, 4.5vw, 24px);
      border-color: var(--color-ai);
      background: rgba(245, 158, 11, 0.15);
      transform: translateY(-3px);
      animation: ai-glow 2.5s infinite alternate;
    }
    .ai-fab-button svg { 
      width: clamp(28px, 7vw, 36px); 
      height: clamp(28px, 7vw, 36px); 
      flex-shrink: 0; 
      transition: transform 0.3s ease; 
    }
    .ai-fab-button:hover svg { transform: scale(0.9) rotate(5deg); }
    .ai-fab-text {
      font-size: clamp(0.85rem, 2.2vw, 1rem); 
      font-weight: 600;
      color: var(--color-ai); 
      white-space: nowrap;
      display: none; 
      margin-left: 10px;
    }
    body[dir="ltr"] .ai-fab-text { margin-left: 0; margin-right: 10px; }
    .ai-fab-button:hover .ai-fab-text { display: block; }

    /* ==================== AI CHAT MODAL ==================== */
    .ai-chat-modal {
      position: fixed; inset: 0;
      background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px);
      display: none; align-items: center; justify-content: center;
      z-index: 2000; padding: 20px;
    }
    .ai-chat-modal.visible { display: flex; animation: fadeIn 0.3s ease; }
    
    .ai-chat-container {
      background: var(--glass-bg); 
      border: 2px solid var(--glass-border); 
      border-radius: var(--border-radius);
      width: 90%; max-width: 600px; height: 80%; max-height: 700px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.2);
      display: flex; flex-direction: column;
      transform: scale(0.95); transition: transform 0.3s ease;
      backdrop-filter: blur(25px);
      overflow: hidden;
    }
    .ai-chat-modal.visible .ai-chat-container { transform: scale(1); }
    
    .ai-chat-header {
      padding: 15px 20px;
      border-bottom: 2px solid var(--glass-border);
      display: flex; justify-content: space-between; align-items: center;
      background: linear-gradient(180deg, rgba(255,255,255,0.4), transparent);
    }
    .ai-chat-header h3 {
      color: var(--color-primary);
      margin: 0;
      font-size: clamp(1.1rem, 4vw, 1.3rem);
      font-weight: 700;
    }
    .ai-chat-close-btn {
      background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0.1));
      border: 1.5px solid rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(10px);
      color: #64748b;
      width: 38px;
      height: 38px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      font-size: 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08), inset 0 1px 0 rgba(255,255,255,0.6);
      position: relative;
      overflow: hidden;
    }
    .ai-chat-close-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(220, 38, 38, 0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    .ai-chat-close-btn:hover::before { opacity: 1; }
    .ai-chat-close-btn:hover {
      border-color: rgba(220, 38, 38, 0.4);
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 20px rgba(220, 38, 38, 0.25), inset 0 1px 0 rgba(255,255,255,0.8);
    }
    .ai-chat-close-btn svg {
      width: 18px;
      height: 18px;
      color: #64748b;
      transition: all 0.3s ease;
      position: relative;
      z-index: 1;
    }
    .ai-chat-close-btn:hover svg {
      color: #dc2626;
      transform: rotate(90deg) scale(1.1);
    }
    
    .ai-chat-messages {
      flex: 1; overflow-y: auto; padding: 20px;
      display: flex; flex-direction: column; gap: 15px;
    }
    .ai-chat-messages::-webkit-scrollbar { width: 10px; }
    .ai-chat-messages::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.2);
      border-radius: 10px;
    }
    .ai-chat-messages::-webkit-scrollbar-thumb {
      background: rgba(22, 163, 74, 0.4);
      border-radius: 10px;
      border: 2px solid transparent;
      background-clip: padding-box;
    }
    .ai-chat-messages::-webkit-scrollbar-thumb:hover {
      background: rgba(22, 163, 74, 0.6);
      background-clip: padding-box;
    }
    
    .chat-message {
      max-width: 85%;
      padding: 10px 15px;
      border-radius: 18px;
      line-height: 1.6;
      animation: slideUp 0.3s ease;
    }
    .user-message {
      background: rgba(22,163,74,0.2);
      color: #14532d;
      border-bottom-right-radius: 4px;
      align-self: flex-end;
    }
    body[dir="ltr"] .user-message {
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 18px;
      align-self: flex-start;
    }
    .ai-message {
      background: rgba(245,158,11,0.15);
      color: #78350f;
      border-bottom-left-radius: 4px;
      align-self: flex-start;
    }
    body[dir="ltr"] .ai-message {
      border-bottom-right-radius: 4px;
      border-bottom-left-radius: 18px;
      align-self: flex-end;
    }
    
    .chat-message strong { color: #1e3a8a; font-weight: 700; }
    .chat-message ul { margin: 8px 0; padding-right: 20px; }
    body[dir="ltr"] .chat-message ul { padding-right: 0; padding-left: 20px; }
    .chat-message li { margin-bottom: 4px; color: inherit; }
    
    .typing-indicator {
      background: rgba(245,158,11,0.15) !important;
      color: #9ca3af !important;
      font-style: italic;
    }
    .dot {
      animation: typingDots 1.5s infinite;
      font-size: 1.2em;
      color: var(--color-ai) !important;
    }
    .dot:nth-child(2) { animation-delay: 0.3s; }
    .dot:nth-child(3) { animation-delay: 0.6s; }
    
    .ai-chat-input-area {
      padding: 15px 20px;
      border-top: 2px solid var(--glass-border);
      display: flex; gap: 10px;
      background: linear-gradient(0deg, rgba(255,255,255,0.4), transparent);
    }
    #ai-chat-input {
      flex-grow: 1;
      border: 2px solid var(--glass-border);
      background: rgba(255,255,255,0.3);
      border-radius: 50px;
      padding: 10px 18px;
      font-size: 1rem;
      color: var(--text-color);
      outline: none;
      transition: border-color 0.3s, box-shadow 0.3s;
      font-family: inherit;
    }
    #ai-chat-input:focus {
      border-color: var(--color-ai);
      box-shadow: 0 0 10px rgba(245,158,11,0.3);
    }
    #ai-chat-input:disabled { opacity: 0.6; cursor: not-allowed; }
    
    #ai-chat-send-btn {
      background-color: var(--color-ai);
      border: none; border-radius: 50%;
      width: 48px; height: 48px; flex-shrink: 0;
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background-color 0.3s, transform 0.2s, opacity 0.3s;
    }
    #ai-chat-send-btn:hover:not(:disabled) {
      background-color: #fbbf24;
      transform: scale(1.05);
    }
    #ai-chat-send-btn:disabled {
      opacity: 0.6; cursor: not-allowed; transform: none;
    }
    #ai-chat-send-btn svg { width: 24px; height: 24px; color: white; }

    /* ==================== TOAST NOTIFICATION (إضافة جديدة) ==================== */
    .toast-notification {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: blur(20px);
      color: #fff;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 14px;
      font-weight: 600;
      opacity: 0;
      pointer-events: none;
      z-index: 10000;
      transition: all 0.3s ease;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
      white-space: nowrap;
    }

    .toast-notification.show {
      opacity: 1;
      transform: translateX(-50%) translateY(-10px);
    }

    /* ==================== DEVICE BADGE (إضافة جديدة) ==================== */
    .device-badge {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 16px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border-radius: 50px;
      font-size: 0.9rem;
      font-weight: 600;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    /* ==================== MAIN CONTENT ==================== */
    .main-content { max-width: 1200px; margin: 90px auto 0; padding: clamp(20px, 5vw, 40px); }
    .glassy-card {
      background: var(--glass-bg);
      border: 2px solid var(--glass-border);
      border-radius: var(--border-radius);
      padding: clamp(20px, 5vw, 30px);
      margin-bottom: clamp(25px, 5vw, 35px);
      backdrop-filter: blur(25px);
      transition: all 0.4s ease;
      box-shadow: 0 20px 50px rgba(0,0,0,0.1), inset 0 2px 0 rgba(255,255,255,0.5);
    }
    .glassy-card:hover { transform: translateY(-5px) scale(1.01); border-color: rgba(255,255,255,0.7); }

    /* ==================== TYPOGRAPHY ==================== */
    h1, h2, h3, h4, h5 { 
      font-weight: 700; 
      text-shadow: 0 2px 8px rgba(255,255,255,0.8);
      letter-spacing: -0.02em;
    }
    h1 {
      font-size: clamp(2rem, 6vw, 3.2rem);
      text-align: center;
      margin-bottom: clamp(20px, 4vw, 30px);
      color: #14532d;
      font-weight: 800;
    }
    h2 {
      font-size: clamp(1.5rem, 5vw, 2.5rem);
      border-bottom: 3px solid rgba(22,163,74,0.3);
      padding-bottom: clamp(10px, 2vw, 15px);
      margin-bottom: clamp(20px, 4vw, 30px);
      color: #166534;
      font-weight: 700;
    }
    h3 {
      font-size: clamp(1.2rem, 4vw, 1.8rem);
      margin-bottom: clamp(15px, 3vw, 20px);
      color: #15803d;
      font-weight: 600;
    }
    h4 {
      font-size: clamp(1.1rem, 3.5vw, 1.4rem);
      color: var(--color-primary);
      margin-bottom: clamp(12px, 2vw, 15px);
      font-weight: 600;
    }
    p, li { 
      color: #475569; 
      margin-bottom: clamp(10px, 2vw, 12px);
      line-height: 1.85;
    }
    strong { color: #14532d; font-weight: 600; }
    ul, ol { padding-right: clamp(20px, 4vw, 25px); margin-bottom: 20px; }
    body[dir="ltr"] ul, body[dir="ltr"] ol { padding-right: 0; padding-left: clamp(20px, 4vw, 25px); }

    /* ==================== HIGHLIGHTERS ==================== */
    mark {
      border-radius: 4px;
      padding: 2px 6px;
      font-weight: 500;
      border: none;
    }
    .highlight-green { background: rgba(22,163,74,0.2); color: #14532d; }
    .highlight-blue { background: rgba(59,130,246,0.2); color: #1e3a8a; }
    .highlight-yellow { background: rgba(234,179,8,0.2); color: #713f12; }
    .highlight-orange { background: rgba(249,115,22,0.2); color: #7c2d12; }
    .highlight-pink { background: rgba(236,72,153,0.2); color: #831843; }
    .highlight-business { background: rgba(37,99,235,0.2); color: #1e3a8a; }
    .highlight-finance { background: rgba(5,150,105,0.2); color: #064e3b; }
    .highlight-accounting { background: rgba(220,38,38,0.2); color: #7f1d1d; }
    .highlight-economics { background: rgba(124,58,237,0.2); color: #4c1d95; }

    /* ==================== INTERACTIVE QUESTIONS ==================== */
    .question-container {
      background: rgba(22,163,74,0.08);
      border: 2px solid rgba(22,163,74,0.2);
      border-radius: 18px;
      padding: 20px;
      margin: 20px 0;
      cursor: pointer;
      position: relative;
      transition: all 0.3s ease;
    }
    .question-container:hover {
      transform: translateY(-2px);
      border-color: var(--color-primary-medium);
      background: rgba(22,163,74,0.12);
    }
    .question-container.open {
      border-color: var(--color-primary-medium);
      background: rgba(22,163,74,0.15);
    }

    .question-header {
      font-weight: 600;
      color: var(--color-primary);
      margin-bottom: 0;
      font-size: 1.05rem;
      display: flex;
      align-items: center;
      gap: 12px;
      padding-right: 35px;
    }
    body[dir="ltr"] .question-header { padding-right: 0; padding-left: 35px; }

    .question-icon {
      width: 22px;
      height: 22px;
      flex-shrink: 0;
    }

    .arrow-icon {
      width: 18px;
      height: 18px;
      position: absolute;
      top: 22px;
      right: 20px;
      transition: transform 0.3s ease;
      flex-shrink: 0;
    }
    body[dir="ltr"] .arrow-icon { right: auto; left: 20px; }
    .question-container.open .arrow-icon { transform: rotate(180deg); }

    .question-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease, margin-top 0.3s ease;
    }
    .question-content.show { max-height: 2000px; margin-top: 20px; }

    .mcq-options { list-style: none; padding: 0; margin-top: 15px; }
    .mcq-option {
      background: rgba(255,255,255,0.3);
      border: 2px solid rgba(255,255,255,0.4);
      border-radius: 12px;
      padding: 14px 18px;
      margin: 10px 0;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      position: relative;
    }
    .mcq-option:hover {
      background: rgba(22,163,74,0.15);
      transform: translateX(-5px);
      border-color: var(--color-primary);
    }
    body[dir="ltr"] .mcq-option:hover { transform: translateX(5px); }
    .mcq-option.selected {
      background: rgba(22,163,74,0.2);
      border-color: var(--color-primary);
      transform: scale(1.02);
    }
    .mcq-option.correct {
      background: linear-gradient(135deg, rgba(34,197,94,0.3), rgba(22,163,74,0.2));
      border-color: var(--color-primary-medium);
      color: #14532d;
      font-weight: 600;
    }
    .mcq-option.incorrect {
      background: linear-gradient(135deg, rgba(239,68,68,0.3), rgba(220,38,38,0.2));
      border-color: #dc2626;
      color: #7f1d1d;
      animation: shake 0.5s ease;
    }

    .solution-content {
      background: rgba(255,255,255,0.3);
      border: 1px solid rgba(255,255,255,0.4);
      padding: 20px;
      border-radius: 14px;
      animation: slideUp 0.6s ease;
    }
    .solution-content strong { color: #15803d; }

    /* ==================== TABLES ==================== */
    .table-container { 
      overflow-x: auto; 
      margin: 20px 0; 
      border-radius: 12px; 
      box-shadow: 0 8px 25px rgba(0,0,0,0.1); 
    }
    .concepts-table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(255,255,255,0.2);
      border-radius: 12px;
      overflow: hidden;
      backdrop-filter: blur(15px);
    }
    .concepts-table th, .concepts-table td {
      padding: clamp(8px, 2vw, 12px);
      border: 1px solid rgba(255,255,255,0.3);
      text-align: right;
      font-size: clamp(0.8rem, 2vw, 1rem);
      vertical-align: top;
    }
    body[dir="ltr"] .concepts-table th,
    body[dir="ltr"] .concepts-table td { text-align: left; }
    .concepts-table th {
      background: rgba(22,163,74,0.2);
      font-weight: 700;
      color: var(--color-primary);
      text-align: center;
    }
    .concepts-table tr:hover { background: rgba(255,255,255,0.1); }

    /* Financial Tables */
    .financial-table th {
      background: rgba(5,150,105,0.2);
      color: var(--color-finance);
    }
    .accounting-table th {
      background: rgba(220,38,38,0.2);
      color: var(--color-accounting);
    }

    /* ==================== CHARTS (MOBILE OPTIMIZED) ==================== */
    .chart-container {
      position: relative;
      background: rgba(255,255,255,0.3);
      border-radius: 16px;
      padding: clamp(15px, 3vw, 20px);
      margin: 20px 0;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }
    .chart-container canvas {
      display: block !important;
      width: 100% !important;
      height: auto !important;
      max-height: clamp(280px, 60vh, 450px) !important;
      min-height: 220px !important;
    }
    @media (max-width: 768px) {
      .chart-container canvas {
        max-height: 350px !important;
        min-height: 250px !important;
      }
    }
    @media (max-width: 480px) {
      .chart-container canvas {
        max-height: 300px !important;
        min-height: 220px !important;
      }
    }

    /* ==================== CODE BLOCKS ==================== */
    pre[class*="language-"] {
      border-radius: 12px;
      margin: 20px 0;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      font-family: var(--font-mono);
    }

    /* ==================== BUSINESS SPECIFIC STYLES ==================== */
    .currency { 
      font-family: var(--font-mono); 
      font-weight: 600; 
      color: var(--color-finance); 
    }
    .percentage { 
      font-family: var(--font-mono); 
      font-weight: 600; 
      color: var(--color-business); 
    }
    .formula-box {
      background: rgba(124,58,237,0.1);
      border: 2px solid rgba(124,58,237,0.3);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
      font-family: var(--font-mono);
    }
    
    /* Progress Indicators */
    .progress-bar {
      height: 8px;
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--color-primary), var(--color-primary-medium));
      border-radius: 10px;
      transition: width 1s ease;
    }
    
    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }
    .stat-card {
      background: rgba(255,255,255,0.2);
      padding: 25px;
      border-radius: 16px;
      text-align: center;
      border: 2px solid rgba(255,255,255,0.3);
      transition: all 0.3s ease;
    }
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .stat-value {
      font-size: 2.5rem;
      font-weight: 800;
      margin-bottom: 8px;
    }
    .stat-label {
      font-size: 1rem;
      font-weight: 600;
      opacity: 0.8;
    }
    
    /* Alert Boxes */
    .alert-box {
      border-radius: 12px;
      padding: 20px;
      margin: 15px 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .alert-success {
      background: rgba(34,197,94,0.15);
      border-right: 4px solid #22c55e;
      color: #166534;
    }
    .alert-info {
      background: rgba(59,130,246,0.15);
      border-right: 4px solid #3b82f6;
      color: #1e3a8a;
    }
    .alert-warning {
      background: rgba(245,158,11,0.15);
      border-right: 4px solid #f59e0b;
      color: #b45309;
    }
    .alert-error {
      background: rgba(239,68,68,0.15);
      border-right: 4px solid #ef4444;
      color: #b91c1c;
    }
    body[dir="ltr"] .alert-box {
      border-right: none;
      border-left: 4px solid;
    }

    /* ==================== FOOTER ==================== */
    .footer-info {
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.3);
      border-radius: 16px;
      padding: 20px 24px;
      margin-top: 40px;
      text-align: center;
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }
    .footer-brand {
      font-size: 0.95rem;
      color: var(--color-primary-dark);
      font-weight: 600;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .footer-brand svg { width: 20px; height: 20px; }
    .footer-divider {
      width: 60px;
      height: 2px;
      background: linear-gradient(90deg, transparent, var(--color-primary), transparent);
      margin: 12px auto;
    }
    .footer-disclaimer {
      font-size: 0.85rem;
      color: #64748b;
      line-height: 1.6;
      margin-top: 8px;
    }
    
    /* ==================== UTILITY CLASSES ==================== */
    .hidden { display: none !important; }
    .text-center { text-align: center; }
    .mt-1 { margin-top: 0.5rem; }
    .mt-2 { margin-top: 1rem; }
    .mt-3 { margin-top: 1.5rem; }
    .mb-1 { margin-bottom: 0.5rem; }
    .mb-2 { margin-bottom: 1rem; }
    .mb-3 { margin-bottom: 1.5rem; }
    .p-1 { padding: 0.5rem; }
    .p-2 { padding: 1rem; }
    .p-3 { padding: 1.5rem; }

    /* ==================== VIDEO PLAYER STYLES (iOS 26 + إضافات) ==================== */
    .video-section {
      margin: clamp(30px, 6vw, 50px) 0;
    }
    
    .video-card-player {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: clamp(15px, 3vw, 30px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .video-info {
      color: #fff;
      margin-bottom: 20px;
    }

    .video-info h2 {
      font-size: clamp(1.4rem, 4vw, 2rem);
      margin-bottom: 10px;
      color: #14532d;
      border-bottom: none;
    }

    .video-info p {
      opacity: 0.8;
      line-height: 1.6;
      font-size: clamp(0.85rem, 2.5vw, 1rem);
      color: #475569;
    }

    .video-player-wrapper {
      position: relative;
      border-radius: 16px;
      overflow: hidden;
      background: #000;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    .video-player {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      background: #000;
      user-select: none;
    }

    .video-player.fullscreen-mode {
      position: fixed;
      inset: 0;
      z-index: 9999;
      aspect-ratio: auto;
      height: 100vh;
      border-radius: 0;
    }

    video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: #000;
    }

    .video-bars {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 5;
      transition: opacity 0.8s ease;
      display: none;
    }

    .video-player.fullscreen-mode .video-bars {
      display: block;
    }

    .video-bars.hidden {
      opacity: 0;
    }

    .top-bar-bg {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 120px;
      background: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, transparent 100%);
    }

    .bottom-bar-bg {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 150px;
      background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 100%);
    }

    .glass-bubble {
      border-radius: 50%;
      border: 1.5px solid rgba(255, 255, 255, 0.3);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.05) 50%, rgba(255, 255, 255, 0.1) 100%);
      backdrop-filter: blur(12px) brightness(115%);
      -webkit-backdrop-filter: blur(12px) brightness(115%);
      box-shadow: inset -3px -3px 8px rgba(255, 255, 255, 0.3), inset 3px 3px 8px rgba(0, 0, 0, 0.15), 0 8px 32px rgba(0, 0, 0, 0.3);
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .glass-bubble:hover {
      transform: scale(1.08);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.08) 50%, rgba(255, 255, 255, 0.15) 100%);
    }

    .glass-bubble:active {
      transform: scale(0.92);
    }

    .simple-controls {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8) 0%, transparent 100%);
      padding: clamp(10px, 3vw, 20px);
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 10;
    }

    .video-player:not(.fullscreen-mode):hover .simple-controls,
    .video-player:not(.fullscreen-mode).paused .simple-controls {
      opacity: 1;
    }

    .video-player.fullscreen-mode .simple-controls {
      display: none;
    }

    .simple-progress {
      height: 5px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 10px;
      margin-bottom: 12px;
      cursor: pointer;
      direction: ltr;
      position: relative;
    }

    .simple-progress-filled {
      height: 100%;
      background: #fff;
      border-radius: 10px;
      width: 0%;
    }

    .simple-controls-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #fff;
    }

    .simple-btn {
      background: none;
      border: none;
      color: #fff;
      font-size: clamp(1.2rem, 4vw, 1.5rem);
      cursor: pointer;
      padding: 8px 12px;
      transition: transform 0.2s ease;
      min-width: 44px;
      min-height: 44px;
    }

    .simple-btn:active {
      transform: scale(0.9);
    }

    .simple-time {
      font-size: clamp(0.75rem, 2.5vw, 0.9rem);
    }

    .ios-controls {
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      z-index: 10;
      display: none;
    }

    .video-player.fullscreen-mode .ios-controls {
      display: block;
    }

    .video-player.fullscreen-mode.show-controls .ios-controls {
      opacity: 1;
      pointer-events: auto;
    }

    .top-controls {
      position: absolute;
      top: env(safe-area-inset-top, 15px);
      left: 15px;
      right: 15px;
      padding-top: 5px;
      display: flex;
      justify-content: space-between;
      z-index: 11;
    }

    .top-left-group {
      display: flex;
      gap: 12px;
    }

    .control-bubble {
      width: clamp(40px, 10vw, 48px);
      height: clamp(40px, 10vw, 48px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #fff;
      font-size: clamp(16px, 4vw, 19px);
    }

    .volume-control {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .volume-slider-container {
      opacity: 0;
      transform: translateX(10px);
      pointer-events: none;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      display: flex;
      align-items: center;
      padding: 6px 12px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 100%);
      backdrop-filter: blur(20px) brightness(110%);
      border-radius: 50px;
      border: 1.5px solid rgba(255, 255, 255, 0.25);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    }

    .volume-control:hover .volume-slider-container,
    .volume-control:active .volume-slider-container {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }

    .volume-slider {
      -webkit-appearance: none;
      width: clamp(60px, 15vw, 90px);
      height: 5px;
      background: linear-gradient(to right, #fff 50%, rgba(255, 255, 255, 0.3) 50%);
      border-radius: 50px;
      outline: none;
      cursor: pointer;
      direction: ltr !important;
      box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 0;
      height: 0;
    }

    .volume-slider::-moz-range-thumb {
      width: 0;
      height: 0;
      border: none;
      background: transparent;
    }

    .center-play-controls {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: center;
      gap: clamp(30px, 8vw, 55px);
      z-index: 11;
    }

    .skip-bubble {
      width: clamp(56px, 15vw, 72px);
      height: clamp(56px, 15vw, 72px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #fff;
      font-size: clamp(20px, 5vw, 24px);
      position: relative;
    }

    .skip-number {
      position: absolute;
      font-size: clamp(8px, 2.2vw, 10px);
      font-weight: 900;
      letter-spacing: 0.3px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -48%);
      color: #fff;
      text-shadow: 0 2px 6px rgba(0, 0, 0, 0.9);
      pointer-events: none;
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
    }

    .play-bubble {
      width: clamp(70px, 18vw, 94px);
      height: clamp(70px, 18vw, 94px);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border: none;
      color: #fff;
      font-size: clamp(28px, 7vw, 34px);
    }

    .play-bubble i {
      margin-left: 3px;
    }

    .bottom-timeline {
      position: absolute;
      bottom: env(safe-area-inset-bottom, 15px);
      left: 15px;
      right: 15px;
      padding-bottom: 5px;
      z-index: 11;
    }

    .progress-wrapper {
      width: 100%;
      height: 40px;
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      cursor: pointer;
      touch-action: none;
    }

    .progress-track {
      position: relative;
      width: 100%;
      height: 5px;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.3) 100%);
      border-radius: 50px;
      direction: ltr !important;
      transition: height 0.2s ease;
      box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.2);
    }

    .progress-wrapper:hover .progress-track,
    .progress-wrapper:active .progress-track {
      height: 7px;
    }

    .video-player.dragging .progress-track {
      height: 9px;
    }

    .progress-buffered {
      position: absolute;
      height: 100%;
      background: rgba(255, 255, 255, 0.45);
      border-radius: 50px;
      width: 0%;
    }

    .progress-filled {
      position: absolute;
      height: 100%;
      background: linear-gradient(90deg, #fff, #f0f0f0);
      border-radius: 50px;
      width: 0%;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }

    .time-row {
      display: flex;
      justify-content: space-between;
      color: #fff;
    }

    .time-text {
      font-size: clamp(11px, 3vw, 13px);
      font-weight: 600;
      font-variant-numeric: tabular-nums;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
    }

    .loading-spinner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: clamp(40px, 10vw, 52px);
      height: clamp(40px, 10vw, 52px);
      border: 3px solid rgba(255, 255, 255, 0.15);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin 0.75s linear infinite;
      display: none;
      z-index: 20;
    }

    .loading-spinner.active {
      display: block;
    }

    .tap-indicator {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: #fff;
      font-size: clamp(40px, 10vw, 52px);
      opacity: 0;
      pointer-events: none;
      z-index: 15;
      filter: drop-shadow(0 4px 20px rgba(0, 0, 0, 0.7));
    }

    .tap-indicator.left { left: 15%; }
    .tap-indicator.right { right: 15%; }

    .tap-indicator.active {
      animation: tapFeedback 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* إخفاء Custom Controls على iOS (إضافة جديدة) */
    body.ios-device .simple-controls,
    body.ios-device .ios-controls {
      display: none !important;
    }

    /* ==================== CONTENT LANGUAGE TOGGLE ==================== */
    .ar-content, .en-content {
      transition: opacity 0.3s ease;
    }
    
    .en-content {
      display: none;
    }

    /* ==================== RESPONSIVE ==================== */
    @media (max-width: 768px) {
      .stats-grid {
        grid-template-columns: 1fr;
      }
      .main-content {
        margin-top: 70px;
      }
      .video-card-player { 
        border-radius: 16px; 
      }
    }
  </style>
</head>
<body>
  <!-- Background -->
  <div class="background-waves">
    <div class="wave-layer"></div>
    <div class="wave-layer"></div>
    <div class="wave-layer"></div>
  </div>

  <!-- Translation Button -->
  <button class="translation-button" id="translationButton" aria-label="تبديل اللغة">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2.25 12C2.25 17.3848 6.61522 21.75 12 21.75C17.3848 21.75 21.75 17.3848 21.75 12C21.75 6.61522 17.3848 2.25 12 2.25C9.36657 2.25 6.94277 3.22321 5.16629 4.83371M12.75 2.25V7.5M12.75 7.5H18M12.75 7.5L5.16629 4.83371M11.25 21.75V16.5M11.25 16.5H6M11.25 16.5L18.8337 19.1663M5.16629 4.83371C3.22321 6.94277 2.25 9.36657 2.25 12M2.25 12C2.25 14.6334 3.22321 17.0572 4.83371 18.8337M18.8337 19.1663C20.7768 17.0572 21.75 14.6334 21.75 12M18.8337 4.83371C17.0572 3.22321 14.6334 2.25 12 2.25" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    <span class="translation-text">English</span>
  </button>

  <!-- AI FAB Button -->
  <button class="ai-fab-button" id="aiChatButton" aria-label="مساعد أثر الذكي">
    <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: #f59e0b;">
      <path d="M12 8V4H8"></path>
      <rect x="4" y="12" width="16" height="8" rx="2"></rect>
      <path d="M2 14h2"></path>
      <path d="M20 14h2"></path>
      <path d="M15 13v-2a3 3 0 0 0-3-3H6a3 3 0 0 0-3 3v2"></path>
    </svg>
    <span class="ai-fab-text" id="aiFabText">أثر AI</span>
  </button>

  <!-- Toast Notification (إضافة جديدة) -->
  <div class="toast-notification" id="toastNotification"></div>

  <!-- AI Chat Modal -->
  <div class="ai-chat-modal" id="aiChatModal">
    <div class="ai-chat-container">
      <div class="ai-chat-header">
        <h3 id="ai-chat-title">اسأل أثر AI</h3>
        <button class="ai-chat-close-btn" id="aiChatCloseBtn" aria-label="إغلاق">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <div class="ai-chat-messages" id="aiChatMessages"></div>
      <div class="ai-chat-input-area">
        <input type="text" id="ai-chat-input" placeholder="اكتب سؤالك هنا...">
        <button id="ai-chat-send-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="22" y1="2" x2="11" y2="13"></line>
            <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">

    <!-- ==================== VIDEO PLAYER SECTION (محسّن) ==================== -->
    <section class="video-section">
      <div class="video-card-player" data-aos="fade-down">
        <div class="video-info">
          <h2>🎬 فيديو شرح: التمهيد الأسي</h2>
          <p id="playerInfo">مشغل فيديو ذكي - يكتشف جهازك تلقائياً ويعرض أفضل تجربة</p>
          <span class="device-badge" id="deviceBadge">جاري التحميل...</span>
        </div>

        <div class="video-player-wrapper">
          <div class="video-player" id="videoPlayer">
            <video id="video" playsinline preload="auto"></video>

            <div class="loading-spinner" id="loadingSpinner"></div>

            <!-- Simple Controls -->
            <div class="simple-controls">
              <div class="simple-progress" id="simpleProgress">
                <div class="simple-progress-filled" id="simpleProgressFilled"></div>
              </div>
              <div class="simple-controls-row">
                <button class="simple-btn" id="simplePlayBtn">
                  <i class="fas fa-play"></i>
                </button>
                <span class="simple-time">
                  <span id="simpleCurrentTime">0:00</span> / <span id="simpleDuration">0:00</span>
                </span>
                <button class="simple-btn" id="simpleFullscreenBtn">
                  <i class="fas fa-expand"></i>
                </button>
              </div>
            </div>

            <!-- iOS Controls -->
            <div class="ios-controls">
              <div class="video-bars" id="videoBars">
                <div class="top-bar-bg"></div>
                <div class="bottom-bar-bg"></div>
              </div>

              <div class="tap-indicator left" id="tapLeft">
                <i class="fas fa-backward"></i>
              </div>
              <div class="tap-indicator right" id="tapRight">
                <i class="fas fa-forward"></i>
              </div>

              <div class="top-controls">
                <div class="top-left-group">
                  <button class="control-bubble glass-bubble" id="closeBtn">
                    <i class="fas fa-times"></i>
                  </button>
                  <button class="control-bubble glass-bubble" id="pipBtn" style="display:none;">
                    <i class="fas fa-clone"></i>
                  </button>
                </div>
                
                <div class="volume-control">
                  <div class="volume-slider-container">
                    <input type="range" id="volumeSlider" class="volume-slider" min="0" max="1" step="0.01" value="1" />
                  </div>
                  <button class="control-bubble glass-bubble" id="volumeBtn">
                    <i class="fas fa-volume-up"></i>
                  </button>
                </div>
              </div>

              <div class="center-play-controls">
                <button class="skip-bubble glass-bubble" id="skipBack">
                  <i class="fas fa-rotate-left"></i>
                  <span class="skip-number">10</span>
                </button>

                <button class="play-bubble glass-bubble" id="playBtn">
                  <i class="fas fa-play"></i>
                </button>

                <button class="skip-bubble glass-bubble" id="skipForward">
                  <i class="fas fa-rotate-right"></i>
                  <span class="skip-number">10</span>
                </button>
              </div>

              <div class="bottom-timeline">
                <div class="progress-wrapper" id="progressWrapper">
                  <div class="progress-track">
                    <div class="progress-buffered" id="progressBuffered"></div>
                    <div class="progress-filled" id="progressFilled"></div>
                  </div>
                </div>

                <div class="time-row">
                  <span class="time-text" id="currentTime">0:00</span>
                  <span class="time-text" id="remainingTime">-0:00</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

  
  <!-- ==================== ARABIC CONTENT ==================== -->
  <    <!-- ==================== 1. تجربة Glassmorphism & Shimmer ==================== -->
    <div class="glassy-card shimmer-overlay" data-aos="fade-up">
      <h1>🎓 اختبار شامل لـ 50+ مكتبة</h1>
      <p>هذا المحتوى يختبر <strong>جميع المكتبات</strong> واحدة تلو الأخرى!</p>
      
      <div class="alert-box alert-success">
        <strong>✅ جاهز للاختبار!</strong> جميع المكتبات محملة ومستعدة
      </div>
    </div>

    <!-- ==================== 2. MathJax & KaTeX ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📐 اختبار MathJax & KaTeX</h2>
      
      <h3>معادلات بسيطة:</h3>
      <p>معادلة خطية: \( y = mx + c \)</p>
      <p>معادلة تربيعية: \( ax^2 + bx + c = 0 \)</p>
      
      <h3>معادلة التمهيد الأسي:</h3>
      <div class="formula-box">
        \[ F_t = F_{t-1} + \alpha \cdot (A_{t-1} - F_{t-1}) \]
      </div>
      
      <h3>معادلات متقدمة:</h3>
      <p>المجموع: \( \sum_{i=1}^{n} x_i \)</p>
      <p>التكامل: \( \int_{a}^{b} f(x) \, dx \)</p>
      <p>المصفوفة: \( \begin{bmatrix} a & b \\ c & d \end{bmatrix} \)</p>
    </div>

    <!-- ==================== 3. Chart.js ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📊 اختبار Chart.js</h2>
      
      <h3>Line Chart:</h3>
      <div class="chart-container">
        <canvas id="chartLine"></canvas>
      </div>
      
      <h3>Bar Chart:</h3>
      <div class="chart-container">
        <canvas id="chartBar"></canvas>
      </div>
      
      <h3>Pie Chart:</h3>
      <div class="chart-container">
        <canvas id="chartPie"></canvas>
      </div>
      
      <script>
        setTimeout(() => {
          // Line Chart
          if (document.getElementById('chartLine') && typeof Chart !== 'undefined') {
            new Chart(document.getElementById('chartLine'), {
              type: 'line',
              data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                  label: 'الطلب الفعلي',
                  data: [65, 59, 80, 81, 56, 55],
                  borderColor: 'rgb(22, 163, 74)',
                  backgroundColor: 'rgba(22, 163, 74, 0.1)',
                  tension: 0.4
                }]
              },
              options: { responsive: true, maintainAspectRatio: false }
            });
          }
          
          // Bar Chart
          if (document.getElementById('chartBar')) {
            new Chart(document.getElementById('chartBar'), {
              type: 'bar',
              data: {
                labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                datasets: [{
                  label: 'المبيعات',
                  data: [12000, 19000, 3000, 5000],
                  backgroundColor: ['rgba(22, 163, 74, 0.7)', 'rgba(245, 158, 11, 0.7)', 'rgba(59, 130, 246, 0.7)', 'rgba(220, 38, 38, 0.7)']
                }]
              },
              options: { responsive: true, maintainAspectRatio: false }
            });
          }
          
          // Pie Chart
          if (document.getElementById('chartPie')) {
            new Chart(document.getElementById('chartPie'), {
              type: 'pie',
              data: {
                labels: ['المنتج أ', 'المنتج ب', 'المنتج ج'],
                datasets: [{
                  data: [300, 50, 100],
                  backgroundColor: ['rgb(22, 163, 74)', 'rgb(245, 158, 11)', 'rgb(59, 130, 246)']
                }]
              },
              options: { responsive: true, maintainAspectRatio: false }
            });
          }
          
          console.log('✅ Chart.js: All charts created!');
        }, 2000);
      </script>
    </div>

    <!-- ==================== 4. Echarts ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📈 اختبار Echarts</h2>
      
      <div id="echartsContainer" style="width: 100%; height: 400px; background: rgba(255,255,255,0.3); border-radius: 16px;"></div>
      
      <script>
        setTimeout(() => {
          if (typeof echarts !== 'undefined') {
            const myChart = echarts.init(document.getElementById('echartsContainer'));
            const option = {
              title: { text: 'Echarts - التنبؤ مقابل الفعلي' },
              tooltip: {},
              legend: { data: ['الفعلي', 'التنبؤ'] },
              xAxis: { data: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'] },
              yAxis: {},
              series: [
                { name: 'الفعلي', type: 'bar', data: [65, 59, 80, 81, 56, 55] },
                { name: 'التنبؤ', type: 'line', data: [60, 62, 75, 78, 58, 57] }
              ]
            };
            myChart.setOption(option);
            console.log('✅ Echarts working!');
          }
        }, 2500);
      </script>
    </div>

    <!-- ==================== 5. ApexCharts ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📉 اختبار ApexCharts</h2>
      
      <div id="apexchartContainer"></div>
      
      <script>
        setTimeout(() => {
          if (typeof ApexCharts !== 'undefined') {
            const options = {
              series: [{
                name: 'المبيعات',
                data: [30, 40, 35, 50, 49, 60, 70, 91, 125]
              }],
              chart: { type: 'area', height: 350 },
              xaxis: { categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'] },
              colors: ['#16a34a']
            };
            const chart = new ApexCharts(document.querySelector("#apexchartContainer"), options);
            chart.render();
            console.log('✅ ApexCharts working!');
          }
        }, 3000);
      </script>
    </div>

    <!-- ==================== 6. Plotly ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📊 اختبار Plotly</h2>
      
      <div id="plotlyContainer"></div>
      
      <script>
        setTimeout(() => {
          if (typeof Plotly !== 'undefined') {
            const trace1 = {
              x: [1, 2, 3, 4, 5],
              y: [1, 6, 3, 6, 1],
              mode: 'markers+lines',
              name: 'البيانات',
              marker: { size: 12 }
            };
            const layout = { title: 'Plotly - مثال تفاعلي' };
            Plotly.newPlot('plotlyContainer', [trace1], layout);
            console.log('✅ Plotly working!');
          }
        }, 3500);
      </script>
    </div>

    <!-- ==================== 7. Highcharts ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📈 اختبار Highcharts</h2>
      
      <div id="highchartsContainer"></div>
      
      <script>
        setTimeout(() => {
          if (typeof Highcharts !== 'undefined') {
            Highcharts.chart('highchartsContainer', {
              title: { text: 'Highcharts - الإيرادات الشهرية' },
              xAxis: { categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'] },
              series: [{
                name: 'الإيرادات',
                data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0]
              }]
            });
            console.log('✅ Highcharts working!');
          }
        }, 4000);
      </script>
    </div>

    <!-- ==================== 8. Interactive Questions + Confetti ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>❓ اختبار Confetti & Questions</h2>
      
      <div class="question-container" onclick="toggleQuestion(this)">
        <div class="question-header">
          <svg class="question-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
          <span>ما هي قيمة \( \alpha \) المثالية؟</span>
          <svg class="arrow-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </div>
        
        <div class="question-content">
          <ul class="mcq-options">
            <li class="mcq-option" data-answer="wrong">أ) \( \alpha = 0.9 \)</li>
            <li class="mcq-option" data-answer="correct">ب) \( \alpha = 0.1 \)</li>
            <li class="mcq-option" data-answer="wrong">ج) \( \alpha = 0.5 \)</li>
            <li class="mcq-option" data-answer="wrong">د) \( \alpha = 1.0 \)</li>
          </ul>
          
          <div class="solution-content" style="display:none;">
            <strong>💡 الشرح:</strong>
            <p>القيمة المنخفضة أفضل للبيانات المستقرة!</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== 9. DataTables ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📋 اختبار DataTables</h2>
      
      <div class="table-container">
        <table id="datatableExample" class="concepts-table">
          <thead>
            <tr>
              <th>الاسم</th>
              <th>العمر</th>
              <th>المدينة</th>
              <th>الراتب</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>أحمد</td><td>25</td><td>القاهرة</td><td>5000</td></tr>
            <tr><td>محمد</td><td>30</td><td>الإسكندرية</td><td>6000</td></tr>
            <tr><td>فاطمة</td><td>28</td><td>الجيزة</td><td>5500</td></tr>
            <tr><td>نور</td><td>32</td><td>الأقصر</td><td>7000</td></tr>
          </tbody>
        </table>
      </div>
      
      <script>
        setTimeout(() => {
          if (typeof $.fn.DataTable !== 'undefined') {
            $('#datatableExample').DataTable({
              language: {
                url: '//cdn.datatables.net/plug-ins/1.13.7/i18n/ar.json'
              }
            });
            console.log('✅ DataTables working!');
          }
        }, 4500);
      </script>
    </div>

    <!-- ==================== 10. Mermaid (Diagrams) ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>🔄 اختبار Mermaid</h2>
      
      <h3>Flowchart:</h3>
      <div class="mermaid">
        graph TD
          A[البداية] --> B{قرار}
          B -->|نعم| C[العملية 1]
          B -->|لا| D[العملية 2]
          C --> E[النهاية]
          D --> E
      </div>
      
      <h3>Pie Chart:</h3>
      <div class="mermaid">
        pie title التوزيع
          "المنتج أ" : 45
          "المنتج ب" : 30
          "المنتج ج" : 25
      </div>
      
      <h3>Sequence Diagram:</h3>
      <div class="mermaid">
        sequenceDiagram
          participant A as العميل
          participant B as النظام
          A->>B: طلب
          B->>A: استجابة
      </div>
    </div>

    <!-- ==================== 11. Prism.js (Code Highlighting) ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>💻 اختبار Prism.js</h2>
      
      <h3>Python:</h3>
      <pre><code class="language-python">def calculate(x, y):
    return x + y

result = calculate(10, 20)
print(f"النتيجة: {result}")</code></pre>

      <h3>JavaScript:</h3>
      <pre><code class="language-javascript">const calculate = (x, y) => {
  return x + y;
};

const result = calculate(10, 20);
console.log(`النتيجة: ${result}`);</code></pre>

      <h3>SQL:</h3>
      <pre><code class="language-sql">SELECT * FROM customers
WHERE country = 'Egypt'
ORDER BY name DESC
LIMIT 10;</code></pre>
    </div>

    <!-- ==================== 12. SweetAlert2 ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>🔔 اختبار SweetAlert2</h2>
      
      <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:15px;">
        <button onclick="Swal.fire({title: 'نجاح!', text: 'العملية تمت بنجاح', icon: 'success'})" style="padding:12px; background:#22c55e; color:white; border:none; border-radius:12px; cursor:pointer; font-weight:600;">
          ✅ Success
        </button>
        
        <button onclick="Swal.fire({title: 'خطأ!', text: 'حدث خطأ ما', icon: 'error'})" style="padding:12px; background:#dc2626; color:white; border:none; border-radius:12px; cursor:pointer; font-weight:600;">
          ❌ Error
        </button>
        
        <button onclick="Swal.fire({title: 'تحذير!', text: 'انتبه لهذا', icon: 'warning'})" style="padding:12px; background:#f59e0b; color:white; border:none; border-radius:12px; cursor:pointer; font-weight:600;">
          ⚠️ Warning
        </button>
        
        <button onclick="Swal.fire({title: 'معلومة', text: 'هذه معلومة مفيدة', icon: 'info'})" style="padding:12px; background:#3b82f6; color:white; border:none; border-radius:12px; cursor:pointer; font-weight:600;">
          ℹ️ Info
        </button>
      </div>
    </div>

    <!-- ==================== 13. Moment.js (Dates) ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📅 اختبار Moment.js</h2>
      
      <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 16px;">
        <p><strong>التاريخ الحالي:</strong> <span id="momentNow"></span></p>
        <p><strong>منذ:</strong> <span id="momentRelative"></span></p>
        <p><strong>التنسيق الكامل:</strong> <span id="momentFull"></span></p>
      </div>
      
      <script>
        if (typeof moment !== 'undefined') {
          document.getElementById('momentNow').textContent = moment().format('LL');
          document.getElementById('momentRelative').textContent = moment('2024-01-01').fromNow();
          document.getElementById('momentFull').textContent = moment().format('LLLL');
          console.log('✅ Moment.js working!');
        }
      </script>
    </div>

    <!-- ==================== 14. Accounting.js + Numeral.js ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>💰 اختبار Accounting.js & Numeral.js</h2>
      
      <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 16px;">
        <h3>Accounting.js:</h3>
        <p><strong>تنسيق العملة:</strong> <span id="accountingCurrency"></span></p>
        <p><strong>تنسيق الأرقام:</strong> <span id="accountingNumber"></span></p>
        
        <h3 style="margin-top:20px;">Numeral.js:</h3>
        <p><strong>النسبة المئوية:</strong> <span id="numeralPercent"></span></p>
        <p><strong>تنسيق كبير:</strong> <span id="numeralLarge"></span></p>
      </div>
      
      <script>
        if (typeof accounting !== 'undefined') {
          document.getElementById('accountingCurrency').textContent = accounting.formatMoney(123456.78, "ج.م ", 2);
          document.getElementById('accountingNumber').textContent = accounting.formatNumber(1234567.89, 2);
          console.log('✅ Accounting.js working!');
        }
        
        if (typeof numeral !== 'undefined') {
          document.getElementById('numeralPercent').textContent = numeral(0.456).format('0.00%');
          document.getElementById('numeralLarge').textContent = numeral(1000000).format('0.0a');
          console.log('✅ Numeral.js working!');
        }
      </script>
    </div>

    <!-- ==================== 15. Math.js ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>🧮 اختبار Math.js</h2>
      
      <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 16px;">
        <p><strong>الجذر التربيعي لـ 16:</strong> <span id="mathSqrt"></span></p>
        <p><strong>sin(30°):</strong> <span id="mathSin"></span></p>
        <p><strong>مصفوفة [1,2] + [3,4]:</strong> <span id="mathMatrix"></span></p>
      </div>
      
      <script>
        if (typeof math !== 'undefined') {
          document.getElementById('mathSqrt').textContent = math.sqrt(16);
          document.getElementById('mathSin').textContent = math.sin(math.unit(30, 'deg'));
          document.getElementById('mathMatrix').textContent = math.add([1, 2], [3, 4]);
          console.log('✅ Math.js working!');
        }
      </script>
    </div>

    <!-- ==================== 16. jStat (Statistics) ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📊 اختبار jStat</h2>
      
      <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 16px;">
        <p><strong>البيانات:</strong> [10, 20, 30, 40, 50]</p>
        <p><strong>المتوسط:</strong> <span id="jstatMean"></span></p>
        <p><strong>الانحراف المعياري:</strong> <span id="jstatStdev"></span></p>
        <p><strong>الوسيط:</strong> <span id="jstatMedian"></span></p>
      </div>
      
      <script>
        if (typeof jStat !== 'undefined') {
          const data = [10, 20, 30, 40, 50];
          document.getElementById('jstatMean').textContent = jStat.mean(data).toFixed(2);
          document.getElementById('jstatStdev').textContent = jStat.stdev(data).toFixed(2);
          document.getElementById('jstatMedian').textContent = jStat.median(data);
          console.log('✅ jStat working!');
        }
      </script>
    </div>

    <!-- ==================== 17. Regression.js ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📈 اختبار Regression.js</h2>
      
      <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 16px;">
        <p><strong>الانحدار الخطي:</strong></p>
        <p id="regressionResult"></p>
      </div>
      
      <script>
        if (typeof regression !== 'undefined') {
          const data = [[0, 1], [32, 67], [12, 79], [50, 90], [20, 54]];
          const result = regression.linear(data);
          document.getElementById('regressionResult').innerHTML = `
            <strong>المعادلة:</strong> y = ${result.equation[0].toFixed(2)}x + ${result.equation[1].toFixed(2)}<br>
            <strong>R²:</strong> ${result.r2.toFixed(4)}
          `;
          console.log('✅ Regression.js working!');
        }
      </script>
    </div>

    <!-- ==================== 18. Calculator (تفاعلي) ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>🧮 حاسبة التمهيد الأسي</h2>
      
      <div style="background: rgba(255,255,255,0.3); padding: 20px; border-radius: 16px;">
        <div style="display:grid; gap:15px;">
          <div>
            <label style="display:block; margin-bottom:5px; font-weight:600;">F<sub>t-1</sub> (التنبؤ السابق):</label>
            <input type="number" id="prevForecast" placeholder="65" style="width:100%; padding:10px; border:2px solid var(--glass-border); border-radius:8px; font-size:1rem;">
          </div>
          
          <div>
            <label style="display:block; margin-bottom:5px; font-weight:600;">A<sub>t-1</sub> (الطلب الفعلي):</label>
            <input type="number" id="actualDemand" placeholder="76" style="width:100%; padding:10px; border:2px solid var(--glass-border); border-radius:8px; font-size:1rem;">
          </div>
          
          <div>
            <label style="display:block; margin-bottom:5px; font-weight:600;">α (ثابت التمهيد):</label>
            <input type="number" id="alphaValue" placeholder="0.4" step="0.1" min="0" max="1" style="width:100%; padding:10px; border:2px solid var(--glass-border); border-radius:8px; font-size:1rem;">
          </div>
        </div>
        
        <button onclick="calculateExponentialSmoothing()" style="width:100%; margin-top:20px; padding:14px; background:var(--color-primary); color:white; border:none; border-radius:12px; cursor:pointer; font-weight:700; font-size:1.1rem;">
          احسب F<sub>t</sub> 🚀
        </button>
        
        <div id="calculatorResult" style="display:none; margin-top:20px; padding:20px; background:rgba(34,197,94,0.15); border-radius:12px; border:2px solid var(--color-primary-medium);">
          <h4 style="color:var(--color-primary); margin-bottom:10px;">النتيجة:</h4>
          <p style="font-size:1.5rem; font-weight:800; color:var(--color-primary);" id="resultValue"></p>
          <div id="resultSteps" style="margin-top:15px; line-height:1.8;"></div>
        </div>
      </div>
    </div>

    <!-- ==================== 19. Stats Cards + AOS ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📈 إحصائيات المكتبات</h2>
      
      <div class="stats-grid">
        <div class="stat-card" data-aos="zoom-in" data-aos-delay="100">
          <div class="stat-value" style="color: var(--color-primary);">50+</div>
          <div class="stat-label">مكتبة</div>
        </div>
        
        <div class="stat-card" data-aos="zoom-in" data-aos-delay="200">
          <div class="stat-value" style="color: var(--color-ai);">100%</div>
          <div class="stat-label">نسبة النجاح</div>
        </div>
        
        <div class="stat-card" data-aos="zoom-in" data-aos-delay="300">
          <div class="stat-value" style="color: var(--color-finance);">8</div>
          <div class="stat-label">إضافات</div>
        </div>
        
        <div class="stat-card" data-aos="zoom-in" data-aos-delay="400">
          <div class="stat-value" style="color: var(--color-business);">iOS</div>
          <div class="stat-label">دعم</div>
        </div>
      </div>
    </div>

    <!-- ==================== 20. Progress Bars ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📊 Progress Bars</h2>
      
      <p><strong>تقدم المكتبات:</strong></p>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 100%;"></div>
      </div>
      
      <p><strong>تقدم الاختبار:</strong></p>
      <div class="progress-bar">
        <div class="progress-fill" style="width: 75%;"></div>
      </div>
    </div>

    <!-- ==================== 21. Highlighters ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>🎨 Highlighters</h2>
      
      <p><mark class="highlight-green">أخضر</mark> <mark class="highlight-blue">أزرق</mark> <mark class="highlight-yellow">أصفر</mark> <mark class="highlight-orange">برتقالي</mark> <mark class="highlight-pink">وردي</mark></p>
      
      <p><mark class="highlight-business">إدارة</mark> <mark class="highlight-finance">مالية</mark> <mark class="highlight-accounting">محاسبة</mark> <mark class="highlight-economics">اقتصاد</mark></p>
    </div>

    <!-- ==================== 22. Alert Boxes ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>🔔 Alert Boxes</h2>
      
      <div class="alert-box alert-success">
        <strong>✅ نجاح!</strong> كل المكتبات تعمل
      </div>
      
      <div class="alert-box alert-info">
        <strong>ℹ️ معلومة:</strong> استخدم Swipe للتنقل
      </div>
      
      <div class="alert-box alert-warning">
        <strong>⚠️ تحذير:</strong> تحتاج اتصال إنترنت
      </div>
      
      <div class="alert-box alert-error">
        <strong>❌ خطأ:</strong> مثال توضيحي فقط
      </div>
    </div>

    <!-- ==================== جدول نهائي ==================== -->
    <div class="glassy-card" data-aos="fade-up">
      <h2>📚 ملخص المكتبات</h2>
      
      <div class="table-container">
        <table class="concepts-table">
          <thead>
            <tr>
              <th>#</th>
              <th>المكتبة</th>
              <th>الحالة</th>
              <th>الوظيفة</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>1</td><td>MathJax</td><td>✅</td><td>معادلات رياضية</td></tr>
            <tr><td>2</td><td>Chart.js</td><td>✅</td><td>رسوم بيانية</td></tr>
            <tr><td>3</td><td>Echarts</td><td>✅</td><td>رسوم متقدمة</td></tr>
            <tr><td>4</td><td>ApexCharts</td><td>✅</td><td>رسوم عصرية</td></tr>
            <tr><td>5</td><td>Plotly</td><td>✅</td><td>رسوم تفاعلية</td></tr>
            <tr><td>6</td><td>Highcharts</td><td>✅</td><td>رسوم احترافية</td></tr>
            <tr><td>7</td><td>Confetti</td><td>✅</td><td>احتفالات</td></tr>
            <tr><td>8</td><td>DataTables</td><td>✅</td><td>جداول تفاعلية</td></tr>
            <tr><td>9</td><td>Mermaid</td><td>✅</td><td>مخططات انسيابية</td></tr>
            <tr><td>10</td><td>Prism.js</td><td>✅</td><td>تلوين الأكواد</td></tr>
          </tbody>
        </table>
      </div>
    </div>

  
  <!-- ==================== ENGLISH CONTENT ==================== -->
  <div class="en-content" style="display: none;">
    
    <!-- هنا تضيف المحتوى الإنجليزي -->
    
  </div>
      
  </main>
  <!-- ==================== JAVASCRIPT - iOS DETECTION + INITIALIZATION ==================== -->
  <script>
    // ==================== iOS DETECTION (إضافة جديدة) ====================
    function isIOSDevice() {
      return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
    }

    function getDeviceType() {
      const ua = navigator.userAgent;
      if (/iPad/.test(ua)) return 'iPad 📱';
      if (/iPhone/.test(ua)) return 'iPhone 📱';
      if (/iPod/.test(ua)) return 'iPod 📱';
      if (/Android/.test(ua)) return 'Android 🤖';
      if (/Windows/.test(ua)) return 'Windows 💻';
      if (/Mac/.test(ua)) return 'Mac 💻';
      return 'Unknown Device 🖥️';
    }

    const isIOS = isIOSDevice();
    const deviceType = getDeviceType();

    // إضافة class للـ body إذا كان iOS
    if (isIOS) {
      document.body.classList.add('ios-device');
      console.log('✅ iOS Device Detected - Using Native Controls');
    } else {
      console.log('✅ Non-iOS Device - Using Custom Player');
    }

    // ==================== TOAST NOTIFICATION (إضافة جديدة) ====================
    window.showToast = function(message, duration = 2000) {
      const toast = document.getElementById('toastNotification');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, duration);
    };
  </script>

  <!-- Initialize Libraries -->
  <script>
    // ==================== LIBRARIES INITIALIZATION ====================
    document.addEventListener('DOMContentLoaded', function() {
      
      // FastClick
      if (typeof FastClick !== 'undefined') {
        FastClick.attach(document.body);
        console.log('✅ FastClick enabled');
      }
      
      // Initialize AOS
      if (typeof AOS !== 'undefined') {
        AOS.init({
          duration: 800,
          easing: 'ease-in-out',
          once: true,
          offset: 50
        });
        console.log('✅ AOS initialized');
      }
      
      // Initialize Mermaid
      if (typeof mermaid !== 'undefined') {
        mermaid.initialize({
          startOnLoad: true,
          theme: 'default',
          flowchart: {
            useMaxWidth: true,
            htmlLabels: true
          }
        });
        console.log('✅ Mermaid initialized');
      }
      
      // Configure Marked.js
      if (typeof marked !== 'undefined') {
        marked.setOptions({
          breaks: true,
          gfm: true,
          sanitize: false
        });
        console.log('✅ Marked.js configured');
      }
      
      // Configure Moment.js for Arabic
      if (typeof moment !== 'undefined') {
        moment.locale('ar');
        console.log('✅ Moment.js configured');
      }
      
      // Configure Chart.js defaults for mobile
      if (typeof Chart !== 'undefined') {
        Chart.defaults.responsive = true;
        Chart.defaults.maintainAspectRatio = false;
        Chart.defaults.devicePixelRatio = window.devicePixelRatio || 2;
        console.log('✅ Chart.js configured for mobile');
      }
      
      // Force MathJax to render
      function waitForMathJax() {
        if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
          console.log('🎯 Rendering math expressions...');
          MathJax.typesetPromise().then(() => {
            console.log('✅ All math rendered successfully!');
          }).catch((err) => {
            console.error('❌ MathJax rendering error:', err);
          });
        } else {
          setTimeout(waitForMathJax, 100);
        }
      }
      
      setTimeout(waitForMathJax, 500);
      
      // Update Device Badge
      const deviceBadge = document.getElementById('deviceBadge');
      const playerInfo = document.getElementById('playerInfo');
      
      if (isIOS) {
        deviceBadge.textContent = deviceType + ' - Native Player 🍎';
        playerInfo.textContent = 'مشغل iOS الأصلي - اضغط على الفيديو للتشغيل';
        showToast('🍎 iOS Detected - Native Player');
      } else {
        deviceBadge.textContent = deviceType + ' - Custom Player 🎮';
        playerInfo.textContent = 'مشغل مخصص متقدم - تحكم كامل بالإيماءات';
        showToast('🎮 Custom Player Loaded');
      }
      
      // Initialize Hammer.js for gestures (Non-iOS only)
      if (typeof Hammer !== 'undefined' && !isIOS) {
        const mainContent = document.querySelector('.main-content');
        if (mainContent) {
          const hammer = new Hammer(mainContent);
          hammer.on('swipeleft swiperight', function(ev) {
            console.log('Gesture detected:', ev.type);
          });
          console.log('✅ Hammer.js gestures enabled');
        }
      }

      console.log('🚀 منصة أثر - جاهزة بالكامل!');
      console.log('📚 جميع المكتبات محملة بنجاح');
      console.log('📱 Device:', deviceType);
      console.log('🎬 Player Mode:', isIOS ? 'Native iOS' : 'Custom');
    });
  </script>

  <script>
    // ==================== MAIN APPLICATION SCRIPT ====================
    document.addEventListener('DOMContentLoaded', function() {
      const translationButton = document.getElementById('translationButton');
      const translationText = document.querySelector('.translation-text');
      const html = document.documentElement;
      const body = document.body;
      
      const aiChatButton = document.getElementById('aiChatButton');
      const aiChatModal = document.getElementById('aiChatModal');
      const aiChatCloseBtn = document.getElementById('aiChatCloseBtn');
      const aiChatMessages = document.getElementById('aiChatMessages');
      const aiChatInput = document.getElementById('ai-chat-input');
      const aiChatSendBtn = document.getElementById('ai-chat-send-btn');
      const aiChatTitle = document.getElementById('ai-chat-title');
      const aiChatButtonText = document.getElementById('aiFabText');
      
      let isArabic = true;
      let isFirstMessage = true;
      let conversationHistory = [];

      // ==================== TYPING INDICATOR ====================
      function showTypingIndicator(show) {
        const existingIndicator = aiChatMessages.querySelector('.typing-indicator');
        if (existingIndicator) existingIndicator.remove();
        
        if (show) {
          const indicatorElement = document.createElement('div');
          indicatorElement.classList.add('chat-message', 'ai-message', 'typing-indicator');
          indicatorElement.innerHTML = '<span>أثر AI يكتب الآن</span><span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>';
          aiChatMessages.appendChild(indicatorElement);
          aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
        }
      }

      // ==================== ADD MESSAGE ====================
      function addMessage(text, sender) {
        const messageElement = document.createElement('div');
        messageElement.classList.add('chat-message', `${sender}-message`);
        messageElement.innerHTML = marked.parse(text);
        aiChatMessages.appendChild(messageElement);
        aiChatMessages.scrollTop = aiChatMessages.scrollHeight;
      }
      
      // ==================== APPLY LANGUAGE ====================
      function applyLanguage(arabic) {
        isArabic = arabic;
        const lang = isArabic ? 'ar' : 'en';
        const dir = isArabic ? 'rtl' : 'ltr';
        
        html.setAttribute('lang', lang);
        html.setAttribute('dir', dir);
        body.setAttribute('dir', dir);
        
        // إخفاء/إظهار المحتوى حسب اللغة
        document.querySelectorAll('.ar-content').forEach(el => {
          el.style.display = arabic ? 'block' : 'none';
        });
        document.querySelectorAll('.en-content').forEach(el => {
          el.style.display = arabic ? 'none' : 'block';
        });
        
        translationText.textContent = isArabic ? 'English' : 'العربية';
        document.title = isArabic ? 'منصة أثر - التمهيد الأسي وطرق التنبؤ' : 'Athr Platform - Exponential Smoothing & Forecasting';
        
        aiChatTitle.textContent = isArabic ? 'اسأل أثر AI' : 'Ask Athr AI';
        aiChatInput.placeholder = isArabic ? 'اكتب سؤالك هنا...' : 'Type your question here...';
        aiChatButtonText.textContent = isArabic ? 'أثر AI' : 'Athr AI';
        
        // Update moment.js locale
        if (typeof moment !== 'undefined') {
          moment.locale(isArabic ? 'ar' : 'en');
        }
        
        // Re-render MathJax after language switch
        setTimeout(function() {
          if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
            MathJax.typesetPromise().catch((err) => console.error('MathJax error:', err));
          }
        }, 300);
      }

      // ==================== TRANSLATION BUTTON ====================
      translationButton.addEventListener('click', function() {
        applyLanguage(!isArabic);
        showToast(isArabic ? '🌍 تم التبديل للعربية' : '🌍 Switched to English');
        
        // Re-render MathJax after language switch
        setTimeout(function() {
          if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
            MathJax.typesetPromise().catch((err) => console.error('MathJax error:', err));
          }
        }, 300);
      });

      // ==================== AI CHAT BUTTON ====================
      aiChatButton.addEventListener('click', function() {
        aiChatModal.classList.add('visible');
        
        if (isFirstMessage) {
          const welcomeMsg = isArabic 
            ? "مرحباً! أنا **أثر AI**، مساعدك الأكاديمي المتخصص في **التنبؤ والتمهيد الأسي**. يمكنني مساعدتك في:\n\n- **شرح المعادلات والمفاهيم**\n- **حل المسائل خطوة بخطوة**\n- **توضيح الفرق بين الطرق المختلفة**\n- **الإجابة على أي سؤال عن المحتوى**\n\nاسألني أي شيء!"
            : "Hello! I'm **Athr AI**, your academic assistant specialized in **Forecasting & Exponential Smoothing**. I can help you with:\n\n- **Explaining equations and concepts**\n- **Solving problems step-by-step**\n- **Clarifying differences between methods**\n- **Answering any content questions**\n\nAsk me anything!";
          addMessage(welcomeMsg, 'ai');
          isFirstMessage = false;
        }
        
        aiChatInput.focus();
      });

      aiChatCloseBtn.addEventListener('click', function() {
        aiChatModal.classList.remove('visible');
      });

      aiChatModal.addEventListener('click', function(e) {
        if (e.target === aiChatModal) {
          aiChatModal.classList.remove('visible');
        }
      });

      // ==================== SEND MESSAGE ====================
      async function sendMessage() {
        const userMessage = aiChatInput.value.trim();
        if (!userMessage) return;

        addMessage(userMessage, 'user');
        conversationHistory.push({ role: 'user', content: userMessage });
        
        aiChatInput.value = '';
        aiChatInput.disabled = true;
        aiChatSendBtn.disabled = true;
        
        showTypingIndicator(true);

        try {
          const lectureContext = document.querySelector('.main-content').innerText || '';
          
          // Simulate AI response (replace with actual API call)
          await new Promise(resolve => setTimeout(resolve, 1500));
          
          showTypingIndicator(false);
          
          const aiResponse = isArabic
            ? "شكراً لسؤالك! بناءً على المحتوى، **التمهيد الأسي** هو طريقة تنبؤ تستخدم معادلة: \\[ F_t = F_{t-1} + \\alpha [(A_{t-1}) - (F_{t-1})] \\]\n\nحيث α (ثابت التمهيد) يتحكم في **درجة الاستجابة** للأخطاء. هل تريد مثال عملي؟"
            : "Thanks for your question! Based on the content, **Exponential Smoothing** is a forecasting method using: \\[ F_t = F_{t-1} + \\alpha [(A_{t-1}) - (F_{t-1})] \\]\n\nWhere α (smoothing constant) controls the **response degree** to errors. Would you like a practical example?";
          
          addMessage(aiResponse, 'ai');
          conversationHistory.push({ role: 'assistant', content: aiResponse });
          
          // Re-render math in chat
          setTimeout(() => {
            if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
              MathJax.typesetPromise();
            }
          }, 100);

        } catch (error) {
          console.error('Error:', error);
          showTypingIndicator(false);
          
          const errorMsg = isArabic
            ? "عذراً، حدث خطأ في الاتصال. يرجى المحاولة مرة أخرى."
            : "Sorry, a connection error occurred. Please try again.";
          addMessage(errorMsg, 'ai');
        } finally {
          aiChatInput.disabled = false;
          aiChatSendBtn.disabled = false;
          aiChatInput.focus();
        }
      }

      aiChatSendBtn.addEventListener('click', sendMessage);
      aiChatInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          sendMessage();
        }
      });

      // ==================== QUESTION TOGGLE ====================
      window.toggleQuestion = function(element) {
        const content = element.querySelector('.question-content');
        element.classList.toggle('open');
        content.classList.toggle('show');
        
        if (content.classList.contains('show')) {
          setTimeout(() => {
            content.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 300);
        }
      };

      // ==================== MCQ SELECTION WITH CONFETTI ====================
      const mcqOptions = document.querySelectorAll('.mcq-option');
      mcqOptions.forEach(option => {
        option.addEventListener('click', function() {
          const isCorrect = this.getAttribute('data-answer') === 'correct';
          const allOptions = this.parentNode.querySelectorAll('.mcq-option');
          
          allOptions.forEach(opt => {
            opt.style.pointerEvents = 'none';
          });
          
          this.classList.add('selected');
          
          setTimeout(() => {
            if (isCorrect) {
              this.classList.add('correct');
              this.innerHTML += ' ✓';
              
              if (typeof confetti !== 'undefined') {
                confetti({
                  particleCount: 100,
                  spread: 70,
                  origin: { y: 0.6 }
                });
              }
              showToast('✅ إجابة صحيحة!');
              
              const solutionContent = this.closest('.question-content').querySelector('.solution-content');
              if (solutionContent) {
                setTimeout(() => {
                  solutionContent.style.display = 'block';
                  if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                    MathJax.typesetPromise();
                  }
                }, 1000);
              }
            } else {
              this.classList.add('incorrect');
              this.innerHTML += ' ✗';
              showToast('❌ إجابة خاطئة');
              
              allOptions.forEach(opt => {
                if (opt.getAttribute('data-answer') === 'correct') {
                  opt.classList.add('correct');
                  opt.innerHTML += ' ✓ (الإجابة الصحيحة)';
                }
              });
              
              const solutionContent = this.closest('.question-content').querySelector('.solution-content');
              if (solutionContent) {
                setTimeout(() => {
                  solutionContent.style.display = 'block';
                  if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                    MathJax.typesetPromise();
                  }
                }, 1500);
              }
            }
          }, 500);
        });
      });

      console.log('✅ منصة أثر - جاهزة بالكامل!');
    });
  </script>

  <!-- ==================== VIDEO PLAYER SCRIPT (محسّن مع iOS Detection) ==================== -->
  <script>
    (function() {
      'use strict';

      // Multiple video sources as fallback
      const VIDEO_SOURCES = [
        'https://archive.org/download/20251005_20251005_1020/%D9%84%D8%BA%D8%A9_%D8%A7%D9%84%D8%A3%D8%B9%D9%85%D8%A7%D9%84__%D9%85%D9%82%D8%AF%D9%85%D8%A9_%D9%84%D9%84%D9%85%D8%AD%D8%A7%D8%B3%D8%A8%D8%A9.mp4',
        'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
      ];

      const videoPlayer = document.getElementById('videoPlayer');
      const video = document.getElementById('video');
      const videoBars = document.getElementById('videoBars');
      
      const simplePlayBtn = document.getElementById('simplePlayBtn');
      const simpleFullscreenBtn = document.getElementById('simpleFullscreenBtn');
      const simpleProgress = document.getElementById('simpleProgress');
      const simpleProgressFilled = document.getElementById('simpleProgressFilled');
      const simpleCurrentTime = document.getElementById('simpleCurrentTime');
      const simpleDuration = document.getElementById('simpleDuration');
      
      const playBtn = document.getElementById('playBtn');
      const skipBack = document.getElementById('skipBack');
      const skipForward = document.getElementById('skipForward');
      const progressWrapper = document.getElementById('progressWrapper');
      const progressFilled = document.getElementById('progressFilled');
      const progressBuffered = document.getElementById('progressBuffered');
      const currentTimeEl = document.getElementById('currentTime');
      const remainingTimeEl = document.getElementById('remainingTime');
      const volumeBtn = document.getElementById('volumeBtn');
      const volumeSlider = document.getElementById('volumeSlider');
      const closeBtn = document.getElementById('closeBtn');
      const pipBtn = document.getElementById('pipBtn');
      const loadingSpinner = document.getElementById('loadingSpinner');
      const tapLeft = document.getElementById('tapLeft');
      const tapRight = document.getElementById('tapRight');

      let controlsTimeout;
      let isDragging = false;
      let tapTimeout, tapCount = 0, lastTapX = 0;
      let isFullscreen = false;
      let currentSourceIndex = 0;

      function init() {
        loadVideo();
        
        // Setup video controls based on device
        if (isIOS) {
          video.controls = true;
          console.log('✅ iOS: Native controls enabled');
        } else {
          video.controls = false;
          setupCustomControls();
          setupHammerGestures();
          console.log('✅ Non-iOS: Custom controls enabled');
        }
        
        setupEventListeners();
        if (document.pictureInPictureEnabled) pipBtn.style.display = 'flex';
      }

      function loadVideo() {
        video.src = VIDEO_SOURCES[currentSourceIndex];
        video.load();
      }

      function updateVolumeSliderBg() {
        const percent = video.volume * 100;
        volumeSlider.style.background = `linear-gradient(to right, #fff ${percent}%, rgba(255, 255, 255, 0.3) ${percent}%)`;
      }

      function toggleFullscreen() {
        if (!isFullscreen) {
          videoPlayer.classList.add('fullscreen-mode');
          if (videoPlayer.requestFullscreen) {
            videoPlayer.requestFullscreen();
          } else if (videoPlayer.webkitRequestFullscreen) {
            videoPlayer.webkitRequestFullscreen();
          }
          isFullscreen = true;
          showControls();
          setTimeout(() => videoBars.classList.add('hidden'), 5000);
        } else {
          exitFullscreen();
        }
      }

      function exitFullscreen() {
        videoPlayer.classList.remove('fullscreen-mode');
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        }
        isFullscreen = false;
        videoBars.classList.remove('hidden');
      }

      function showControls() {
        if (!isFullscreen) return;
        videoPlayer.classList.add('show-controls');
        clearTimeout(controlsTimeout);
        controlsTimeout = setTimeout(() => {
          if (!video.paused && !isDragging) videoPlayer.classList.remove('show-controls');
        }, 3000);
      }

      function togglePlay() {
        if (video.paused) {
          video.play().catch(err => {
            console.log('Play failed:', err);
            if (currentSourceIndex < VIDEO_SOURCES.length - 1) {
              currentSourceIndex++;
              loadVideo();
              video.play().catch(e => console.log('All sources failed'));
            }
          });
        } else {
          video.pause();
        }
      }

      function skipBackward() {
        video.currentTime = Math.max(0, video.currentTime - 10);
        showTapIndicator('left');
        showToast('⏪ -10 ثواني');
      }

      function skipForwardFunc() {
        video.currentTime = Math.min(video.duration, video.currentTime + 10);
        showTapIndicator('right');
        showToast('⏩ +10 ثواني');
      }

      function showTapIndicator(side) {
        const indicator = side === 'left' ? tapLeft : tapRight;
        indicator.classList.add('active');
        setTimeout(() => indicator.classList.remove('active'), 500);
      }

      function formatTime(seconds) {
        if (isNaN(seconds) || !isFinite(seconds)) return '0:00';
        const hrs = Math.floor(seconds / 3600);
        const mins = Math.floor((seconds % 3600) / 60);
        const secs = Math.floor(seconds % 60);
        return hrs > 0 ? `${hrs}:${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}` : `${mins}:${secs.toString().padStart(2,'0')}`;
      }

      function updateProgress() {
        if (!isDragging && video.duration) {
          const progress = (video.currentTime / video.duration) * 100;
          simpleProgressFilled.style.width = `${progress}%`;
          progressFilled.style.width = `${progress}%`;
          const timeStr = formatTime(video.currentTime);
          simpleCurrentTime.textContent = timeStr;
          currentTimeEl.textContent = timeStr;
          remainingTimeEl.textContent = '-' + formatTime(video.duration - video.currentTime);
        }
      }

      function handleSeek(e, el) {
        const rect = el.getBoundingClientRect();
        const clientX = e.clientX || (e.touches && e.touches[0].clientX);
        const percent = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
        const time = percent * video.duration;
        if (!isNaN(time)) {
          video.currentTime = time;
          const progress = percent * 100;
          simpleProgressFilled.style.width = `${progress}%`;
          progressFilled.style.width = `${progress}%`;
        }
      }

      function updateVolumeIcon() {
        const vol = video.volume;
        const icon = video.muted || vol === 0 ? 'fa-volume-xmark' : vol < 0.5 ? 'fa-volume-low' : 'fa-volume-up';
        volumeBtn.innerHTML = `<i class="fas ${icon}"></i>`;
      }

      function setupCustomControls() {
        simplePlayBtn.addEventListener('click', togglePlay);
        simpleFullscreenBtn.addEventListener('click', toggleFullscreen);
        simpleProgress.addEventListener('click', (e) => handleSeek(e, simpleProgress));

        playBtn.addEventListener('click', togglePlay);
        skipBack.addEventListener('click', skipBackward);
        skipForward.addEventListener('click', skipForwardFunc);
        closeBtn.addEventListener('click', exitFullscreen);
        
        volumeBtn.addEventListener('click', () => {
          video.muted = !video.muted;
          updateVolumeIcon();
        });

        volumeSlider.addEventListener('input', () => {
          video.volume = volumeSlider.value;
          video.muted = false;
          updateVolumeIcon();
          updateVolumeSliderBg();
        });

        progressWrapper.addEventListener('mousedown', (e) => {
          isDragging = true;
          videoPlayer.classList.add('dragging');
          handleSeek(e, progressWrapper);
        });

        progressWrapper.addEventListener('touchstart', (e) => {
          isDragging = true;
          videoPlayer.classList.add('dragging');
          handleSeek(e, progressWrapper);
        }, { passive: true });

        document.addEventListener('mousemove', (e) => {
          if (isDragging) handleSeek(e, progressWrapper);
        });

        document.addEventListener('touchmove', (e) => {
          if (isDragging) handleSeek(e, progressWrapper);
        }, { passive: true });

        document.addEventListener('mouseup', () => {
          if (isDragging) {
            isDragging = false;
            videoPlayer.classList.remove('dragging');
          }
        });

        document.addEventListener('touchend', () => {
          if (isDragging) {
            isDragging = false;
            videoPlayer.classList.remove('dragging');
          }
        });

        progressWrapper.addEventListener('click', (e) => handleSeek(e, progressWrapper));

        video.addEventListener('click', (e) => {
          if (!isFullscreen) {
            togglePlay();
            return;
          }

          tapCount++;
          lastTapX = e.clientX || (e.touches && e.touches[0].clientX);
          clearTimeout(tapTimeout);

          if (tapCount === 1) {
            tapTimeout = setTimeout(() => {
              togglePlay();
              tapCount = 0;
            }, 300);
          } else if (tapCount === 2) {
            const rect = video.getBoundingClientRect();
            (lastTapX - rect.left > rect.width / 2 ? skipForwardFunc : skipBackward)();
            tapCount = 0;
          }
        });

        videoPlayer.addEventListener('mousemove', showControls);
        videoPlayer.addEventListener('touchstart', showControls);

        if (pipBtn) {
          pipBtn.addEventListener('click', async () => {
            try {
              document.pictureInPictureElement ? await document.exitPictureInPicture() : await video.requestPictureInPicture();
            } catch {}
          });
        }

        document.addEventListener('keydown', (e) => {
          if (e.target.tagName === 'INPUT') return;
          switch(e.key) {
            case ' ':
            case 'k':
              e.preventDefault();
              togglePlay();
              break;
            case 'ArrowLeft':
              e.preventDefault();
              skipBackward();
              break;
            case 'ArrowRight':
              e.preventDefault();
              skipForwardFunc();
              break;
            case 'm':
              e.preventDefault();
              video.muted = !video.muted;
              updateVolumeIcon();
              break;
            case 'f':
              e.preventDefault();
              toggleFullscreen();
              break;
          }
        });

        updateVolumeSliderBg();
      }

      function setupHammerGestures() {
        if (typeof Hammer === 'undefined') return;
        
        const hammer = new Hammer(video);
        hammer.get('swipe').set({ direction: Hammer.DIRECTION_HORIZONTAL });
        
        hammer.on('swipeleft', () => {
          skipForwardFunc();
        });
        
        hammer.on('swiperight', () => {
          skipBackward();
        });
        
        console.log('✅ Hammer.js video gestures enabled');
      }

      function setupEventListeners() {
        video.addEventListener('loadstart', () => loadingSpinner.classList.add('active'));
        video.addEventListener('canplay', () => loadingSpinner.classList.remove('active'));
        video.addEventListener('waiting', () => loadingSpinner.classList.add('active'));
        video.addEventListener('playing', () => loadingSpinner.classList.remove('active'));
        
        video.addEventListener('error', (e) => {
          console.log('Video error:', e);
          loadingSpinner.classList.remove('active');
          if (currentSourceIndex < VIDEO_SOURCES.length - 1) {
            currentSourceIndex++;
            console.log('Trying next source:', VIDEO_SOURCES[currentSourceIndex]);
            loadVideo();
            showToast('⚠️ جاري تحميل مصدر بديل...');
          } else {
            showToast('❌ فشل تحميل الفيديو');
          }
        });

        video.addEventListener('loadedmetadata', () => {
          simpleDuration.textContent = formatTime(video.duration);
          remainingTimeEl.textContent = '-' + formatTime(video.duration);
          if (isFullscreen) showControls();
        });

        video.addEventListener('play', () => {
          videoPlayer.classList.remove('paused');
          simplePlayBtn.innerHTML = '<i class="fas fa-pause"></i>';
          if (playBtn) playBtn.innerHTML = '<i class="fas fa-pause"></i>';
        });

        video.addEventListener('pause', () => {
          videoPlayer.classList.add('paused');
          simplePlayBtn.innerHTML = '<i class="fas fa-play"></i>';
          if (playBtn) playBtn.innerHTML = '<i class="fas fa-play"></i>';
          showControls();
        });

        video.addEventListener('timeupdate', updateProgress);
        video.addEventListener('progress', () => {
          if (video.buffered.length > 0 && video.duration) {
            progressBuffered.style.width = `${(video.buffered.end(0) / video.duration) * 100}%`;
          }
        });

        document.addEventListener('fullscreenchange', () => {
          if (!document.fullscreenElement) exitFullscreen();
        });
      }

      init();
    })();
  </script>

  <!-- ==================== ADDITIONAL UTILITIES & SCROLL PROGRESS ==================== -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      
      // ==================== SCROLL PROGRESS TRACKER (إضافة جديدة) ====================
      const createScrollProgress = () => {
        const progressBar = document.createElement('div');
        progressBar.style.cssText = `
          position: fixed;
          top: 0;
          left: 0;
          width: 0%;
          height: 4px;
          background: linear-gradient(90deg, var(--color-primary), var(--color-primary-medium));
          z-index: 10000;
          transition: width 0.1s ease;
          box-shadow: 0 2px 8px rgba(22, 163, 74, 0.3);
        `;
        document.body.appendChild(progressBar);
        
        window.addEventListener('scroll', () => {
          const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
          const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
          const scrolled = (winScroll / height) * 100;
          progressBar.style.width = scrolled + '%';
        });
      };
      
      createScrollProgress();

      // ==================== EXPONENTIAL SMOOTHING CALCULATOR (Optional) ====================
      window.calculateExponentialSmoothing = function() {
        const prevForecast = parseFloat(document.getElementById('prevForecast')?.value);
        const actualDemand = parseFloat(document.getElementById('actualDemand')?.value);
        const alpha = parseFloat(document.getElementById('alphaValue')?.value);
        
        if (isNaN(prevForecast) || isNaN(actualDemand) || isNaN(alpha)) {
          showToast('⚠️ الرجاء إدخال قيم صحيحة!');
          return;
        }
        
        if (alpha < 0 || alpha > 1) {
          showToast('⚠️ قيمة α يجب أن تكون بين 0 و 1!');
          return;
        }
        
        const error = actualDemand - prevForecast;
        const adjustment = alpha * error;
        const newForecast = prevForecast + adjustment;
        
        const resultDiv = document.getElementById('calculatorResult');
        const resultValue = document.getElementById('resultValue');
        const resultSteps = document.getElementById('resultSteps');
        
        if (resultValue) resultValue.innerHTML = `${newForecast.toFixed(2)} وحدة`;
        
        if (resultSteps) {
          resultSteps.innerHTML = `
            <strong>خطوات الحل:</strong><br>
            1️⃣ خطأ التنبؤ = ${actualDemand} - ${prevForecast} = <strong>${error.toFixed(2)}</strong><br>
            2️⃣ التعديل = ${alpha} × ${error.toFixed(2)} = <strong>${adjustment.toFixed(2)}</strong><br>
            3️⃣ التنبؤ الجديد = ${prevForecast} + ${adjustment.toFixed(2)} = <strong>${newForecast.toFixed(2)}</strong>
          `;
        }
        
        if (resultDiv) {
          resultDiv.style.display = 'block';
          resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
        
        // Trigger celebration
        if (typeof confetti !== 'undefined') {
          confetti({
            particleCount: 50,
            angle: 60,
            spread: 55,
            origin: { x: 0, y: 0.8 }
          });
          confetti({
            particleCount: 50,
            angle: 120,
            spread: 55,
            origin: { x: 1, y: 0.8 }
          });
        }
        
        showToast('✅ تم الحساب بنجاح!');
      };
      
      // ==================== UTILITY FUNCTIONS ====================
      
      // Format Currency
      window.formatCurrency = function(amount, currency = 'EGP') {
        return new Intl.NumberFormat('ar-EG', {
          style: 'currency',
          currency: currency
        }).format(amount);
      };
      
      // Format Number
      window.formatNumber = function(number, decimals = 2) {
        return new Intl.NumberFormat('ar-EG', {
          minimumFractionDigits: decimals,
          maximumFractionDigits: decimals
        }).format(number);
      };
      
      // Format Percentage
      window.formatPercentage = function(value) {
        return new Intl.NumberFormat('ar-EG', {
          style: 'percent',
          minimumFractionDigits: 2
        }).format(value);
      };
      
      // ==================== CHARTS INITIALIZATION (Optional) ====================
      
      // Example Chart - يمكنك إضافة الرسوم البيانية هنا
      setTimeout(function() {
        const exampleCanvas = document.getElementById('exampleChart');
        if (exampleCanvas && typeof Chart !== 'undefined') {
          new Chart(exampleCanvas, {
            type: 'line',
            data: {
              labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
              datasets: [{
                label: 'البيانات',
                data: [12, 19, 3, 5, 2, 3],
                borderColor: 'rgb(22, 163, 74)',
                backgroundColor: 'rgba(22, 163, 74, 0.1)',
                tension: 0.4
              }]
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: true,
                  position: 'top'
                }
              }
            }
          });
          console.log('✅ Example chart created');
        }
      }, 2000);

      // ==================== INTERACTIVE TABLE ENHANCEMENTS ====================
      
      // Add hover effects to tables
      const tables = document.querySelectorAll('.concepts-table');
      tables.forEach(table => {
        const rows = table.querySelectorAll('tbody tr');
        rows.forEach(row => {
          row.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.02)';
            this.style.transition = 'all 0.3s ease';
          });
          row.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
          });
        });
      });

      // ==================== FINAL CONSOLE MESSAGES ====================
      console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
      console.log('🎉 منصة أثر - تم التحميل بنجاح!');
      console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
      console.log('📚 عدد المكتبات المحملة: 50+');
      console.log('📱 الجهاز:', deviceType);
      console.log('🎬 المشغل:', isIOS ? 'Native iOS Player' : 'Custom Player');
      console.log('✨ الإضافات الجديدة:');
      console.log('   ✅ iOS Detection');
      console.log('   ✅ Shimmer Effect');
      console.log('   ✅ Skeleton Loading');
      console.log('   ✅ Toast Notifications');
      console.log('   ✅ Hammer.js Gestures');
      console.log('   ✅ Device Badge');
      console.log('   ✅ Scroll Progress');
      console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
      console.log('💡 نصيحة: اضغط F12 لفتح Developer Tools');
      console.log('🚀 جاهز للاستخدام!');
      console.log('━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━');
      
      // Show welcome toast after 1 second
      setTimeout(() => {
        showToast('🎉 مرحباً في منصة أثر!', 3000);
      }, 1000);
    });
  </script>
</body>
</html>
